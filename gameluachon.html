<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>L·ª±a Ch·ªçn C·ªßa An - Visual Novel</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;600;700;800&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Nunito', sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            overflow: hidden;
        }
        
        .game-container {
            width: 100vw;
            height: 100vh;
            position: relative;
            display: flex;
            flex-direction: column;
        }
        
        .background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            transition: all 1s ease-in-out;
            z-index: 1;
        }
        
        .bg-school-gate {
            background: linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.4)), 
                        url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 600"><rect fill="%23e8f4f8" width="800" height="600"/><rect fill="%23d4e6f1" x="0" y="400" width="800" height="200"/><rect fill="%235d6d7e" x="50" y="100" width="700" height="300"/><rect fill="%2334495e" x="100" y="150" width="100" height="150"/><rect fill="%23f39c12" x="110" y="160" width="80" height="120"/><rect fill="%2334495e" x="250" y="150" width="100" height="150"/><rect fill="%23f39c12" x="260" y="160" width="80" height="120"/><rect fill="%2334495e" x="450" y="150" width="100" height="150"/><rect fill="%23f39c12" x="460" y="160" width="80" height="120"/><rect fill="%2334495e" x="600" y="150" width="100" height="150"/><rect fill="%23f39c12" x="610" y="160" width="80" height="120"/><text x="400" y="80" font-family="Arial" font-size="28" fill="%232c3e50" text-anchor="middle">TR∆Ø·ªúNG THPT NGUY·ªÑN DU</text><rect fill="%23c0392b" x="350" y="350" width="100" height="50"/><text x="400" y="380" font-family="Arial" font-size="16" fill="white" text-anchor="middle">C·ªîNG CH√çNH</text></svg>');
        }
        
        .bg-classroom {
            background: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), 
                        url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 600"><rect fill="%23f8f9fa" width="800" height="600"/><rect fill="%23e9ecef" x="0" y="500" width="800" height="100"/><rect fill="%236c757d" x="50" y="50" width="700" height="400"/><rect fill="%23495057" x="70" y="70" width="660" height="360"/><rect fill="%23f8f9fa" x="80" y="80" width="640" height="340"/><rect fill="%23343a40" x="100" y="100" width="200" height="150"/><rect fill="%23495057" x="320" y="120" width="40" height="60"/><rect fill="%23495057" x="380" y="120" width="40" height="60"/><rect fill="%23495057" x="440" y="120" width="40" height="60"/><rect fill="%23495057" x="500" y="120" width="40" height="60"/><rect fill="%23495057" x="560" y="120" width="40" height="60"/><rect fill="%23495057" x="620" y="120" width="40" height="60"/><text x="400" y="40" font-family="Arial" font-size="20" fill="%23212529" text-anchor="middle">L·ªöP 11A1</text></svg>');
        }
        
        .bg-school-yard {
            background: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), 
                        url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 600"><rect fill="%2387ceeb" width="800" height="600"/><rect fill="%2398fb98" x="0" y="450" width="800" height="150"/><rect fill="%23228b22" x="100" y="400" width="600" height="50"/><circle fill="%23ff6347" cx="400" cy="300" r="80"/><rect fill="%23ffffff" x="380" y="280" width="40" height="40"/><rect fill="%23ffffff" x="360" y="300" width="80" height="20"/><rect fill="%235d6d7e" x="50" y="200" width="100" height="200"/><rect fill="%235d6d7e" x="650" y="200" width="100" height="200"/><text x="400" y="150" font-family="Arial" font-size="24" fill="%232c3e50" text-anchor="middle">S√ÇN TR∆Ø·ªúNG</text></svg>');
        }
        
        .bg-behind-school {
            background: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)), 
                        url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 600"><rect fill="%23556b2f" width="800" height="600"/><rect fill="%23228b22" x="0" y="500" width="800" height="100"/><rect fill="%238b4513" x="100" y="300" width="20" height="200"/><circle fill="%23006400" cx="110" cy="280" r="40"/><rect fill="%238b4513" x="200" y="250" width="25" height="250"/><circle fill="%23006400" cx="212" cy="230" r="50"/><rect fill="%238b4513" x="600" y="280" width="30" height="220"/><circle fill="%23006400" cx="615" cy="260" r="60"/><rect fill="%23696969" x="300" y="400" width="200" height="100"/><rect fill="%23808080" x="320" y="420" width="160" height="60"/><text x="400" y="200" font-family="Arial" font-size="20" fill="%23f5f5dc" text-anchor="middle">SAU TR∆Ø·ªúNG</text></svg>');
        }
        
        .bg-home {
            background: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), 
                        url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 600"><rect fill="%23ffeaa7" width="800" height="600"/><rect fill="%23fdcb6e" x="0" y="500" width="800" height="100"/><rect fill="%23e17055" x="200" y="200" width="400" height="300"/><polygon fill="%23d63031" points="150,200 400,100 650,200"/><rect fill="%236c5ce7" x="280" y="350" width="80" height="150"/><rect fill="%23a29bfe" x="300" y="370" width="40" height="80"/><rect fill="%23fd79a8" x="450" y="280" width="100" height="80"/><rect fill="%23fdcb6e" x="470" y="300" width="60" height="40"/><text x="400" y="150" font-family="Arial" font-size="24" fill="%232d3436" text-anchor="middle">NH√Ä AN</text></svg>');
        }
        
        .bg-party {
            background: linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.4)), 
                        url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 600"><rect fill="%23ff6b6b" width="800" height="600"/><rect fill="%23ee5a24" x="0" y="500" width="800" height="100"/><rect fill="%23feca57" x="100" y="100" width="600" height="400"/><rect fill="%23ff9ff3" x="150" y="150" width="500" height="300"/><circle fill="%23ff6348" cx="200" cy="200" r="30"/><circle fill="%2348dbfb" cx="300" cy="180" r="25"/><circle fill="%23ff9f43" cx="400" cy="220" r="35"/><circle fill="%23ff6b6b" cx="500" cy="190" r="28"/><circle fill="%2354a0ff" cx="600" cy="210" r="32"/><rect fill="%23feca57" x="200" y="350" width="400" height="100"/><rect fill="%23ff6348" x="220" y="370" width="60" height="60"/><rect fill="%2348dbfb" x="300" y="370" width="60" height="60"/><rect fill="%23ff9f43" x="380" y="370" width="60" height="60"/><rect fill="%23ff6b6b" x="460" y="370" width="60" height="60"/><rect fill="%2354a0ff" x="540" y="370" width="60" height="60"/><text x="400" y="80" font-family="Arial" font-size="28" fill="%23ffffff" text-anchor="middle">üéâ PARTY NIGHT üéâ</text><text x="400" y="550" font-family="Arial" font-size="16" fill="%23ffffff" text-anchor="middle">BI·ªÜT TH·ª∞ NH√Ä HUY</text></svg>');
        }
        
        .character {
            position: absolute;
            bottom: 0;
            width: 280px;
            height: 420px;
            z-index: 3;
            transition: all 0.6s ease;
            opacity: 0;
            transform: translateY(20px);
        }
        
        .character.active {
            opacity: 1;
            transform: translateY(0);
        }
        
        .character-left {
            left: 80px;
        }
        
        .character-right {
            right: 80px;
        }
        
        .character-center {
            left: 50%;
            transform: translateX(-50%);
        }
        
        .character.active.character-center {
            transform: translateX(-50%) translateY(0);
        }
        
        .character svg {
            width: 100%;
            height: 100%;
            filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.3));
        }
        
        .dialogue-box {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(135deg, rgba(0,0,0,0.9), rgba(30,60,114,0.9));
            color: white;
            padding: 35px;
            z-index: 4;
            min-height: 200px;
            backdrop-filter: blur(15px);
            border-top: 3px solid #ffd700;
        }
        
        .speaker-name {
            font-size: 20px;
            font-weight: 800;
            color: #ffd700;
            margin-bottom: 12px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }
        
        .dialogue-text {
            font-size: 17px;
            line-height: 1.7;
            margin-bottom: 25px;
            min-height: 70px;
            font-weight: 400;
        }
        
        .choices {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 20px;
        }
        
        .choice-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 30px;
            cursor: pointer;
            font-size: 15px;
            font-weight: 600;
            transition: all 0.4s ease;
            text-align: left;
            position: relative;
            overflow: hidden;
        }
        
        .choice-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.4);
            background: linear-gradient(45deg, #764ba2, #667eea);
        }
        
        .choice-btn:before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        
        .choice-btn:hover:before {
            left: 100%;
        }
        
        .continue-btn {
            position: absolute;
            bottom: 25px;
            right: 35px;
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            color: #333;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 700;
            transition: all 0.3s ease;
            font-size: 14px;
        }
        
        .continue-btn:hover {
            background: linear-gradient(45deg, #ffed4e, #ffd700);
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(255,215,0,0.4);
        }
        
        .title-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 50%, #764ba2 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10;
            transition: opacity 0.8s ease;
        }
        
        .title {
            font-size: 56px;
            font-weight: 800;
            color: white;
            margin-bottom: 15px;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.7);
            text-align: center;
        }
        
        .subtitle {
            font-size: 22px;
            color: rgba(255,255,255,0.9);
            margin-bottom: 20px;
            text-align: center;
            font-weight: 300;
        }
        
        .description {
            font-size: 16px;
            color: rgba(255,255,255,0.8);
            margin-bottom: 50px;
            text-align: center;
            max-width: 600px;
            line-height: 1.6;
        }
        
        .start-btn {
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            color: #333;
            border: none;
            padding: 18px 50px;
            border-radius: 35px;
            font-size: 20px;
            font-weight: 800;
            cursor: pointer;
            transition: all 0.4s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .start-btn:hover {
            background: linear-gradient(45deg, #ffed4e, #ffd700);
            transform: scale(1.1);
            box-shadow: 0 10px 30px rgba(255,215,0,0.4);
        }
        
        .stats-panel {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 20px;
            border-radius: 15px;
            z-index: 5;
            font-size: 14px;
            min-width: 250px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .stat-category {
            margin-bottom: 15px;
        }
        
        .stat-category h4 {
            color: #ffd700;
            margin-bottom: 8px;
            font-size: 16px;
            font-weight: 700;
        }
        
        .stat-item {
            margin-bottom: 6px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .stat-value {
            font-weight: 600;
            color: #4ecdc4;
        }
        
        .chapter-info {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            z-index: 5;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .chapter-title {
            font-size: 18px;
            font-weight: 700;
            color: #ffd700;
            margin-bottom: 5px;
        }
        
        .act-info {
            font-size: 14px;
            color: rgba(255,255,255,0.8);
        }
        
        .hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        .consequence-indicator {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255,0,0,0.9);
            color: white;
            padding: 20px 30px;
            border-radius: 15px;
            font-size: 18px;
            font-weight: 700;
            z-index: 20;
            animation: consequenceFlash 2s ease-in-out;
        }
        
        @keyframes consequenceFlash {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
            50% { opacity: 1; transform: translate(-50%, -50%) scale(1.1); }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(1); }
        }
        
        .plot-twist {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            animation: plotTwistPulse 1s ease-in-out;
        }
        
        @keyframes plotTwistPulse {
            0% { transform: translate(-50%, -50%) scale(1); }
            50% { transform: translate(-50%, -50%) scale(1.2); }
            100% { transform: translate(-50%, -50%) scale(1); }
        }
        
        .memory-indicator {
            position: absolute;
            bottom: 220px;
            right: 35px;
            background: rgba(255,215,0,0.9);
            color: #333;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            z-index: 5;
            animation: memoryGlow 2s ease-in-out infinite;
        }
        
        @keyframes memoryGlow {
            0%, 100% { box-shadow: 0 0 5px rgba(255,215,0,0.5); }
            50% { box-shadow: 0 0 20px rgba(255,215,0,0.8); }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <!-- Title Screen -->
        <div class="title-screen" id="titleScreen">
            <h1 class="title">L·ª±a Ch·ªçn C·ªßa An</h1>
            <p class="subtitle">Visual Novel - 15 Ch∆∞∆°ng, 4 H·ªìi</p>
            <p class="description">
                M·ªôt c√¢u chuy·ªán v·ªÅ tu·ªïi 17 ƒë·∫ßy th·ª≠ th√°ch. M·ªói l·ª±a ch·ªçn c·ªßa b·∫°n s·∫Ω ƒë·ªãnh h√¨nh t∆∞∆°ng lai c·ªßa An, 
                ·∫£nh h∆∞·ªüng ƒë·∫øn t√¨nh b·∫°n, t√¨nh y√™u, gia ƒë√¨nh v√† danh ti·∫øng. 
                V·ªõi 8 k·∫øt th√∫c ch√≠nh v√† 2 k·∫øt th√∫c ·∫©n, h√†nh tr√¨nh c·ªßa b·∫°n s·∫Ω ho√†n to√†n ƒë·ªôc nh·∫•t.
            </p>
            <button class="start-btn" onclick="startGame()">B·∫Øt ƒê·∫ßu H√†nh Tr√¨nh</button>
        </div>
        
        <!-- Game Background -->
        <div class="background bg-school-gate" id="background"></div>
        
        <!-- Chapter Info -->
        <div class="chapter-info hidden" id="chapterInfo">
            <div class="chapter-title" id="chapterTitle">H·ªìi 1 - Ch∆∞∆°ng 1</div>
            <div class="act-info" id="actInfo">Ng√≤i N·ªï: T√¢n H·ªçc Sinh</div>
        </div>
        
        <!-- Characters -->
        <div class="character character-center" id="characterAn">
            <svg viewBox="0 0 200 350">
                <!-- An - Nh√¢n v·∫≠t ch√≠nh -->
                <ellipse cx="100" cy="90" rx="40" ry="50" fill="#fdbcb4"/>
                <path d="M65 60 Q100 35 135 60 Q135 45 100 40 Q65 45 65 60" fill="#4a4a4a"/>
                <circle cx="85" cy="85" r="4" fill="#333"/>
                <circle cx="115" cy="85" r="4" fill="#333"/>
                <path d="M90 100 Q100 105 110 100" stroke="#333" stroke-width="2" fill="none"/>
                <rect x="80" y="140" width="40" height="70" fill="#ffffff" rx="5"/>
                <rect x="75" y="210" width="50" height="90" fill="#2c3e50" rx="3"/>
                <rect x="70" y="300" width="25" height="50" fill="#fdbcb4"/>
                <rect x="105" y="300" width="25" height="50" fill="#fdbcb4"/>
                <rect x="65" y="350" width="35" height="15" fill="#000"/>
                <rect x="100" y="350" width="35" height="15" fill="#000"/>
            </svg>
        </div>
        
        <div class="character character-left" id="characterTuan">
            <svg viewBox="0 0 200 350">
                <!-- Tu·∫•n - H·ªçc sinh chuy·ªÉn tr∆∞·ªùng -->
                <ellipse cx="100" cy="90" rx="40" ry="50" fill="#fdbcb4"/>
                <path d="M70 55 Q100 30 130 55 Q130 40 100 35 Q70 40 70 55" fill="#8b4513"/>
                <circle cx="85" cy="85" r="4" fill="#333"/>
                <circle cx="115" cy="85" r="4" fill="#333"/>
                <path d="M95 100 Q100 105 105 100" stroke="#333" stroke-width="2" fill="none"/>
                <rect x="85" y="140" width="30" height="70" fill="#e74c3c" rx="5"/>
                <rect x="80" y="210" width="40" height="90" fill="#34495e" rx="3"/>
                <rect x="75" y="300" width="25" height="50" fill="#fdbcb4"/>
                <rect x="100" y="300" width="25" height="50" fill="#fdbcb4"/>
                <rect x="70" y="350" width="30" height="15" fill="#2c3e50"/>
                <rect x="105" y="350" width="30" height="15" fill="#2c3e50"/>
                <!-- Vape in hand -->
                <rect x="125" y="160" width="15" height="3" fill="#95a5a6"/>
                <circle cx="140" cy="161" r="2" fill="#3498db"/>
            </svg>
        </div>
        
        <div class="character character-right" id="characterMinh">
            <svg viewBox="0 0 200 350">
                <!-- Minh - B·∫°n th√¢n -->
                <ellipse cx="100" cy="90" rx="40" ry="50" fill="#fdbcb4"/>
                <path d="M75 50 Q100 25 125 50 Q125 35 100 30 Q75 35 75 50" fill="#2c1810"/>
                <circle cx="85" cy="85" r="4" fill="#333"/>
                <circle cx="115" cy="85" r="4" fill="#333"/>
                <path d="M95 100 Q100 105 105 100" stroke="#333" stroke-width="2" fill="none"/>
                <rect x="85" y="140" width="30" height="70" fill="#3498db" rx="5"/>
                <rect x="80" y="210" width="40" height="90" fill="#2c3e50" rx="3"/>
                <rect x="75" y="300" width="25" height="50" fill="#fdbcb4"/>
                <rect x="100" y="300" width="25" height="50" fill="#fdbcb4"/>
                <rect x="70" y="350" width="30" height="15" fill="#34495e"/>
                <rect x="105" y="350" width="30" height="15" fill="#34495e"/>
            </svg>
        </div>
        
        <div class="character character-left" id="characterLan">
            <svg viewBox="0 0 200 350">
                <!-- Lan - B·∫°n g√°i -->
                <ellipse cx="100" cy="90" rx="40" ry="50" fill="#fdbcb4"/>
                <path d="M70 45 Q100 20 130 45 Q130 25 100 20 Q70 25 70 45" fill="#d4af37"/>
                <circle cx="85" cy="85" r="4" fill="#333"/>
                <circle cx="115" cy="85" r="4" fill="#333"/>
                <path d="M95 100 Q100 105 105 100" stroke="#333" stroke-width="2" fill="none"/>
                <rect x="80" y="140" width="40" height="70" fill="#ff69b4" rx="5"/>
                <rect x="75" y="210" width="50" height="90" fill="#8e44ad" rx="3"/>
                <rect x="70" y="300" width="25" height="50" fill="#fdbcb4"/>
                <rect x="105" y="300" width="25" height="50" fill="#fdbcb4"/>
                <rect x="65" y="350" width="35" height="15" fill="#e74c3c"/>
                <rect x="100" y="350" width="35" height="15" fill="#e74c3c"/>
            </svg>
        </div>
        
        <!-- Stats Panel -->
        <div class="stats-panel hidden" id="statsPanel">
            <div class="stat-category">
                <h4>üè• S·ª©c Kh·ªèe</h4>
                <div class="stat-item">
                    <span>Th·ªÉ ch·∫•t:</span>
                    <span class="stat-value" id="health">100</span>
                </div>
                <div class="stat-item">
                    <span>Tinh th·∫ßn:</span>
                    <span class="stat-value" id="mental">100</span>
                </div>
            </div>
            
            <div class="stat-category">
                <h4>üë• Quan H·ªá</h4>
                <div class="stat-item">
                    <span>Tu·∫•n:</span>
                    <span class="stat-value" id="tuanRel">0</span>
                </div>
                <div class="stat-item">
                    <span>Minh:</span>
                    <span class="stat-value" id="minhRel">50</span>
                </div>
                <div class="stat-item">
                    <span>Lan:</span>
                    <span class="stat-value" id="lanRel">0</span>
                </div>
                <div class="stat-item">
                    <span>Gia ƒë√¨nh:</span>
                    <span class="stat-value" id="familyRel">80</span>
                </div>
            </div>
            
            <div class="stat-category">
                <h4>üéì H·ªçc T·∫≠p</h4>
                <div class="stat-item">
                    <span>ƒêi·ªÉm s·ªë:</span>
                    <span class="stat-value" id="grades">75</span>
                </div>
                <div class="stat-item">
                    <span>Danh ti·∫øng:</span>
                    <span class="stat-value" id="reputation">70</span>
                </div>
            </div>
            
            <div class="stat-category">
                <h4>‚ö†Ô∏è R·ªßi Ro</h4>
                <div class="stat-item">
                    <span>Nghi·ªán:</span>
                    <span class="stat-value" id="addiction">0</span>
                </div>
                <div class="stat-item">
                    <span>√Åp l·ª±c:</span>
                    <span class="stat-value" id="pressure">20</span>
                </div>
            </div>
        </div>
        
        <!-- Dialogue Box -->
        <div class="dialogue-box hidden" id="dialogueBox">
            <div class="speaker-name" id="speakerName"></div>
            <div class="dialogue-text" id="dialogueText"></div>
            <div class="choices" id="choices"></div>
            <button class="continue-btn hidden" id="continueBtn" onclick="nextDialogue()">Ti·∫øp t·ª•c ‚ñ∂</button>
            <div class="memory-indicator hidden" id="memoryIndicator">üí≠ L·ª±a ch·ªçn n√†y s·∫Ω ƒë∆∞·ª£c nh·ªõ</div>
        </div>
    </div>

    <script>
        let currentAct = 1;
        let currentChapter = 1;
        let currentDialogue = 0;
        let gameMemory = {}; // L∆∞u tr·ªØ c√°c l·ª±a ch·ªçn quan tr·ªçng
        let gameStats = {
            health: 100,
            mental: 100,
            tuanRel: 0,
            minhRel: 50,
            lanRel: 0,
            familyRel: 80,
            grades: 75,
            reputation: 70,
            addiction: 0,
            pressure: 20
        };
        
        const acts = {
            1: {
                title: "Ng√≤i N·ªï",
                chapters: {
                    1: {
                        title: "T√¢n H·ªçc Sinh",
                        background: "bg-school-gate",
                        dialogues: [
                            {
                                speaker: 'K·ªÉ chuy·ªán',
                                text: 'Ng√†y ƒë·∫ßu ti√™n c·ªßa nƒÉm h·ªçc m·ªõi t·∫°i tr∆∞·ªùng THPT Nguy·ªÖn Du. An ƒë·ª©ng tr∆∞·ªõc c·ªïng tr∆∞·ªùng, c·∫£m nh·∫≠n kh√¥ng kh√≠ t∆∞∆°i m·ªõi c·ªßa m·ªôt kh·ªüi ƒë·∫ßu...',
                                character: null
                            },
                            {
                                speaker: 'An',
                                text: 'NƒÉm cu·ªëi c·∫•p r·ªìi... Hy v·ªçng nƒÉm n√†y s·∫Ω kh√°c bi·ªát. M√¨nh ph·∫£i c·ªë g·∫Øng ƒë·ªÉ v√†o ƒë∆∞·ª£c ƒë·∫°i h·ªçc m∆° ∆∞·ªõc.',
                                character: 'characterAn'
                            },
                            {
                                speaker: 'Minh',
                                text: 'An! B·∫°n ƒë·∫øn s·ªõm v·∫≠y! M√¨nh c√≥ tin hot ƒë√¢y - l·ªõp m√¨nh c√≥ h·ªçc sinh chuy·ªÉn tr∆∞·ªùng m·ªõi, nghe n√≥i r·∫•t cool!',
                                character: 'characterMinh'
                            },
                            {
                                speaker: 'An',
                                text: 'H·ªçc sinh chuy·ªÉn tr∆∞·ªùng √†? Th√∫ v·ªã ƒë·∫•y. Hy v·ªçng b·∫°n ·∫•y d·ªÖ g·∫ßn.',
                                character: 'characterAn',
                                choices: [
                                    { 
                                        text: 'M√¨nh t√≤ m√≤ v·ªÅ b·∫°n m·ªõi n√†y. B·∫°n ·∫•y nh∆∞ th·∫ø n√†o?', 
                                        effect: { curiosity: 1 },
                                        memory: 'curious_about_tuan'
                                    },
                                    { 
                                        text: 'Mi·ªÖn l√† kh√¥ng l√†m ·∫£nh h∆∞·ªüng ƒë·∫øn vi·ªác h·ªçc c·ªßa m√¨nh.', 
                                        effect: { grades: 2, pressure: 1 },
                                        memory: 'focused_on_studies'
                                    },
                                    { 
                                        text: 'Hy v·ªçng m√¨nh c√≥ th·ªÉ k·∫øt b·∫°n v·ªõi b·∫°n ·∫•y.', 
                                        effect: { minhRel: 1 },
                                        memory: 'wants_friendship'
                                    }
                                ]
                            },
                            {
                                speaker: 'Minh',
                                text: 'B·∫°n ·∫•y t√™n Tu·∫•n, t·ª´ S√†i G√≤n chuy·ªÉn l√™n. ƒÇn m·∫∑c r·∫•t trendy, c√≥ v·∫ª nh∆∞ thu·ªôc t√≠p "cool kid" ƒë·∫•y!',
                                character: 'characterMinh'
                            }
                        ]
                    },
                    2: {
                        title: "Cu·ªôc G·∫∑p G·ª°",
                        background: "bg-classroom",
                        dialogues: [
                            {
                                speaker: 'K·ªÉ chuy·ªán',
                                text: 'Trong l·ªõp h·ªçc, An nh√¨n th·∫•y Tu·∫•n ng·ªìi ·ªü h√†ng gh·∫ø cu·ªëi. Anh ta ƒëang thu h√∫t s·ª± ch√∫ √Ω c·ªßa nhi·ªÅu b·∫°n v·ªõi phong c√°ch ƒÉn m·∫∑c n·ªïi b·∫≠t.',
                                character: null
                            },
                            {
                                speaker: 'Tu·∫•n',
                                text: 'Ch√†o m·ªçi ng∆∞·ªùi! M√¨nh l√† Tu·∫•n, m·ªõi chuy·ªÉn t·ª´ TP.HCM l√™n. Hy v·ªçng s·∫Ω c√≥ nh·ªØng tr·∫£i nghi·ªám th√∫ v·ªã ·ªü ƒë√¢y!',
                                character: 'characterTuan'
                            },
                            {
                                speaker: 'Minh',
                                text: 'An, m√¨nh gi·ªõi thi·ªáu b·∫°n v·ªõi Tu·∫•n nh√©! Tu·∫•n, ƒë√¢y l√† An - b·∫°n th√¢n nh·∫•t c·ªßa m√¨nh.',
                                character: 'characterMinh'
                            },
                            {
                                speaker: 'Tu·∫•n',
                                text: 'Ch√†o An! M√¨nh nghe Minh k·ªÉ v·ªÅ b·∫°n r·ªìi. B·∫°n c√≥ v·∫ª l√† ng∆∞·ªùi nghi√™m t√∫c ƒë·∫•y.',
                                character: 'characterTuan',
                                choices: [
                                    { 
                                        text: 'Ch√†o Tu·∫•n! M√¨nh r·∫•t vui ƒë∆∞·ª£c l√†m quen. S√†i G√≤n kh√°c H√† N·ªôi nhi·ªÅu l·∫Øm ph·∫£i kh√¥ng?', 
                                        effect: { tuanRel: 2, minhRel: 1 },
                                        memory: 'friendly_first_impression'
                                    },
                                    { 
                                        text: 'Ch√†o... *h∆°i ng·∫°i ng√πng* M√¨nh kh√¥ng gi·ªèi giao ti·∫øp l·∫Øm.', 
                                        effect: { tuanRel: -1, mental: -2 },
                                        memory: 'shy_first_impression'
                                    },
                                    { 
                                        text: 'Nghi√™m t√∫c l√† t·ªët m√†. NƒÉm cu·ªëi r·ªìi, ph·∫£i t·∫≠p trung v√†o h·ªçc.', 
                                        effect: { grades: 1, tuanRel: -1, reputation: 1 },
                                        memory: 'serious_first_impression'
                                    }
                                ]
                            },
                            {
                                speaker: 'Tu·∫•n',
                                text: 'Haha, m·ªói n∆°i m·ªôt v·∫ª. ·ªû S√†i G√≤n m√¨nh quen v·ªõi nh·ªãp s·ªëng nhanh h∆°n. C√≤n ·ªü ƒë√¢y th√¨... c√≥ v·∫ª chill h∆°n.',
                                character: 'characterTuan'
                            }
                        ]
                    },
                    3: {
                        title: "L·ªùi M·ªùi ƒê·∫ßu Ti√™n",
                        background: "bg-school-yard",
                        dialogues: [
                            {
                                speaker: 'K·ªÉ chuy·ªán',
                                text: 'Sau gi·ªù h·ªçc, khi An ƒëang chu·∫©n b·ªã v·ªÅ nh√†, Tu·∫•n v√† Minh ti·∫øn ƒë·∫øn.',
                                character: null
                            },
                            {
                                speaker: 'Tu·∫•n',
                                text: 'N√†y An, Minh! C√°c b·∫°n c√≥ r·∫£nh kh√¥ng? M√¨nh mu·ªën kh√°m ph√° khu√¥n vi√™n tr∆∞·ªùng m·ªôt ch√∫t.',
                                character: 'characterTuan'
                            },
                            {
                                speaker: 'Minh',
                                text: '√ù t∆∞·ªüng hay ƒë·∫•y! An, m√¨nh ƒëi c√πng nh√©?',
                                character: 'characterMinh'
                            },
                            {
                                speaker: 'An',
                                text: 'Kh√°m ph√° tr∆∞·ªùng √†? Nghe c√≥ v·∫ª th√∫ v·ªã...',
                                character: 'characterAn',
                                choices: [
                                    { 
                                        text: 'ƒê∆∞·ª£c th√¥i! M√¨nh c≈©ng mu·ªën t√¨m hi·ªÉu th√™m v·ªÅ tr∆∞·ªùng.', 
                                        effect: { tuanRel: 2, minhRel: 1 },
                                        memory: 'agreed_to_explore'
                                    },
                                    { 
                                        text: 'M√¨nh ph·∫£i v·ªÅ nh√† s·ªõm h√¥m nay. L·∫ßn kh√°c nh√©!', 
                                        effect: { familyRel: 1, tuanRel: -1 },
                                        memory: 'chose_family_first'
                                    },
                                    { 
                                        text: 'M√¨nh c√≥ b√†i t·∫≠p c·∫ßn l√†m... Nh∆∞ng th√¥i, ƒëi m·ªôt l√°t c≈©ng ƒë∆∞·ª£c.', 
                                        effect: { grades: -1, tuanRel: 1, pressure: 1 },
                                        memory: 'reluctant_agreement'
                                    }
                                ]
                            },
                            {
                                speaker: 'Tu·∫•n',
                                text: 'Tuy·ªát! M√¨nh bi·∫øt m·ªôt ch·ªó hay ·ªü sau tr∆∞·ªùng. √çt ng∆∞·ªùi bi·∫øt l·∫Øm ƒë·∫•y.',
                                character: 'characterTuan'
                            }
                        ]
                    },
                    4: {
                        title: "B√≠ M·∫≠t Sau Tr∆∞·ªùng",
                        background: "bg-behind-school",
                        dialogues: [
                            {
                                speaker: 'K·ªÉ chuy·ªán',
                                text: 'Ba ng∆∞·ªùi ƒëi ƒë·∫øn khu v·ª±c sau tr∆∞·ªùng, n∆°i √≠t ng∆∞·ªùi qua l·∫°i. Tu·∫•n d·∫´n h·ªç ƒë·∫øn m·ªôt g√≥c khu·∫•t sau nh·ªØng c√¢y c·ªï th·ª•.',
                                character: null
                            },
                            {
                                speaker: 'Tu·∫•n',
                                text: 'ƒê√¢y r·ªìi! Ch·ªó n√†y y√™n tƒ©nh, kh√¥ng ai l√†m phi·ªÅn. ·ªû S√†i G√≤n m√¨nh c≈©ng c√≥ nh·ªØng ch·ªó nh∆∞ th·∫ø n√†y.',
                                character: 'characterTuan'
                            },
                            {
                                speaker: 'Minh',
                                text: 'Wow, m√¨nh h·ªçc ·ªü ƒë√¢y 2 nƒÉm m√† ch∆∞a bi·∫øt c√≥ ch·ªó n√†y. B·∫°n kh√°m ph√° gi·ªèi th·∫≠t!',
                                character: 'characterMinh'
                            },
                            {
                                speaker: 'Tu·∫•n',
                                text: 'N√†y... c√°c b·∫°n c√≥ mu·ªën th·ª≠ c√°i n√†y kh√¥ng? *l·∫•y ra m·ªôt chi·∫øc vape nh·ªè g·ªçn* ·ªû S√†i G√≤n ai c≈©ng d√πng, kh√¥ng c√≥ g√¨ ƒë√¢u.',
                                character: 'characterTuan',
                                memory_check: true
                            },
                            {
                                speaker: 'Minh',
                                text: '∆†... vape √†? M√¨nh ch∆∞a th·ª≠ bao gi·ªù. An, b·∫°n nghƒ© sao?',
                                character: 'characterMinh'
                            },
                            {
                                speaker: 'An',
                                text: 'ƒê√¢y l√† l·ª±a ch·ªçn quan tr·ªçng ƒë·∫ßu ti√™n... M√¨nh n√™n l√†m g√¨?',
                                character: 'characterAn',
                                choices: [
                                    { 
                                        text: 'Th·ª≠ m·ªôt ch√∫t c≈©ng kh√¥ng sao. M√¨nh t√≤ m√≤ n√≥ nh∆∞ th·∫ø n√†o.', 
                                        effect: { tuanRel: 3, addiction: 5, health: -5, reputation: -2 },
                                        memory: 'first_vape_yes',
                                        consequence: 'B·∫°n ƒë√£ th·ª≠ vape l·∫ßn ƒë·∫ßu. ƒêi·ªÅu n√†y s·∫Ω ·∫£nh h∆∞·ªüng ƒë·∫øn t∆∞∆°ng lai...'
                                    },
                                    { 
                                        text: 'Kh√¥ng, c·∫£m ∆°n. M√¨nh kh√¥ng mu·ªën th·ª≠ nh·ªØng th·ª© nh∆∞ v·∫≠y.', 
                                        effect: { tuanRel: -2, minhRel: 1, health: 2, reputation: 1 },
                                        memory: 'first_vape_no',
                                        consequence: 'B·∫°n ƒë√£ t·ª´ ch·ªëi. Tu·∫•n c√≥ v·∫ª h∆°i th·∫•t v·ªçng...'
                                    },
                                    { 
                                        text: 'M√¨nh... m√¨nh c·∫ßn suy nghƒ© th√™m. H√¥m nay th√¥i nh√©.', 
                                        effect: { pressure: 2, mental: -1 },
                                        memory: 'first_vape_hesitate',
                                        consequence: 'B·∫°n ƒë√£ tr√¨ ho√£n quy·∫øt ƒë·ªãnh. √Åp l·ª±c tƒÉng l√™n...'
                                    }
                                ]
                            }
                        ]
                    },
                    5: {
                        title: "H·∫≠u Qu·∫£ ƒê·∫ßu Ti√™n",
                        background: "bg-home",
                        dialogues: [
                            {
                                speaker: 'K·ªÉ chuy·ªán',
                                text: 'T·ªëi h√¥m ƒë√≥, An v·ªÅ nh√† v·ªõi t√¢m tr·∫°ng ph·ª©c t·∫°p. Nh·ªØng g√¨ x·∫£y ra h√¥m nay s·∫Ω ·∫£nh h∆∞·ªüng nh∆∞ th·∫ø n√†o ƒë·∫øn t∆∞∆°ng lai?',
                                character: null
                            },
                            {
                                speaker: 'M·∫π An',
                                text: 'Con v·ªÅ mu·ªôn h√¥m nay nh·ªâ? C√≥ chuy·ªán g√¨ vui ·ªü tr∆∞·ªùng kh√¥ng?',
                                character: null
                            },
                            {
                                speaker: 'An',
                                text: 'D·∫°... con c√≥ l√†m quen v·ªõi b·∫°n m·ªõi. B·∫°n ·∫•y t·ª´ S√†i G√≤n chuy·ªÉn l√™n.',
                                character: 'characterAn',
                                dynamic: true // Dialogue thay ƒë·ªïi d·ª±a tr√™n memory
                            }
                        ]
                    },
                    6: {
                        title: "Chuy·ªán Gia ƒê√¨nh",
                        background: "bg-home",
                        dialogues: [
                            {
                                speaker: 'K·ªÉ chuy·ªán',
                                text: 'V√†i ng√†y sau, kh√¥ng kh√≠ gia ƒë√¨nh An c√≥ ch√∫t cƒÉng th·∫≥ng. B·ªë m·∫π d∆∞·ªùng nh∆∞ c·∫£m nh·∫≠n ƒë∆∞·ª£c s·ª± thay ƒë·ªïi trong con trai.',
                                character: null
                            },
                            {
                                speaker: 'B·ªë An',
                                text: 'An, b·ªë mu·ªën n√≥i chuy·ªán v·ªõi con. Ng·ªìi xu·ªëng ƒë√¢y.',
                                character: null
                            },
                            {
                                speaker: 'An',
                                text: 'D·∫° b·ªë. C√≥ chuy·ªán g√¨ ·∫°?',
                                character: 'characterAn'
                            },
                            {
                                speaker: 'B·ªë An',
                                text: 'B·ªë mu·ªën k·ªÉ cho con nghe v·ªÅ qu√° kh·ª© c·ªßa b·ªë. Ng√†y x∆∞a, b·ªë c≈©ng t·ª´ng h√∫t thu·ªëc l√°.',
                                character: null
                            },
                            {
                                speaker: 'An',
                                text: 'B·ªë t·ª´ng h√∫t thu·ªëc √†? Con kh√¥ng bi·∫øt...',
                                character: 'characterAn'
                            },
                            {
                                speaker: 'B·ªë An',
                                text: 'B·ªë b·∫Øt ƒë·∫ßu t·ª´ nƒÉm 18 tu·ªïi, nghƒ© r·∫±ng n√≥ gi√∫p b·ªë "cool" h∆°n, d·ªÖ h√≤a nh·∫≠p v·ªõi b·∫°n b√®. Nh∆∞ng r·ªìi...',
                                character: null
                            },
                            {
                                speaker: 'B·ªë An',
                                text: 'NƒÉm 25 tu·ªïi, b·ªë b·ªã vi√™m ph·ªïi n·∫∑ng. B√°c sƒ© n√≥i b·ªë su√Ωt m·∫•t m·∫°ng. Ph·ªïi b·ªë b·ªã t·ªïn th∆∞∆°ng nghi√™m tr·ªçng v√¨ thu·ªëc l√°.',
                                character: null
                            },
                            {
                                speaker: 'M·∫π An',
                                text: 'L√∫c ƒë√≥ m·∫π v√† b·ªë m·ªõi c∆∞·ªõi. M·∫π ƒë√£ kh√≥c r·∫•t nhi·ªÅu khi th·∫•y b·ªë n·∫±m vi·ªán, th·ªü b·∫±ng m√°y.',
                                character: null
                            },
                            {
                                speaker: 'B·ªë An',
                                text: 'B·ªë ph·∫£i n·∫±m vi·ªán 3 th√°ng, b·ªè thu·ªëc ho√†n to√†n. T·ª´ ƒë√≥ b·ªë hi·ªÉu: kh√¥ng c√≥ g√¨ "cool" khi l√†m h·∫°i s·ª©c kh·ªèe b·∫£n th√¢n.',
                                character: null
                            },
                            {
                                speaker: 'An',
                                text: 'Con... con hi·ªÉu r·ªìi ·∫°.',
                                character: 'characterAn',
                                dynamic: true
                            },
                            {
                                speaker: 'M·∫π An',
                                text: 'Con c√≥ b·∫°n n√†o h√∫t thu·ªëc ho·∫∑c vape kh√¥ng? M·∫π nghe n√≥i gi·ªù c√°c b·∫°n tr·∫ª d·ªÖ b·ªã l√¥i k√©o l·∫Øm.',
                                character: null,
                                choices: [
                                    { 
                                        text: 'D·∫° c√≥... v√† con c≈©ng ƒë√£ th·ª≠ r·ªìi. Con xin l·ªói b·ªë m·∫π.', 
                                        effect: { familyRel: -10, mental: -8, health: 3, addiction: -3 },
                                        memory: 'confessed_vaping_to_parents',
                                        consequence: 'S·ª± th√†nh th·∫≠t ƒëau l√≤ng nh∆∞ng c√≥ th·ªÉ l√† b∆∞·ªõc ƒë·∫ßu ƒë·ªÉ thay ƒë·ªïi...'
                                    },
                                    { 
                                        text: 'D·∫° c√≥ m·ªôt s·ªë b·∫°n, nh∆∞ng con kh√¥ng tham gia ƒë√¢u ·∫°.', 
                                        effect: { familyRel: 2, mental: 1 },
                                        memory: 'lied_to_parents_about_vaping'
                                    },
                                    { 
                                        text: 'Con c√≥ b·∫°n nh∆∞ v·∫≠y, v√† con ƒëang c·ªë g·∫Øng tr√°nh xa h·ªç.', 
                                        effect: { familyRel: 3, mental: 2, health: 2 },
                                        memory: 'honest_about_avoiding_bad_friends'
                                    }
                                ]
                            },
                            {
                                speaker: 'B·ªë An',
                                text: 'B·ªë tin con l√† ƒë·ª©a tr·∫ª th√¥ng minh. Nh∆∞ng n·∫øu c√≥ chuy·ªán g√¨, con ph·∫£i n√≥i v·ªõi b·ªë m·∫π nh√©.',
                                character: null,
                                dynamic: true
                            },
                            {
                                speaker: 'M·∫π An',
                                text: 'T·ª´ gi·ªù m·∫π s·∫Ω ch√∫ √Ω h∆°n ƒë·∫øn con. Kh√¥ng ph·∫£i v√¨ kh√¥ng tin, m√† v√¨ y√™u th∆∞∆°ng.',
                                character: null,
                                dynamic: true
                            }
                        ]
                    },
                    7: {
                        title: "Minh Thay ƒê·ªïi",
                        background: "bg-classroom",
                        dialogues: [
                            {
                                speaker: 'K·ªÉ chuy·ªán',
                                text: 'Ng√†y h√¥m sau, An b∆∞·ªõc v√†o l·ªõp v√† c·∫£m nh·∫≠n ƒë∆∞·ª£c kh√¥ng kh√≠ kh√°c l·∫°. C√≥ nh·ªØng c√°i nh√¨n t√≤ m√≤, nh·ªØng ti·∫øng th√¨ th·∫ßm...',
                                character: null
                            },
                            {
                                speaker: 'B·∫°n l·ªõp A',
                                text: 'Nghe n√≥i h√¥m qua An ƒëi ch∆°i v·ªõi Tu·∫•n ƒë·∫•y. H·ªç c√≥ l√†m g√¨ ƒë·∫∑c bi·ªát kh√¥ng nh·ªâ?',
                                character: null
                            },
                            {
                                speaker: 'B·∫°n l·ªõp B',
                                text: 'M√¨nh th·∫•y h·ªç ƒëi v·ªÅ ph√≠a sau tr∆∞·ªùng... Ch·∫Øc c√≥ chuy·ªán g√¨ hay ho l·∫Øm.',
                                character: null
                            },
                            {
                                speaker: 'An',
                                text: 'Sao m·ªçi ng∆∞·ªùi l·∫°i b√†n t√°n v·ªÅ m√¨nh v·∫≠y? C√≥ v·∫ª nh∆∞ tin ƒë·ªìn ƒë√£ b·∫Øt ƒë·∫ßu lan...',
                                character: 'characterAn',
                                dynamic: true
                            },
                            {
                                speaker: 'Lan',
                                text: 'An, m√¨nh c√≥ th·ªÉ n√≥i chuy·ªán v·ªõi b·∫°n m·ªôt ch√∫t kh√¥ng? *nh√¨n lo l·∫Øng*',
                                character: 'characterLan'
                            },
                            {
                                speaker: 'An',
                                text: 'Ch√†o Lan... C√≥ chuy·ªán g√¨ v·∫≠y?',
                                character: 'characterAn',
                                choices: [
                                    { 
                                        text: 'M√¨nh bi·∫øt b·∫°n lo l·∫Øng g√¨. Nh∆∞ng kh√¥ng c√≥ g√¨ ƒë√¢u, ch·ªâ l√† tin ƒë·ªìn th√¥i.', 
                                        effect: { lanRel: -1, reputation: -1, pressure: 2 },
                                        memory: 'denied_to_lan'
                                    },
                                    { 
                                        text: 'M√¨nh... m√¨nh c√≥ th·ªÉ gi·∫£i th√≠ch. B·∫°n mu·ªën nghe kh√¥ng?', 
                                        effect: { lanRel: 2, mental: -1 },
                                        memory: 'honest_with_lan'
                                    },
                                    { 
                                        text: 'Tin ƒë·ªìn lan nhanh th·∫≠t. M√¨nh kh√¥ng nghƒ© s·∫Ω c√≥ chuy·ªán n√†y.', 
                                        effect: { lanRel: 1, pressure: 1 },
                                        memory: 'surprised_by_rumors'
                                    }
                                ]
                            },
                            {
                                speaker: 'Th·∫ßy B√¨nh',
                                text: 'An, th·∫ßy mu·ªën n√≥i chuy·ªán v·ªõi em sau gi·ªù h·ªçc. C√≥ v√†i ƒëi·ªÅu th·∫ßy c·∫ßn l√†m r√µ.',
                                character: null,
                                dynamic: true
                            },
                            {
                                speaker: 'Tu·∫•n',
                                text: '*ƒë·∫øn g·∫ßn An* N√†y b·∫°n, c√≥ v·∫ª nh∆∞ ch√∫ng ta ƒë√£ g√¢y ch√∫ √Ω r·ªìi. B·∫°n c√≥ mu·ªën tham gia nh√≥m chat c·ªßa m√¨nh kh√¥ng?',
                                character: 'characterTuan',
                                dynamic: true
                            },
                            {
                                speaker: 'An',
                                text: 'Nh√≥m chat? Nh√≥m g√¨ v·∫≠y?',
                                character: 'characterAn',
                                choices: [
                                    { 
                                        text: 'M√¨nh quan t√¢m. Nh√≥m ƒë√≥ l√†m g√¨?', 
                                        effect: { tuanRel: 2, pressure: 3, reputation: -2 },
                                        memory: 'interested_in_secret_group',
                                        consequence: 'B·∫°n ƒë√£ b∆∞·ªõc v√†o th·∫ø gi·ªõi b√≠ m·∫≠t...'
                                    },
                                    { 
                                        text: 'M√¨nh kh√¥ng ch·∫Øc... C√≥ v·∫ª r·ªßi ro qu√°.', 
                                        effect: { tuanRel: -2, mental: 1 },
                                        memory: 'hesitant_about_group'
                                    },
                                    { 
                                        text: 'Kh√¥ng, c·∫£m ∆°n. M√¨nh kh√¥ng mu·ªën d√≠nh v√†o chuy·ªán r·∫Øc r·ªëi.', 
                                        effect: { tuanRel: -3, reputation: 2, lanRel: 1 },
                                        memory: 'rejected_secret_group',
                                        consequence: 'Tu·∫•n nh√¨n b·∫°n nh∆∞ "ng∆∞·ªùi ngo√†i cu·ªôc"...'
                                    }
                                ]
                            }
                        ]
                    },
                    7: {
                        title: "Minh Thay ƒê·ªïi",
                        background: "bg-classroom",
                        dialogues: [
                            {
                                speaker: 'K·ªÉ chuy·ªán',
                                text: 'M·ªôt tu·∫ßn sau cu·ªôc n√≥i chuy·ªán v·ªõi gia ƒë√¨nh, An nh·∫≠n ra Minh ƒë√£ thay ƒë·ªïi r√µ r·ªát. B·∫°n th√¢n nh·∫•t c·ªßa m√¨nh gi·ªù d√†nh nhi·ªÅu th·ªùi gian h∆°n v·ªõi Tu·∫•n.',
                                character: null
                            },
                            {
                                speaker: 'An',
                                text: 'Minh! *v·∫´y tay* Sao h√¥m nay b·∫°n kh√¥ng ng·ªìi c√πng m√¨nh?',
                                character: 'characterAn'
                            },
                            {
                                speaker: 'Minh',
                                text: '*nh√¨n l·∫°i m·ªôt c√°ch l·∫°nh l√πng* √Ä... An. M√¨nh ƒëang b·∫≠n v·ªõi nh√≥m c·ªßa Tu·∫•n.',
                                character: 'characterMinh'
                            },
                            {
                                speaker: 'Tu·∫•n',
                                text: 'Ch√†o An! Minh gi·ªù l√† th√†nh vi√™n t√≠ch c·ª±c c·ªßa nh√≥m m√¨nh r·ªìi ƒë·∫•y.',
                                character: 'characterTuan'
                            },
                            {
                                speaker: 'An',
                                text: 'Minh... ch√∫ng ta l√† b·∫°n th√¢n m√†. Sao b·∫°n l·∫°i thay ƒë·ªïi th·∫ø n√†y?',
                                character: 'characterAn'
                            },
                            {
                                speaker: 'Minh',
                                text: 'Thay ƒë·ªïi? Hay l√† b·∫°n kh√¥ng mu·ªën thay ƒë·ªïi?',
                                character: 'characterMinh',
                                dynamic: true
                            },
                            {
                                speaker: 'Tu·∫•n',
                                text: 'Minh ƒë√£ k·ªÉ v·ªõi m√¨nh v·ªÅ t√≠nh c√°ch c·ªßa b·∫°n r·ªìi.',
                                character: 'characterTuan',
                                dynamic: true
                            },
                            {
                                speaker: 'An',
                                text: 'T√≠nh c√°ch g√¨? M√¨nh ch·ªâ mu·ªën t·∫≠p trung v√†o h·ªçc th√¥i m√†...',
                                character: 'characterAn',
                                choices: [
                                    { 
                                        text: 'Minh, t√¨nh b·∫°n c·ªßa ch√∫ng ta quan tr·ªçng h∆°n nh·ªØng th·ª© n√†y.', 
                                        effect: { minhRel: -3, mental: -3, pressure: 3 },
                                        memory: 'tried_to_save_friendship_minh'
                                    },
                                    { 
                                        text: 'N·∫øu Minh mu·ªën thay ƒë·ªïi th√¨... m√¨nh c≈©ng s·∫Ω th·ª≠.', 
                                        effect: { minhRel: 2, tuanRel: 3, addiction: 5, health: -5 },
                                        memory: 'gave_in_to_minh_pressure',
                                        consequence: '√Åp l·ª±c b·∫°n b√® ƒë√£ th·∫Øng... ƒê√¢y l√† b∆∞·ªõc ƒë·∫ßu c·ªßa s·ª± sa ng√£.'
                                    },
                                    { 
                                        text: 'N·∫øu ƒë√≥ l√† l·ª±a ch·ªçn c·ªßa Minh th√¨ m√¨nh t√¥n tr·ªçng.', 
                                        effect: { minhRel: -1, mental: -2, reputation: 1 },
                                        memory: 'accepted_minh_choice'
                                    }
                                ]
                            },
                            {
                                speaker: 'Minh',
                                text: 'An, b·∫°n kh√¥ng hi·ªÉu ƒë√¢u. Cu·ªôc s·ªëng kh√¥ng ch·ªâ c√≥ h·ªçc h√†nh.',
                                character: 'characterMinh',
                                dynamic: true
                            },
                            {
                                speaker: 'Tu·∫•n',
                                text: 'ƒê√∫ng r·ªìi! Ch√∫ng m√¨nh c√≥ nhi·ªÅu ho·∫°t ƒë·ªông th√∫ v·ªã l·∫Øm.',
                                character: 'characterTuan',
                                dynamic: true
                            },
                            {
                                speaker: 'K·ªÉ chuy·ªán',
                                text: 'Sau gi·ªù h·ªçc, An th·∫•y Minh v√† Tu·∫•n ƒëi v·ªÅ h∆∞·ªõng kh√°c, kh√¥ng m·ªùi m√¨nh nh∆∞ tr∆∞·ªõc...',
                                character: null
                            },
                            {
                                speaker: 'An',
                                text: 'T√¨nh b·∫°n 10 nƒÉm... c√≥ d·ªÖ d√†ng thay ƒë·ªïi th·∫ø kh√¥ng?',
                                character: 'characterAn',
                                dynamic: true
                            }
                        ]
                    }
                }
            },
            2: {
                title: "C√°m D·ªó & R·∫°n N·ª©t",
                chapters: {
                    8: {
                        title: "L√†n S√≥ng Tin ƒê·ªìn",
                        background: "bg-classroom",
                        dialogues: [
                            {
                                speaker: 'K·ªÉ chuy·ªán',
                                text: 'Ng√†y h√¥m sau, An b∆∞·ªõc v√†o l·ªõp v√† c·∫£m nh·∫≠n ƒë∆∞·ª£c kh√¥ng kh√≠ kh√°c l·∫°. C√≥ nh·ªØng c√°i nh√¨n t√≤ m√≤, nh·ªØng ti·∫øng th√¨ th·∫ßm...',
                                character: null
                            },
                            {
                                speaker: 'B·∫°n l·ªõp A',
                                text: 'Nghe n√≥i h√¥m qua An ƒëi ch∆°i v·ªõi Tu·∫•n ƒë·∫•y. H·ªç c√≥ l√†m g√¨ ƒë·∫∑c bi·ªát kh√¥ng nh·ªâ?',
                                character: null
                            },
                            {
                                speaker: 'B·∫°n l·ªõp B',
                                text: 'M√¨nh th·∫•y h·ªç ƒëi v·ªÅ ph√≠a sau tr∆∞·ªùng... Ch·∫Øc c√≥ chuy·ªán g√¨ hay ho l·∫Øm.',
                                character: null
                            },
                            {
                                speaker: 'An',
                                text: 'Sao m·ªçi ng∆∞·ªùi l·∫°i b√†n t√°n v·ªÅ m√¨nh v·∫≠y? C√≥ v·∫ª nh∆∞ tin ƒë·ªìn ƒë√£ b·∫Øt ƒë·∫ßu lan...',
                                character: 'characterAn',
                                dynamic: true
                            },
                            {
                                speaker: 'Lan',
                                text: 'An, m√¨nh c√≥ th·ªÉ n√≥i chuy·ªán v·ªõi b·∫°n m·ªôt ch√∫t kh√¥ng? *nh√¨n lo l·∫Øng*',
                                character: 'characterLan'
                            },
                            {
                                speaker: 'An',
                                text: 'Ch√†o Lan... C√≥ chuy·ªán g√¨ v·∫≠y?',
                                character: 'characterAn',
                                choices: [
                                    { 
                                        text: 'M√¨nh bi·∫øt b·∫°n lo l·∫Øng g√¨. Nh∆∞ng kh√¥ng c√≥ g√¨ ƒë√¢u, ch·ªâ l√† tin ƒë·ªìn th√¥i.', 
                                        effect: { lanRel: -1, reputation: -1, pressure: 2 },
                                        memory: 'denied_to_lan'
                                    },
                                    { 
                                        text: 'M√¨nh... m√¨nh c√≥ th·ªÉ gi·∫£i th√≠ch. B·∫°n mu·ªën nghe kh√¥ng?', 
                                        effect: { lanRel: 2, mental: -1 },
                                        memory: 'honest_with_lan'
                                    },
                                    { 
                                        text: 'Tin ƒë·ªìn lan nhanh th·∫≠t. M√¨nh kh√¥ng nghƒ© s·∫Ω c√≥ chuy·ªán n√†y.', 
                                        effect: { lanRel: 1, pressure: 1 },
                                        memory: 'surprised_by_rumors'
                                    }
                                ]
                            },
                            {
                                speaker: 'Lan',
                                text: 'An, m√¨nh c·∫ßn cho b·∫°n xem m·ªôt th·ª©. *l·∫•y ƒëi·ªán tho·∫°i ra* ƒê√¢y l√† ·∫£nh em trai m√¨nh...',
                                character: 'characterLan'
                            },
                            {
                                speaker: 'K·ªÉ chuy·ªán',
                                text: 'Lan cho An xem nh·ªØng b·ª©c ·∫£nh ƒëau l√≤ng: em trai c√¥ ·∫•y n·∫±m vi·ªán, nh·ªØng b·ª©c ·∫£nh X-quang ph·ªïi b·ªã t·ªïn th∆∞∆°ng n·∫∑ng n·ªÅ...',
                                character: null
                            },
                            {
                                speaker: 'Lan',
                                text: 'Em trai m√¨nh b·∫Øt ƒë·∫ßu t·ª´ vape, r·ªìi chuy·ªÉn sang thu·ªëc l√°, r·ªìi... nh·ªØng th·ª© t·ªá h∆°n. Gi·ªù em ·∫•y ph·∫£i b·ªè h·ªçc, n·∫±m vi·ªán su·ªët.',
                                character: 'characterLan'
                            },
                            {
                                speaker: 'An',
                                text: 'Lan... m√¨nh kh√¥ng bi·∫øt... M√¨nh xin l·ªói v·ªÅ chuy·ªán em trai b·∫°n.',
                                character: 'characterAn',
                                choices: [
                                    { 
                                        text: 'M√¨nh h·ª©a s·∫Ω tr√°nh xa nh·ªØng th·ª© ƒë√≥. C·∫£m ∆°n b·∫°n ƒë√£ c·∫£nh b√°o m√¨nh.', 
                                        effect: { lanRel: 5, familyRel: 2, health: 3, reputation: 2, addiction: -3 },
                                        memory: 'promised_lan_avoid',
                                        consequence: 'L·ªùi h·ª©a v·ªõi Lan s·∫Ω ·∫£nh h∆∞·ªüng ƒë·∫øn t∆∞∆°ng lai...'
                                    },
                                    { 
                                        text: 'M√¨nh hi·ªÉu lo l·∫Øng c·ªßa b·∫°n... M√¨nh s·∫Ω c·∫©n th·∫≠n h∆°n.', 
                                        effect: { lanRel: 2, mental: 1 },
                                        memory: 'agreed_to_be_careful'
                                    },
                                    { 
                                        text: 'M·ªói ng∆∞·ªùi m·ªôt ho√†n c·∫£nh kh√°c nhau. M√¨nh bi·∫øt ki·ªÉm so√°t b·∫£n th√¢n.', 
                                        effect: { lanRel: -3, pressure: 3, reputation: -1 },
                                        memory: 'dismissed_lan_warning',
                                        consequence: 'Lan r·∫•t th·∫•t v·ªçng v·ªÅ th√°i ƒë·ªô c·ªßa b·∫°n...'
                                    }
                                ]
                            }
                        ]
                    },
                    9: {
                        title: "Party ƒê√™m",
                        background: "bg-party",
                        dialogues: [
                            {
                                speaker: 'K·ªÉ chuy·ªán',
                                text: 'Cu·ªëi tu·∫ßn, Tu·∫•n m·ªùi An ƒë·∫øn sinh nh·∫≠t c·ªßa Huy - m·ªôt b·∫°n nh√† gi√†u trong tr∆∞·ªùng. CƒÉn bi·ªát th·ª± sang tr·ªçng, √¢m nh·∫°c s√¥i ƒë·ªông...',
                                character: null
                            },
                            {
                                speaker: 'Tu·∫•n',
                                text: 'An! B·∫°n ƒë·∫øn r·ªìi! Ti·ªác n√†y s·∫Ω r·∫•t tuy·ªát ƒë·∫•y.',
                                character: 'characterTuan'
                            },
                            {
                                speaker: 'Huy',
                                text: 'Ch√†o m·ª´ng ƒë·∫øn v·ªõi ti·ªác sinh nh·∫≠t c·ªßa t√¥i! H√¥m nay ch√∫ng ta s·∫Ω qu√™n ƒëi m·ªçi lo l·∫Øng!',
                                character: null
                            },
                            {
                                speaker: 'K·ªÉ chuy·ªán',
                                text: 'An nh√¨n quanh v√† th·∫•y tr√™n b√†n c√≥ r∆∞·ª£u, vape c√°c lo·∫°i, v√† c·∫£ thu·ªëc l√° th∆∞·ªùng. M·ªôt s·ªë b·∫°n ƒë√£ b·∫Øt ƒë·∫ßu s·ª≠ d·ª•ng...',
                                character: null
                            },
                            {
                                speaker: 'Tu·∫•n',
                                text: 'N√†y An, b·∫°n th·ª≠ c√°i n√†y ch∆∞a? ƒê√¢y l√† l√∫c ƒë·ªÉ th·ª±c s·ª± th∆∞ gi√£n ƒë·∫•y.',
                                character: 'characterTuan',
                                dynamic: true
                            },
                            {
                                speaker: 'Minh',
                                text: '*ƒë√£ h∆°i say* An! B·∫°n ph·∫£i th·ª≠ ƒë·∫•y! C·∫£m gi√°c tuy·ªát v·ªùi l·∫Øm!',
                                character: 'characterMinh'
                            },
                            {
                                speaker: 'An',
                                text: 'Minh c√≥ v·∫ª ƒë√£... say r·ªìi. C√≤n m√¨nh th√¨ sao?',
                                character: 'characterAn',
                                choices: [
                                    { 
                                        text: 'Th√¥i ƒë∆∞·ª£c r·ªìi! H√¥m nay m√¨nh s·∫Ω th·ª≠ h·∫øt!', 
                                        effect: { tuanRel: 5, addiction: 15, health: -15, mental: -10, reputation: -5 },
                                        memory: 'party_full_participation',
                                        consequence: 'B·∫°n ƒë√£ ƒë·∫Øm ch√¨m trong ti·ªác t√πng... H·∫≠u qu·∫£ s·∫Ω r·∫•t nghi√™m tr·ªçng!'
                                    },
                                    { 
                                        text: 'M√¨nh ch·ªâ th·ª≠ m·ªôt ch√∫t th√¥i...', 
                                        effect: { tuanRel: 2, addiction: 8, health: -8, mental: -5, pressure: 3 },
                                        memory: 'party_light_participation',
                                        consequence: 'B·∫°n ƒë√£ th·ª≠ m·ªôt ch√∫t... Nh∆∞ng ƒëi·ªÅu n√†y v·∫´n c√≥ th·ªÉ g√¢y h·∫≠u qu·∫£.'
                                    },
                                    { 
                                        text: 'Kh√¥ng, c·∫£m ∆°n. M√¨nh ch·ªâ u·ªëng n∆∞·ªõc ng·ªçt th√¥i.', 
                                        effect: { tuanRel: -3, health: 3, reputation: 2, mental: 2, pressure: 5 },
                                        memory: 'party_refused_all',
                                        consequence: 'B·∫°n ƒë√£ ki√™n ƒë·ªãnh v·ªõi nguy√™n t·∫Øc... Nh∆∞ng Tu·∫•n kh√¥ng h√†i l√≤ng.'
                                    }
                                ]
                            }
                        ]
                    },
                    10: {
                        title: "Chuy·ªán Gia ƒê√¨nh",
                        background: "bg-home",
                        dialogues: [
                            {
                                speaker: 'K·ªÉ chuy·ªán',
                                text: 'T·ªëi h√¥m ƒë√≥, An v·ªÅ nh√† v·ªõi t√¢m tr·∫°ng n·∫∑ng n·ªÅ. B·ªë m·∫π ƒëang ng·ªìi xem TV trong ph√≤ng kh√°ch, kh√¥ng kh√≠ gia ƒë√¨nh ·∫•m c√∫ng t∆∞∆°ng ph·∫£n v·ªõi s·ª± b·∫•t an trong l√≤ng An.',
                                character: null
                            },
                            {
                                speaker: 'B·ªë An',
                                text: 'Con v·ªÅ r·ªìi √†? H√¥m nay ·ªü tr∆∞·ªùng c√≥ chuy·ªán g√¨ vui kh√¥ng?',
                                character: null
                            },
                            {
                                speaker: 'An',
                                text: 'D·∫°... b√¨nh th∆∞·ªùng th√¥i ·∫°. *ng·ªìi xu·ªëng, c·∫£m th·∫•y c√≥ l·ªói v·ªõi gia ƒë√¨nh*',
                                character: 'characterAn'
                            },
                            {
                                speaker: 'M·∫π An',
                                text: 'Con tr√¥ng c√≥ v·∫ª m·ªát m·ªèi. C√≥ ph·∫£i do √°p l·ª±c h·ªçc t·∫≠p kh√¥ng?',
                                character: null,
                                dynamic: true
                            },
                            {
                                speaker: 'B·ªë An',
                                text: '√Ä, n√≥i ƒë·∫øn chuy·ªán s·ª©c kh·ªèe... B·ªë mu·ªën k·ªÉ cho con nghe m·ªôt c√¢u chuy·ªán. Ng√†y x∆∞a, b·ªë c≈©ng t·ª´ng h√∫t thu·ªëc l√°.',
                                character: null
                            },
                            {
                                speaker: 'An',
                                text: 'B·ªë t·ª´ng h√∫t thu·ªëc √†? Con kh√¥ng bi·∫øt...',
                                character: 'characterAn'
                            },
                            {
                                speaker: 'B·ªë An',
                                text: 'B·ªë b·∫Øt ƒë·∫ßu t·ª´ nƒÉm 18 tu·ªïi, nghƒ© r·∫±ng n√≥ gi√∫p b·ªë "cool" h∆°n. Nh∆∞ng r·ªìi... *gi·ªçng nghi√™m tr·ªçng* B·ªë b·ªã vi√™m ph·ªïi n·∫∑ng, su√Ωt m·∫•t m·∫°ng.',
                                character: null
                            },
                            {
                                speaker: 'M·∫π An',
                                text: 'L√∫c ƒë√≥ m·∫π v√† b·ªë m·ªõi quen nhau. M·∫π ƒë√£ kh√≥c r·∫•t nhi·ªÅu khi th·∫•y b·ªë n·∫±m vi·ªán, th·ªü b·∫±ng m√°y.',
                                character: null
                            },
                            {
                                speaker: 'B·ªë An',
                                text: 'B·ªë ph·∫£i n·∫±m vi·ªán 2 th√°ng, b·ªè thu·ªëc ho√†n to√†n. Gi·ªù b·ªë mu·ªën con hi·ªÉu: kh√¥ng c√≥ g√¨ "cool" khi l√†m h·∫°i s·ª©c kh·ªèe b·∫£n th√¢n.',
                                character: null
                            },
                            {
                                speaker: 'An',
                                text: 'Con... con hi·ªÉu r·ªìi ·∫°. *c·∫£m th·∫•y t·ªôi l·ªói n·∫øu ƒë√£ h√∫t*',
                                character: 'characterAn',
                                dynamic: true
                            },
                            {
                                speaker: 'M·∫π An',
                                text: 'Con c√≥ b·∫°n n√†o h√∫t thu·ªëc ho·∫∑c vape kh√¥ng? M·∫π nghe n√≥i gi·ªù c√°c b·∫°n tr·∫ª d·ªÖ b·ªã l√¥i k√©o l·∫Øm.',
                                character: null,
                                choices: [
                                    { 
                                        text: 'D·∫° c√≥... v√† con c≈©ng ƒë√£ th·ª≠ r·ªìi. Con xin l·ªói b·ªë m·∫π.', 
                                        effect: { familyRel: -8, mental: -10, health: 5, addiction: -5 },
                                        memory: 'confessed_to_parents',
                                        consequence: 'S·ª± th√†nh th·∫≠t ƒëau l√≤ng nh∆∞ng c√≥ th·ªÉ l√† b∆∞·ªõc ƒë·∫ßu ƒë·ªÉ thay ƒë·ªïi...'
                                    },
                                    { 
                                        text: 'D·∫° c√≥ m·ªôt s·ªë b·∫°n, nh∆∞ng con kh√¥ng tham gia ƒë√¢u ·∫°.', 
                                        effect: { familyRel: 2, mental: 1 },
                                        memory: 'lied_to_parents'
                                    },
                                    { 
                                        text: 'Con c√≥ b·∫°n nh∆∞ v·∫≠y, v√† con ƒëang c·ªë g·∫Øng tr√°nh xa h·ªç.', 
                                        effect: { familyRel: 3, mental: 2, health: 2 },
                                        memory: 'honest_about_avoiding'
                                    }
                                ]
                            },
                            {
                                speaker: 'B·ªë An',
                                text: 'B·ªë tin con l√† ƒë·ª©a tr·∫ª th√¥ng minh. Nh∆∞ng n·∫øu c√≥ chuy·ªán g√¨, con ph·∫£i n√≥i v·ªõi b·ªë m·∫π nh√©.',
                                character: null,
                                dynamic: true
                            }
                        ]
                    },
                    11: {
                        title: "Minh Thay ƒê·ªïi",
                        background: "bg-school-yard",
                        dialogues: [
                            {
                                speaker: 'K·ªÉ chuy·ªán',
                                text: 'V√†i ng√†y sau, An nh·∫≠n ra Minh ƒë√£ thay ƒë·ªïi r√µ r·ªát. B·∫°n th√¢n nh·∫•t c·ªßa m√¨nh gi·ªù d√†nh nhi·ªÅu th·ªùi gian h∆°n v·ªõi Tu·∫•n v√† nh√≥m b·∫°n m·ªõi.',
                                character: null
                            },
                            {
                                speaker: 'An',
                                text: 'Minh! *v·∫´y tay* Sao h√¥m nay b·∫°n kh√¥ng ng·ªìi c√πng m√¨nh?',
                                character: 'characterAn'
                            },
                            {
                                speaker: 'Minh',
                                text: '*nh√¨n l·∫°i m·ªôt c√°ch l·∫°nh l√πng* √Ä... An. M√¨nh ƒëang b·∫≠n v·ªõi nh√≥m c·ªßa Tu·∫•n.',
                                character: 'characterMinh'
                            },
                            {
                                speaker: 'Tu·∫•n',
                                text: 'Ch√†o An! Minh gi·ªù l√† th√†nh vi√™n t√≠ch c·ª±c c·ªßa nh√≥m m√¨nh r·ªìi ƒë·∫•y. B·∫°n c√≥ mu·ªën tham gia kh√¥ng?',
                                character: 'characterTuan',
                                dynamic: true
                            },
                            {
                                speaker: 'An',
                                text: 'Minh... ch√∫ng ta l√† b·∫°n th√¢n m√†. Sao b·∫°n l·∫°i thay ƒë·ªïi th·∫ø n√†y?',
                                character: 'characterAn'
                            },
                            {
                                speaker: 'Minh',
                                text: 'Thay ƒë·ªïi? Hay l√† b·∫°n kh√¥ng mu·ªën thay ƒë·ªïi? *gi·ªçng h∆°i cay nghi·ªát*',
                                character: 'characterMinh',
                                dynamic: true
                            },
                            {
                                speaker: 'Tu·∫•n',
                                text: 'Minh ƒë√£ k·ªÉ v·ªõi m√¨nh v·ªÅ t√≠nh c√°ch c·ªßa b·∫°n r·ªìi. C√≥ v·∫ª nh∆∞ b·∫°n h∆°i... kh√≥ h√≤a nh·∫≠p.',
                                character: 'characterTuan',
                                dynamic: true
                            },
                            {
                                speaker: 'An',
                                text: 'Kh√≥ h√≤a nh·∫≠p? M√¨nh ch·ªâ mu·ªën t·∫≠p trung v√†o h·ªçc th√¥i m√†...',
                                character: 'characterAn',
                                choices: [
                                    { 
                                        text: 'Minh, t√¨nh b·∫°n c·ªßa ch√∫ng ta quan tr·ªçng h∆°n nh·ªØng th·ª© n√†y.', 
                                        effect: { minhRel: -2, mental: -3, pressure: 3 },
                                        memory: 'tried_to_save_friendship'
                                    },
                                    { 
                                        text: 'N·∫øu Minh mu·ªën thay ƒë·ªïi th√¨... m√¨nh c≈©ng s·∫Ω th·ª≠.', 
                                        effect: { minhRel: 2, tuanRel: 3, addiction: 5, health: -5 },
                                        memory: 'gave_in_to_peer_pressure',
                                        consequence: '√Åp l·ª±c b·∫°n b√® ƒë√£ th·∫Øng... ƒê√¢y l√† b∆∞·ªõc ƒë·∫ßu c·ªßa s·ª± sa ng√£.'
                                    },
                                    { 
                                        text: 'N·∫øu ƒë√≥ l√† l·ª±a ch·ªçn c·ªßa Minh th√¨ m√¨nh t√¥n tr·ªçng.', 
                                        effect: { minhRel: -1, mental: -2, reputation: 1 },
                                        memory: 'accepted_minh_choice'
                                    }
                                ]
                            },
                            {
                                speaker: 'Minh',
                                text: 'An, b·∫°n kh√¥ng hi·ªÉu ƒë√¢u. Cu·ªôc s·ªëng kh√¥ng ch·ªâ c√≥ h·ªçc h√†nh. C√≥ nh·ªØng tr·∫£i nghi·ªám m√† b·∫°n ƒëang b·ªè l·ª°.',
                                character: 'characterMinh',
                                dynamic: true
                            },
                            {
                                speaker: 'Tu·∫•n',
                                text: 'ƒê√∫ng r·ªìi! Tu·∫ßn sau ch√∫ng m√¨nh c√≥ party n·ªØa. L·∫ßn n√†y s·∫Ω c√≥ nhi·ªÅu th·ª© th√∫ v·ªã h∆°n ƒë·∫•y.',
                                character: 'characterTuan',
                                dynamic: true
                            },
                            {
                                speaker: 'An',
                                text: 'Nhi·ªÅu th·ª© th√∫ v·ªã h∆°n? √ù b·∫°n l√† g√¨?',
                                character: 'characterAn',
                                choices: [
                                    { 
                                        text: 'M√¨nh... m√¨nh s·∫Ω ƒëi. Nh∆∞ng ch·ªâ ƒë·ªÉ ·ªü c√πng Minh th√¥i.', 
                                        effect: { minhRel: 1, tuanRel: 2, pressure: 5, addiction: 3 },
                                        memory: 'agreed_to_next_party',
                                        consequence: 'B·∫°n ƒë√£ ƒë·ªìng √Ω tham gia party ti·∫øp theo... Nguy hi·ªÉm ƒëang ƒë·∫øn g·∫ßn.'
                                    },
                                    { 
                                        text: 'M√¨nh kh√¥ng nghƒ© ƒë√≥ l√† √Ω t∆∞·ªüng hay. C√°c b·∫°n c·∫©n th·∫≠n nh√©.', 
                                        effect: { minhRel: -3, tuanRel: -2, reputation: 2, mental: -1 },
                                        memory: 'refused_next_party'
                                    },
                                    { 
                                        text: 'M√¨nh c·∫ßn th·ªùi gian suy nghƒ©...', 
                                        effect: { pressure: 3, mental: -2 },
                                        memory: 'hesitant_about_party'
                                    }
                                ]
                            }
                        ]
                    },
                    9: {
                        title: "Video B·ªã R√≤ R·ªâ",
                        background: "bg-classroom",
                        dialogues: [
                            {
                                speaker: 'K·ªÉ chuy·ªán',
                                text: 'S√°ng th·ª© hai, An b∆∞·ªõc v√†o tr∆∞·ªùng v·ªõi t√¢m tr·∫°ng lo l·∫Øng. Kh√¥ng kh√≠ c√≥ v·∫ª kh√°c th∆∞·ªùng, nhi·ªÅu b·∫°n ƒëang x√¨ x√†o v√† nh√¨n v·ªÅ ph√≠a An...',
                                character: null
                            },
                            {
                                speaker: 'B·∫°n l·ªõp A',
                                text: '*th√¨ th·∫ßm* B·∫°n ƒë√£ xem video ƒë√≥ ch∆∞a? Lan truy·ªÅn tr√™n m·∫°ng t·ª´ t·ªëi qua...',
                                character: null
                            },
                            {
                                speaker: 'B·∫°n l·ªõp B',
                                text: '*nh√¨n An* √îi tr·ªùi, ch√≠nh l√† b·∫°n ·∫•y trong video ƒë√≥...',
                                character: null,
                                dynamic: true
                            },
                            {
                                speaker: 'An',
                                text: 'Video g√¨ v·∫≠y? Sao m·ªçi ng∆∞·ªùi l·∫°i nh√¨n m√¨nh th·∫ø n√†y?',
                                character: 'characterAn'
                            },
                            {
                                speaker: 'Minh',
                                text: '*ch·∫°y ƒë·∫øn v·ªõi v·∫ª m·∫∑t ho·∫£ng s·ª£* An! C√≥ video v·ªÅ party h√¥m tr∆∞·ªõc ƒëang viral tr√™n m·∫°ng!',
                                character: 'characterMinh'
                            },
                            {
                                speaker: 'An',
                                text: 'Video g√¨? Cho m√¨nh xem!',
                                character: 'characterAn',
                                dynamic: true
                            },
                            {
                                speaker: 'K·ªÉ chuy·ªán',
                                text: 'Minh ƒë∆∞a ƒëi·ªán tho·∫°i cho An xem. Video quay c·∫£nh party, c√≥ th·ªÉ th·∫•y r√µ m·ªôt s·ªë h·ªçc sinh ƒëang h√∫t vape v√† u·ªëng r∆∞·ª£u...',
                                character: null,
                                dynamic: true
                            },
                            {
                                speaker: 'An',
                                text: 'Kh√¥ng... kh√¥ng th·ªÉ n√†o!',
                                character: 'characterAn',
                                dynamic: true
                            },
                            {
                                speaker: 'Th·∫ßy B√¨nh',
                                text: '*xu·∫•t hi·ªán ƒë·ªôt ng·ªôt* An, em v√†o ph√≤ng hi·ªáu tr∆∞·ªüng ngay l·∫≠p t·ª©c!',
                                character: null,
                                dynamic: true
                            },
                            {
                                speaker: 'Hi·ªáu tr∆∞·ªüng',
                                text: 'An, th·∫ßy ƒë√£ xem video ƒë√≥ r·ªìi. ƒê√¢y l√† v·∫•n ƒë·ªÅ r·∫•t nghi√™m tr·ªçng.',
                                character: null,
                                dynamic: true
                            },
                            {
                                speaker: 'An',
                                text: 'Th∆∞a th·∫ßy...',
                                character: 'characterAn',
                                dynamic: true,
                                choices: [
                                    { 
                                        text: 'Em xin l·ªói th·∫ßy. Em bi·∫øt em ƒë√£ sai v√† s·∫Ω kh√¥ng t√°i ph·∫°m.', 
                                        effect: { reputation: -8, grades: -10, familyRel: -10, mental: -10, addiction: -5 },
                                        memory: 'confessed_video_guilt',
                                        consequence: 'S·ª± th√†nh th·∫≠t c√≥ th·ªÉ gi·∫£m nh·∫π h√¨nh ph·∫°t, nh∆∞ng h·∫≠u qu·∫£ v·∫´n r·∫•t nghi√™m tr·ªçng...'
                                    },
                                    { 
                                        text: 'Th·∫ßy ∆°i, em ch·ªâ c√≥ m·∫∑t ·ªü ƒë√≥ th√¥i, em kh√¥ng tham gia g√¨ c·∫£!', 
                                        effect: { reputation: -3, pressure: 5 },
                                        memory: 'denied_participation_video',
                                        consequence: 'N·∫øu video kh√¥ng c√≥ An th√¨ c√≥ th·ªÉ tho√°t ƒë∆∞·ª£c...'
                                    },
                                    { 
                                        text: 'Em kh√¥ng bi·∫øt c√≥ ai quay video. Em ch·ªâ ƒëi d·ª± sinh nh·∫≠t b·∫°n th√¥i ·∫°.', 
                                        effect: { reputation: -5, pressure: 8, mental: -3 },
                                        memory: 'partial_denial_video'
                                    }
                                ]
                            },
                            {
                                speaker: 'Hi·ªáu tr∆∞·ªüng',
                                text: 'Quy·∫øt ƒë·ªãnh cu·ªëi c√πng s·∫Ω ph·ª• thu·ªôc v√†o vi·ªác em c√≥ xu·∫•t hi·ªán trong video hay kh√¥ng.',
                                character: null,
                                dynamic: true
                            },
                            {
                                speaker: 'K·ªÉ chuy·ªán',
                                text: 'Sau cu·ªôc h·ªçp v·ªõi hi·ªáu tr∆∞·ªüng, An b∆∞·ªõc ra h√†nh lang...',
                                character: null,
                                dynamic: true
                            }
                        ]
                    },
                    10: {
                        title: "T√¨nh C·∫£m",
                        background: "bg-school-yard",
                        dialogues: [
                            {
                                speaker: 'K·ªÉ chuy·ªán',
                                text: 'Sau nh·ªØng bi·∫øn c·ªë v·ªõi video, An ƒëang ng·ªìi m·ªôt m√¨nh trong s√¢n tr∆∞·ªùng. Lan t·ª´ t·ª´ b∆∞·ªõc ƒë·∫øn, v·∫ª m·∫∑t c√≥ ch√∫t ng·∫°i ng√πng.',
                                character: null
                            },
                            {
                                speaker: 'Lan',
                                text: 'An... m√¨nh c√≥ th·ªÉ ng·ªìi c·∫°nh b·∫°n kh√¥ng?',
                                character: 'characterLan'
                            },
                            {
                                speaker: 'An',
                                text: 'Dƒ© nhi√™n r·ªìi, Lan. C·∫£m ∆°n b·∫°n v·∫´n mu·ªën n√≥i chuy·ªán v·ªõi m√¨nh sau... nh·ªØng chuy·ªán v·ª´a r·ªìi.',
                                character: 'characterAn'
                            },
                            {
                                speaker: 'Lan',
                                text: 'An... m√¨nh c√≥ ƒëi·ªÅu mu·ªën n√≥i v·ªõi b·∫°n t·ª´ l√¢u r·ªìi.',
                                character: 'characterLan',
                                dynamic: true
                            },
                            {
                                speaker: 'An',
                                text: 'G√¨ v·∫≠y Lan? B·∫°n c√≥ v·∫ª nghi√™m tr·ªçng qu√°.',
                                character: 'characterAn'
                            },
                            {
                                speaker: 'Lan',
                                text: 'M√¨nh... m√¨nh th√≠ch b·∫°n, An. T·ª´ l√¢u r·ªìi.',
                                character: 'characterLan',
                                dynamic: true
                            },
                            {
                                speaker: 'An',
                                text: 'Lan... m√¨nh...',
                                character: 'characterAn',
                                dynamic: true
                            },
                            {
                                speaker: 'Lan',
                                text: 'Nh∆∞ng...',
                                character: 'characterLan',
                                dynamic: true
                            },
                            {
                                speaker: 'An',
                                text: 'Nh∆∞ng g√¨, Lan?',
                                character: 'characterAn',
                                dynamic: true,
                                choices: [
                                    { 
                                        text: 'M√¨nh c≈©ng th√≠ch b·∫°n, Lan. M√¨nh mu·ªën thay ƒë·ªïi v√¨ b·∫°n.', 
                                        effect: { lanRel: 10, mental: 5, addiction: -5, health: 3 },
                                        memory: 'confessed_love_lan',
                                        consequence: 'T√¨nh y√™u c√≥ th·ªÉ l√† ƒë·ªông l·ª±c m·∫°nh m·∫Ω ƒë·ªÉ thay ƒë·ªïi...'
                                    },
                                    { 
                                        text: 'Lan... m√¨nh c·∫ßn th·ªùi gian ƒë·ªÉ suy nghƒ© v·ªÅ t·∫•t c·∫£.', 
                                        effect: { lanRel: -2, mental: -3, pressure: 3 },
                                        memory: 'hesitated_with_lan'
                                    },
                                    { 
                                        text: 'M√¨nh xin l·ªói Lan... m√¨nh kh√¥ng x·ª©ng ƒë√°ng v·ªõi b·∫°n.', 
                                        effect: { lanRel: -5, mental: -8, reputation: -2 },
                                        memory: 'rejected_lan_love',
                                        consequence: 'An c·∫£m th·∫•y m√¨nh kh√¥ng x·ª©ng ƒë√°ng v·ªõi t√¨nh y√™u trong s·∫°ch...'
                                    }
                                ]
                            }
                        ]
                    },
                    8: {
                        title: "Party ƒê√™m",
                        background: "bg-party",
                        dialogues: [
                            {
                                speaker: 'K·ªÉ chuy·ªán',
                                text: 'Cu·ªëi tu·∫ßn, Tu·∫•n m·ªùi An ƒë·∫øn sinh nh·∫≠t c·ªßa Huy - m·ªôt b·∫°n nh√† gi√†u trong tr∆∞·ªùng. CƒÉn bi·ªát th·ª± sang tr·ªçng, √¢m nh·∫°c s√¥i ƒë·ªông, v√† kh√¥ng kh√≠ ti·ªác t√πng...',
                                character: null
                            },
                            {
                                speaker: 'Tu·∫•n',
                                text: 'An! B·∫°n ƒë·∫øn r·ªìi! Ti·ªác n√†y s·∫Ω r·∫•t tuy·ªát ƒë·∫•y. Huy chu·∫©n b·ªã ƒë·∫ßy ƒë·ªß m·ªçi th·ª© ƒë·ªÉ ch√∫ng ta vui ch∆°i.',
                                character: 'characterTuan'
                            },
                            {
                                speaker: 'Huy',
                                text: 'Ch√†o m·ª´ng ƒë·∫øn v·ªõi ti·ªác sinh nh·∫≠t c·ªßa t√¥i! H√¥m nay ch√∫ng ta s·∫Ω qu√™n ƒëi m·ªçi lo l·∫Øng v√† t·∫≠n h∆∞·ªüng cu·ªôc s·ªëng!',
                                character: null
                            },
                            {
                                speaker: 'An',
                                text: 'Wow... ti·ªác n√†y ho√†nh tr√°ng th·∫≠t. Nh∆∞ng c√≥ v·∫ª nh∆∞ c√≥ nhi·ªÅu th·ª© m√¨nh ch∆∞a t·ª´ng th·∫•y...',
                                character: 'characterAn'
                            },
                            {
                                speaker: 'K·ªÉ chuy·ªán',
                                text: 'An nh√¨n quanh v√† th·∫•y tr√™n b√†n c√≥ r∆∞·ª£u, vape c√°c lo·∫°i, v√† c·∫£ thu·ªëc l√° th∆∞·ªùng. M·ªôt s·ªë b·∫°n ƒë√£ b·∫Øt ƒë·∫ßu s·ª≠ d·ª•ng...',
                                character: null
                            },
                            {
                                speaker: 'Tu·∫•n',
                                text: 'N√†y An, b·∫°n th·ª≠ c√°i n√†y ch∆∞a? *ch·ªâ v√†o chai r∆∞·ª£u v√† vape* ƒê√¢y l√† l√∫c ƒë·ªÉ th·ª±c s·ª± th∆∞ gi√£n ƒë·∫•y.',
                                character: 'characterTuan',
                                dynamic: true
                            },
                            {
                                speaker: 'Minh',
                                text: '*ƒë√£ h∆°i say* An! B·∫°n ph·∫£i th·ª≠ ƒë·∫•y! C·∫£m gi√°c tuy·ªát v·ªùi l·∫Øm! *c∆∞·ªùi kh√∫c kh√≠ch*',
                                character: 'characterMinh'
                            },
                            {
                                speaker: 'An',
                                text: 'Minh c√≥ v·∫ª ƒë√£... say r·ªìi. C√≤n m√¨nh th√¨ sao? ƒê√¢y l√† l·ª±a ch·ªçn quan tr·ªçng...',
                                character: 'characterAn',
                                choices: [
                                    { 
                                        text: 'Th√¥i ƒë∆∞·ª£c r·ªìi! H√¥m nay m√¨nh s·∫Ω th·ª≠ h·∫øt! *u·ªëng r∆∞·ª£u v√† h√∫t vape*', 
                                        effect: { tuanRel: 5, addiction: 15, health: -15, mental: -10, reputation: -5 },
                                        memory: 'party_full_participation',
                                        consequence: 'B·∫°n ƒë√£ ƒë·∫Øm ch√¨m trong ti·ªác t√πng... H·∫≠u qu·∫£ s·∫Ω r·∫•t nghi√™m tr·ªçng!'
                                    },
                                    { 
                                        text: 'M√¨nh ch·ªâ th·ª≠ m·ªôt ch√∫t th√¥i... *th·ª≠ 1 h∆°i vape v√† 1 ly r∆∞·ª£u*', 
                                        effect: { tuanRel: 2, addiction: 8, health: -8, mental: -5, pressure: 3 },
                                        memory: 'party_light_participation',
                                        consequence: 'B·∫°n ƒë√£ th·ª≠ m·ªôt ch√∫t... Nh∆∞ng ƒëi·ªÅu n√†y v·∫´n c√≥ th·ªÉ g√¢y h·∫≠u qu·∫£.'
                                    },
                                    { 
                                        text: 'Kh√¥ng, c·∫£m ∆°n. M√¨nh ch·ªâ u·ªëng n∆∞·ªõc ng·ªçt th√¥i.', 
                                        effect: { tuanRel: -3, health: 3, reputation: 2, mental: 2, pressure: 5 },
                                        memory: 'party_refused_all',
                                        consequence: 'B·∫°n ƒë√£ ki√™n ƒë·ªãnh v·ªõi nguy√™n t·∫Øc... Nh∆∞ng Tu·∫•n kh√¥ng h√†i l√≤ng.'
                                    }
                                ]
                            },
                            {
                                speaker: 'K·ªÉ chuy·ªán',
                                text: 'Khi ti·ªác ƒëang di·ªÖn ra s√¥i n·ªïi, An nh·∫≠n ra c√≥ ng∆∞·ªùi ƒëang ch·ª•p ·∫£nh v√† quay video...',
                                character: null,
                                dynamic: true
                            },
                            {
                                speaker: 'B·∫°n A',
                                text: 'N√†y, m·ªçi ng∆∞·ªùi pose ƒëi! M√¨nh s·∫Ω ch·ª•p ·∫£nh k·ª∑ ni·ªám! *gi∆° ƒëi·ªán tho·∫°i l√™n*',
                                character: null
                            },
                            {
                                speaker: 'An',
                                text: '∆†... ch·ª•p ·∫£nh √†? M√¨nh...',
                                character: 'characterAn',
                                dynamic: true
                            }
                        ]
                    },
                    9: {
                        title: "H·∫≠u Qu·∫£ Bu·ªïi Ti·ªác",
                        background: "bg-classroom",
                        dialogues: [
                            {
                                speaker: 'K·ªÉ chuy·ªán',
                                text: 'Th·ª© hai ƒë·∫ßu tu·∫ßn, An ƒë·∫øn tr∆∞·ªùng v·ªõi t√¢m tr·∫°ng lo l·∫Øng. Nh·ªØng g√¨ x·∫£y ra ·ªü ti·ªác sinh nh·∫≠t c√≥ th·ªÉ s·∫Ω ·∫£nh h∆∞·ªüng nh∆∞ th·∫ø n√†o?',
                                character: null
                            },
                            {
                                speaker: 'An',
                                text: 'Hy v·ªçng kh√¥ng c√≥ chuy·ªán g√¨ x·∫£y ra... M√¨nh c√≥ h∆°i h·ªëi h·∫≠n v·ªÅ quy·∫øt ƒë·ªãnh h√¥m ƒë√≥.',
                                character: 'characterAn'
                            },
                            {
                                speaker: 'Tu·∫•n',
                                text: '*ti·∫øn ƒë·∫øn ch·ªó An v·ªõi v·∫ª m·∫∑t kh√°c l·∫°*',
                                character: 'characterTuan',
                                dynamic: true
                            },
                            {
                                speaker: 'K·ªÉ chuy·ªán',
                                text: 'ƒêi·ªán tho·∫°i c·ªßa An rung l√™n. M·ªôt tin nh·∫Øn t·ª´ s·ªë l·∫°...',
                                character: null,
                                dynamic: true
                            },
                            {
                                speaker: 'Tin nh·∫Øn l·∫°',
                                text: '"·∫¢nh v√† video t·ª´ ti·ªác h√¥m tr∆∞·ªõc ƒë√¢y. B·∫°n c√≥ mu·ªën ch√∫ng lan truy·ªÅn kh√¥ng? üòè"',
                                character: null,
                                dynamic: true
                            },
                            {
                                speaker: 'An',
                                text: 'Kh√¥ng... kh√¥ng th·ªÉ n√†o! Ai ƒë√£ ch·ª•p ·∫£nh m√¨nh v·∫≠y?',
                                character: 'characterAn',
                                dynamic: true
                            },
                            {
                                speaker: 'Minh',
                                text: '*ƒë·∫øn g·∫ßn v·ªõi v·∫ª m·∫∑t lo l·∫Øng* An, m√¨nh nghe n√≥i c√≥ ·∫£nh c·ªßa ti·ªác h√¥m tr∆∞·ªõc ƒëang ƒë∆∞·ª£c chia s·∫ª...',
                                character: 'characterMinh'
                            },
                            {
                                speaker: 'Th·∫ßy B√¨nh',
                                text: 'An, em v√†o ph√≤ng gi√°o vi√™n ngay. Th·∫ßy c·∫ßn n√≥i chuy·ªán v·ªõi em v·ªÅ m·ªôt v·∫•n ƒë·ªÅ nghi√™m tr·ªçng.',
                                character: null
                            },
                            {
                                speaker: 'An',
                                text: 'D·∫°... th·∫ßy. *tim ƒë·∫≠p th√¨nh th·ªãch*',
                                character: 'characterAn',
                                choices: [
                                    { 
                                        text: 'Th·∫ßy ∆°i, em xin l·ªói. Em bi·∫øt em ƒë√£ sai v√† s·∫Ω kh√¥ng t√°i ph·∫°m.', 
                                        effect: { reputation: -3, grades: -5, familyRel: -5, mental: -8 },
                                        memory: 'confessed_to_teacher',
                                        consequence: 'S·ª± th√†nh th·∫≠t c√≥ th·ªÉ gi√∫p gi·∫£m nh·∫π h√¨nh ph·∫°t...'
                                    },
                                    { 
                                        text: 'Th·∫ßy n√≥i v·ªÅ chuy·ªán g√¨ ·∫°? Em kh√¥ng hi·ªÉu...', 
                                        effect: { reputation: -5, pressure: 8, mental: -5 },
                                        memory: 'denied_to_teacher',
                                        consequence: 'Vi·ªác ch·ªëi b·ªè c√≥ th·ªÉ khi·∫øn t√¨nh h√¨nh t·ªá h∆°n...'
                                    },
                                    { 
                                        text: 'Em ch·ªâ ƒëi d·ª± sinh nh·∫≠t b·∫°n th√¥i ·∫°. Em kh√¥ng l√†m g√¨ sai.', 
                                        effect: { reputation: -2, pressure: 5 },
                                        memory: 'partial_truth_teacher'
                                    }
                                ]
                            },
                            {
                                speaker: 'Th·∫ßy B√¨nh',
                                text: 'An, th·∫ßy ƒë√£ nh·∫≠n ƒë∆∞·ª£c b√°o c√°o v·ªÅ h√†nh vi c·ªßa em ·ªü b√™n ngo√†i tr∆∞·ªùng. ƒêi·ªÅu n√†y c√≥ th·ªÉ ·∫£nh h∆∞·ªüng ƒë·∫øn vi·ªác h·ªçc v√† t∆∞∆°ng lai c·ªßa em.',
                                character: null,
                                dynamic: true
                            },
                            {
                                speaker: 'K·ªÉ chuy·ªán',
                                text: 'Sau cu·ªôc n√≥i chuy·ªán v·ªõi th·∫ßy B√¨nh, An b∆∞·ªõc ra h√†nh lang v·ªõi t√¢m tr·∫°ng n·∫∑ng n·ªÅ...',
                                character: null
                            },
                            {
                                speaker: 'Lan',
                                text: '*ch·∫°y ƒë·∫øn* An! M√¨nh v·ª´a nghe tin... C√≥ th·∫≠t l√† b·∫°n...?',
                                character: 'characterLan'
                            },
                            {
                                speaker: 'An',
                                text: 'Lan... m√¨nh...',
                                character: 'characterAn',
                                dynamic: true
                            },
                            {
                                speaker: 'Tu·∫•n',
                                text: '*xu·∫•t hi·ªán* N√†y An, ch√∫ng ta c·∫ßn n√≥i chuy·ªán. T√¨nh h√¨nh h∆°i ph·ª©c t·∫°p ƒë·∫•y.',
                                character: 'characterTuan',
                                dynamic: true
                            },
                            {
                                speaker: 'An',
                                text: 'T√¨nh h√¨nh n√†y... m√¨nh ph·∫£i l√†m g√¨ ƒë√¢y?',
                                character: 'characterAn',
                                choices: [
                                    { 
                                        text: 'M√¨nh s·∫Ω ƒë·ªëi m·∫∑t v·ªõi h·∫≠u qu·∫£ v√† c·ªë g·∫Øng s·ª≠a ch·ªØa sai l·∫ßm.', 
                                        effect: { mental: 3, familyRel: 2, lanRel: 3, reputation: 1 },
                                        memory: 'chose_to_face_consequences',
                                        consequence: 'Quy·∫øt ƒë·ªãnh ƒë·ªëi m·∫∑t th·ªÉ hi·ªán s·ª± tr∆∞·ªüng th√†nh...'
                                    },
                                    { 
                                        text: 'M√¨nh c·∫ßn t√¨m c√°ch che gi·∫•u chuy·ªán n√†y...', 
                                        effect: { pressure: 10, mental: -5, tuanRel: 2 },
                                        memory: 'chose_to_hide_truth',
                                        consequence: 'Che gi·∫•u s·ª± th·∫≠t s·∫Ω t·∫°o √°p l·ª±c l·ªõn h∆°n...'
                                    },
                                    { 
                                        text: 'T·∫•t c·∫£ l√† l·ªói c·ªßa Tu·∫•n! B·∫°n ·∫•y ƒë√£ l√¥i k√©o m√¨nh!', 
                                        effect: { tuanRel: -8, minhRel: -3, reputation: -2, pressure: 5 },
                                        memory: 'blamed_tuan',
                                        consequence: 'ƒê·ªï l·ªói cho ng∆∞·ªùi kh√°c s·∫Ω kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c v·∫•n ƒë·ªÅ...'
                                    }
                                ]
                            }
                        ]
                    }
                }
            },
            3: {
                title: "V·ª° L·ªü & ƒê·ªëi ƒê√¢u",
                chapters: {
                    11: {
                        title: "S·ª± C·ªë Trong S·ª± Ki·ªán",
                        background: "bg-school-yard",
                        dialogues: [
                            {
                                speaker: 'K·ªÉ chuy·ªán',
                                text: 'Ng√†y H·ªôi S·ª©c Kh·ªèe t·∫°i tr∆∞·ªùng - m·ªôt s·ª± ki·ªán l·ªõn v·ªõi s·ª± tham gia c·ªßa nhi·ªÅu tr∆∞·ªùng trong khu v·ª±c. An ƒëang tham gia c√°c ho·∫°t ƒë·ªông tuy√™n truy·ªÅn v·ªÅ t√°c h·∫°i c·ªßa thu·ªëc l√° v√† ma t√∫y.',
                                character: null
                            },
                            {
                                speaker: 'Th·∫ßy B√¨nh',
                                text: 'C√°c em h√£y tham gia t√≠ch c·ª±c v√†o c√°c ho·∫°t ƒë·ªông h√¥m nay. ƒê√¢y l√† c∆° h·ªôi ƒë·ªÉ hi·ªÉu r√µ h∆°n v·ªÅ t√°c h·∫°i c·ªßa c√°c ch·∫•t k√≠ch th√≠ch.',
                                character: null
                            },
                            {
                                speaker: 'An',
                                text: 'Ng√†y h·ªôi n√†y th·∫≠t √Ω nghƒ©a. M√¨nh ƒë√£ hi·ªÉu ƒë∆∞·ª£c nhi·ªÅu ƒëi·ªÅu...',
                                character: 'characterAn'
                            },
                            {
                                speaker: 'Tu·∫•n',
                                text: '*ti·∫øn ƒë·∫øn g·∫ßn An* N√†y, m·∫•y b·∫°n m√¨nh ƒë·ªãnh ƒëi "th∆∞ gi√£n" m·ªôt ch√∫t ·ªü khu v∆∞·ªùn sau. B·∫°n c√≥ ƒëi kh√¥ng?',
                                character: 'characterTuan'
                            },
                            {
                                speaker: 'An',
                                text: 'Th∆∞ gi√£n? √ù b·∫°n l√†...?',
                                character: 'characterAn'
                            },
                            {
                                speaker: 'Tu·∫•n',
                                text: 'B·∫°n bi·∫øt ƒë·∫•y... *ch·ªâ v√†o t√∫i* Ch·ªâ m·ªôt ch√∫t th√¥i. Ngay trong khu√¥n vi√™n tr∆∞·ªùng, kh√¥ng ai bi·∫øt ƒë√¢u.',
                                character: 'characterTuan',
                                dynamic: true
                            },
                            {
                                speaker: 'Minh',
                                text: '*xu·∫•t hi·ªán* An! M√¨nh ƒëang t√¨m b·∫°n. Tu·∫•n v·ª´a n√≥i v·ªõi m√¨nh v·ªÅ k·∫ø ho·∫°ch... B·∫°n c√≥ tham gia kh√¥ng?',
                                character: 'characterMinh'
                            },
                            {
                                speaker: 'An',
                                text: 'C√°c b·∫°n ƒë·ªãnh h√∫t vape ngay trong tr∆∞·ªùng, trong ng√†y tuy√™n truy·ªÅn v·ªÅ t√°c h·∫°i c·ªßa n√≥ sao?',
                                character: 'characterAn'
                            },
                            {
                                speaker: 'Tu·∫•n',
                                text: 'ƒê√≥ ch√≠nh l√† ƒëi·ªÅu th√∫ v·ªã! Ai m√† ng·ªù ƒë∆∞·ª£c? H∆°n n·ªØa, sau khi nghe m·∫•y c√°i thuy·∫øt gi·∫£ng nh√†m ch√°n, m√¨nh c·∫ßn th·ª© g√¨ ƒë√≥ ƒë·ªÉ... c√¢n b·∫±ng l·∫°i.',
                                character: 'characterTuan'
                            },
                            {
                                speaker: 'Lan',
                                text: '*ƒëi ngang qua v√† nghe ƒë∆∞·ª£c* An, b·∫°n ƒëang n√≥i chuy·ªán g√¨ v·ªõi h·ªç v·∫≠y?',
                                character: 'characterLan'
                            },
                            {
                                speaker: 'An',
                                text: 'ƒê√¢y l√† l√∫c quy·∫øt ƒë·ªãnh... M√¨nh ph·∫£i l√†m g√¨?',
                                character: 'characterAn',
                                choices: [
                                    { 
                                        text: 'Lan, m√¨nh c·∫ßn b√°o cho th·∫ßy c√¥ bi·∫øt. H·ªç ƒë·ªãnh vi ph·∫°m nghi√™m tr·ªçng.', 
                                        effect: { lanRel: 2, tuanRel: -2, minhRel: -3, reputation: 3, mental: 2 },
                                        memory: 'reported_vaping_plan',
                                        consequence: 'B·∫°n ƒë√£ ch·ªçn l√†m ƒëi·ªÅu ƒë√∫ng... Nh∆∞ng h·∫≠u qu·∫£ v·ªõi b·∫°n b√® s·∫Ω r·∫•t nghi√™m tr·ªçng!'
                                    },
                                    { 
                                        text: 'M√¨nh... m√¨nh kh√¥ng th·ªÉ ngƒÉn c√°c b·∫°n, nh∆∞ng m√¨nh kh√¥ng tham gia.', 
                                        effect: { reputation: -1, pressure: 5, mental: -2 },
                                        memory: 'ignored_vaping_plan',
                                        consequence: 'B·∫°n ƒë√£ ch·ªçn l√†m ng∆°... ƒê√¥i khi im l·∫∑ng c≈©ng l√† m·ªôt l·ª±a ch·ªçn c√≥ h·∫≠u qu·∫£.'
                                    },
                                    { 
                                        text: 'ƒê∆∞·ª£c r·ªìi... m√¨nh s·∫Ω ƒëi c√πng c√°c b·∫°n.', 
                                        effect: { tuanRel: 3, addiction: 10, health: -10, reputation: -5, lanRel: -5 },
                                        memory: 'joined_school_vaping',
                                        consequence: 'NGUY HI·ªÇM! H√∫t vape trong tr∆∞·ªùng trong ng√†y tuy√™n truy·ªÅn... Bad Ending ƒëang ƒë·∫øn g·∫ßn!'
                                    }
                                ]
                            },
                            {
                                speaker: 'K·ªÉ chuy·ªán',
                                text: 'Quy·∫øt ƒë·ªãnh c·ªßa An s·∫Ω ·∫£nh h∆∞·ªüng l·ªõn ƒë·∫øn nh·ªØng g√¨ x·∫£y ra ti·∫øp theo...',
                                character: null,
                                dynamic: true
                            }
                        ]
                    },
                    12: {
                        title: "L·ªùi M·ªùi Nguy Hi·ªÉm",
                        background: "bg-behind-school",
                        dialogues: [
                            {
                                speaker: 'K·ªÉ chuy·ªán',
                                text: 'M·ªôt tu·∫ßn sau party, Tu·∫•n t√¨m ƒë·∫øn An v·ªõi m·ªôt l·ªùi ƒë·ªÅ ngh·ªã b√≠ ·∫©n. H·ªç g·∫∑p nhau ·ªü khu v·ª±c sau tr∆∞·ªùng, n∆°i m·ªçi chuy·ªán b·∫Øt ƒë·∫ßu.',
                                character: null
                            },
                            {
                                speaker: 'Tu·∫•n',
                                text: 'An, m√¨nh c√≥ m·ªôt c∆° h·ªôi ƒë·∫∑c bi·ªát cho b·∫°n. B·∫°n c√≥ mu·ªën tham gia "H·ªôi k√≠n" kh√¥ng?',
                                character: 'characterTuan'
                            },
                            {
                                speaker: 'An',
                                text: 'H·ªôi k√≠n? ƒê√≥ l√† g√¨ v·∫≠y?',
                                character: 'characterAn'
                            },
                            {
                                speaker: 'Tu·∫•n',
                                text: 'ƒê√≥ l√† nh√≥m c·ªßa nh·ªØng ng∆∞·ªùi "hi·ªÉu bi·∫øt". Ch√∫ng m√¨nh th·ª≠ nh·ªØng lo·∫°i vape m·ªõi l·∫°, cao c·∫•p t·ª´ n∆∞·ªõc ngo√†i. Kh√¥ng ph·∫£i ai c≈©ng ƒë∆∞·ª£c m·ªùi ƒë√¢u.',
                                character: 'characterTuan'
                            },
                            {
                                speaker: 'An',
                                text: 'Vape cao c·∫•p? Ch·∫Øc ƒë·∫Øt l·∫Øm nh·ªâ?',
                                character: 'characterAn'
                            },
                            {
                                speaker: 'Tu·∫•n',
                                text: 'M·ªói l·∫ßn ch·ªâ 200k th√¥i. Nh∆∞ng c·∫£m gi√°c... *m·ªâm c∆∞·ªùi b√≠ ·∫©n* ...kh√¥ng th·ªÉ t·∫£ ƒë∆∞·ª£c. B·∫°n s·∫Ω hi·ªÉu t·∫°i sao m√¨nh l·∫°i th√≠ch th√∫ n√†y.',
                                character: 'characterTuan',
                                dynamic: true
                            },
                            {
                                speaker: 'An',
                                text: '200k... ƒë√≥ l√† ti·ªÅn ƒÉn c·ªßa m√¨nh c·∫£ tu·∫ßn...',
                                character: 'characterAn',
                                choices: [
                                    { 
                                        text: 'ƒê∆∞·ª£c r·ªìi, m√¨nh s·∫Ω tham gia. M√¨nh t√≤ m√≤ l·∫Øm.', 
                                        effect: { tuanRel: 5, addiction: 20, health: -20, mental: -15, familyRel: -5, grades: -10 },
                                        memory: 'joined_secret_club',
                                        consequence: 'B·∫°n ƒë√£ b∆∞·ªõc v√†o th·∫ø gi·ªõi nguy hi·ªÉm... S·ª©c kh·ªèe v√† t√†i ch√≠nh s·∫Ω b·ªã ·∫£nh h∆∞·ªüng n·∫∑ng n·ªÅ!'
                                    },
                                    { 
                                        text: 'M√¨nh... m√¨nh c·∫ßn suy nghƒ© th√™m. 200k kh√¥ng ph·∫£i s·ªë ti·ªÅn nh·ªè.', 
                                        effect: { tuanRel: -2, pressure: 5, mental: -3 },
                                        memory: 'hesitated_about_club'
                                    },
                                    { 
                                        text: 'Kh√¥ng, m√¨nh t·ª´ ch·ªëi. M√¨nh kh√¥ng mu·ªën tham gia nh·ªØng th·ª© nh∆∞ v·∫≠y.', 
                                        effect: { tuanRel: -8, health: 5, reputation: 3, mental: 2 },
                                        memory: 'refused_secret_club',
                                        consequence: 'Tu·∫•n r·∫•t t·ª©c gi·∫≠n... ƒêi·ªÅu n√†y c√≥ th·ªÉ d·∫´n ƒë·∫øn h·∫≠u qu·∫£ kh√¥n l∆∞·ªùng.'
                                    }
                                ]
                            },
                            {
                                speaker: 'Tu·∫•n',
                                text: 'Hmm...',
                                character: 'characterTuan',
                                dynamic: true
                            },
                            {
                                speaker: 'K·ªÉ chuy·ªán',
                                text: '√Ånh m·∫Øt c·ªßa Tu·∫•n thay ƒë·ªïi. C√≥ g√¨ ƒë√≥ ƒëang di·ªÖn ra trong ƒë·∫ßu anh ta...',
                                character: null,
                                dynamic: true
                            }
                        ]
                    }
                }
            },
            4: {
                title: "Quy·∫øt ƒê·ªãnh & H·∫≠u Qu·∫£",
                chapters: {
                    12: {
                        title: "M√¢u Thu·∫´n B√πng N·ªï",
                        background: "bg-classroom",
                        dialogues: [
                            {
                                speaker: 'K·ªÉ chuy·ªán',
                                text: 'M·ªôt tu·∫ßn sau Ng√†y H·ªôi S·ª©c Kh·ªèe, tin s·ªëc lan truy·ªÅn kh·∫Øp tr∆∞·ªùng: Minh b·ªã b·∫Øt g·∫∑p h√∫t vape trong nh√† v·ªá sinh v√† b·ªã ƒë√¨nh ch·ªâ h·ªçc 1 tu·∫ßn.',
                                character: null
                            },
                            {
                                speaker: 'B·∫°n l·ªõp A',
                                text: 'B·∫°n nghe tin v·ªÅ Minh ch∆∞a? B·ªã ƒë√¨nh ch·ªâ ƒë·∫•y! Th·∫ßy B√¨nh b·∫Øt g·∫∑p t·∫≠n m·∫Øt.',
                                character: null
                            },
                            {
                                speaker: 'B·∫°n l·ªõp B',
                                text: 'Minh kh√≥c l·∫Øm khi b·ªë m·∫π ƒë·∫øn tr∆∞·ªùng. Gia ƒë√¨nh b·∫°n ·∫•y r·∫•t th·∫•t v·ªçng.',
                                character: null
                            },
                            {
                                speaker: 'An',
                                text: 'Minh... M√¨nh kh√¥ng ng·ªù chuy·ªán l·∫°i ƒë·∫øn n·ªói n√†y...',
                                character: 'characterAn',
                                dynamic: true
                            },
                            {
                                speaker: 'Tu·∫•n',
                                text: '*ti·∫øn ƒë·∫øn v·ªõi v·∫ª m·∫∑t t·ª©c gi·∫≠n* An! T·∫°i sao b·∫°n kh√¥ng c·∫£nh b√°o cho Minh? B·∫°n bi·∫øt m√†!',
                                character: 'characterTuan',
                                dynamic: true
                            },
                            {
                                speaker: 'An',
                                text: 'M√¨nh... m√¨nh ƒë√£ c·ªë g·∫Øng...',
                                character: 'characterAn'
                            },
                            {
                                speaker: 'Minh',
                                text: '*xu·∫•t hi·ªán v·ªõi ƒë√¥i m·∫Øt ƒë·ªè hoe* An... t·∫°i sao b·∫°n kh√¥ng b√™nh m√¨nh? Ch√∫ng ta l√† b·∫°n th√¢n m√†!',
                                character: 'characterMinh'
                            },
                            {
                                speaker: 'An',
                                text: 'Minh... m√¨nh...',
                                character: 'characterAn'
                            },
                            {
                                speaker: 'Minh',
                                text: 'B·∫°n ƒë√£ thay ƒë·ªïi r·ªìi, An. B·∫°n kh√¥ng c√≤n l√† ng∆∞·ªùi b·∫°n m√† m√¨nh bi·∫øt n·ªØa.',
                                character: 'characterMinh',
                                dynamic: true
                            },
                            {
                                speaker: 'Tu·∫•n',
                                text: 'ƒê√∫ng r·ªìi! B·∫°n ch·ªâ bi·∫øt lo cho b·∫£n th√¢n. Khi b·∫°n b√® g·∫∑p kh√≥ khƒÉn th√¨ b·∫°n ·ªü ƒë√¢u?',
                                character: 'characterTuan',
                                dynamic: true
                            },
                            {
                                speaker: 'An',
                                text: 'C√°c b·∫°n kh√¥ng hi·ªÉu... M√¨nh ƒë√£ c·ªë g·∫Øng ngƒÉn c·∫£n...',
                                character: 'characterAn',
                                choices: [
                                    { 
                                        text: 'Minh, m√¨nh s·∫Ω gi√∫p b·∫°n b·ªè th√≥i quen n√†y. Ch√∫ng ta c√πng thay ƒë·ªïi nh√©!', 
                                        effect: { minhRel: 3, mental: 2, health: 2, tuanRel: -3, reputation: 2 },
                                        memory: 'tried_to_help_minh_quit',
                                        consequence: 'B·∫°n ƒë√£ ch·ªçn gi√∫p ƒë·ª° b·∫°n th√¢n... ƒê√¢y c√≥ th·ªÉ l√† c∆° h·ªôi c·ª©u v√£n t√¨nh b·∫°n!'
                                    },
                                    { 
                                        text: 'M√¨nh xin l·ªói... M√¨nh ƒë√£ kh√¥ng b√™nh b·∫°n khi c·∫ßn thi·∫øt.', 
                                        effect: { minhRel: 1, tuanRel: 1, mental: -3, pressure: 5, reputation: -2 },
                                        memory: 'apologized_to_minh',
                                        consequence: 'B·∫°n ƒë√£ xin l·ªói... Nh∆∞ng li·ªáu ƒëi·ªÅu n√†y c√≥ ƒë·ªß ƒë·ªÉ c·ª©u v√£n t√¨nh b·∫°n?'
                                    },
                                    { 
                                        text: 'M√¨nh kh√¥ng th·ªÉ b√™nh cho h√†nh vi sai tr√°i. T√¨nh b·∫°n kh√¥ng c√≥ nghƒ©a l√† ph·∫£i che gi·∫•u sai l·∫ßm.', 
                                        effect: { minhRel: -8, tuanRel: -5, mental: -5, reputation: 3, lanRel: 3 },
                                        memory: 'cut_ties_with_minh',
                                        consequence: 'B·∫°n ƒë√£ c·∫Øt ƒë·ª©t t√¨nh b·∫°n... ƒê√¢y l√† quy·∫øt ƒë·ªãnh ƒëau l√≤ng nh∆∞ng c√≥ th·ªÉ ƒë√∫ng ƒë·∫Øn.'
                                    }
                                ]
                            },
                            {
                                speaker: 'Minh',
                                text: 'An...',
                                character: 'characterMinh',
                                dynamic: true
                            },
                            {
                                speaker: 'Tu·∫•n',
                                text: 'Hmm...',
                                character: 'characterTuan',
                                dynamic: true
                            },
                            {
                                speaker: 'Lan',
                                text: '*ƒëi ƒë·∫øn* An, m√¨nh nghe ƒë∆∞·ª£c cu·ªôc n√≥i chuy·ªán. B·∫°n ·ªïn ch·ª©?',
                                character: 'characterLan',
                                dynamic: true
                            },
                            {
                                speaker: 'An',
                                text: 'Lan... m√¨nh kh√¥ng bi·∫øt m√¨nh ƒë√£ l√†m ƒë√∫ng hay sai...',
                                character: 'characterAn',
                                dynamic: true
                            },
                            {
                                speaker: 'K·ªÉ chuy·ªán',
                                text: 'Cu·ªôc ƒë·ªëi ƒë·∫ßu n√†y s·∫Ω ƒë·ªãnh h√¨nh m·ªëi quan h·ªá c·ªßa An v·ªõi t·∫•t c·∫£ m·ªçi ng∆∞·ªùi...',
                                character: null
                            }
                        ]
                    },
                    13: {
                        title: "√Åp L·ª±c Gia ƒê√¨nh",
                        background: "bg-home",
                        dialogues: [
                            {
                                speaker: 'K·ªÉ chuy·ªán',
                                text: 'M·ªôt th√°ng sau nh·ªØng bi·∫øn c·ªë ·ªü tr∆∞·ªùng, gia ƒë√¨nh An t·ªï ch·ª©c m·ªôt cu·ªôc h·ªçp gia ƒë√¨nh. √îng b√†, c√¥ ch√∫, v√† c·∫£ em h·ªç ƒë·ªÅu c√≥ m·∫∑t...',
                                character: null
                            },
                            {
                                speaker: 'B·ªë An',
                                text: 'H√¥m nay b·ªë m·∫π m·ªùi m·ªçi ng∆∞·ªùi ƒë·∫øn ƒë·ªÉ b√†n v·ªÅ t∆∞∆°ng lai c·ªßa An.',
                                character: null,
                                dynamic: true
                            },
                            {
                                speaker: '√îng n·ªôi',
                                text: 'An, √¥ng nghe n√≥i ch√°u c√≥ v·∫•n ƒë·ªÅ ·ªü tr∆∞·ªùng. √îng mu·ªën hi·ªÉu r√µ chuy·ªán g√¨ ƒëang x·∫£y ra.',
                                character: null,
                                dynamic: true
                            },
                            {
                                speaker: 'An',
                                text: 'D·∫° √¥ng... ch√°u...',
                                character: 'characterAn',
                                dynamic: true
                            },
                            {
                                speaker: 'M·∫π An',
                                text: 'Con h√£y th√†nh th·∫≠t v·ªõi gia ƒë√¨nh. Ch√∫ng ta ƒë·ªÅu y√™u th∆∞∆°ng con.',
                                character: null,
                                dynamic: true
                            },
                            {
                                speaker: 'C√¥ An',
                                text: 'An, c√¥ t·ª´ng tr·∫£i qua tu·ªïi 17 nh∆∞ con. C√¥ hi·ªÉu √°p l·ª±c c·ªßa con.',
                                character: null,
                                dynamic: true
                            },
                            {
                                speaker: 'Em h·ªç',
                                text: 'Anh An, em ng∆∞·ª°ng m·ªô anh l·∫Øm. Anh c√≥ th·ªÉ k·ªÉ cho em nghe kh√¥ng?',
                                character: null,
                                dynamic: true
                            },
                            {
                                speaker: 'An',
                                text: 'Gia ƒë√¨nh m√¨nh... m√¨nh ph·∫£i n√≥i g√¨ ƒë√¢y?',
                                character: 'characterAn',
                                dynamic: true,
                                choices: [
                                    { 
                                        text: 'Ch√°u xin l·ªói c·∫£ nh√†. Ch√°u ƒë√£ m·∫Øc sai l·∫ßm v√† mu·ªën thay ƒë·ªïi.', 
                                        effect: { familyRel: 5, mental: 3, addiction: -5, pressure: -3 },
                                        memory: 'confessed_to_family',
                                        consequence: 'Gia ƒë√¨nh c·∫£m ƒë·ªông tr∆∞·ªõc s·ª± th√†nh th·∫≠t c·ªßa b·∫°n...'
                                    },
                                    { 
                                        text: 'Ch√°u kh√¥ng c√≥ v·∫•n ƒë·ªÅ g√¨. Ch·ªâ l√† tin ƒë·ªìn th√¥i ·∫°.', 
                                        effect: { familyRel: -3, pressure: 8, mental: -5 },
                                        memory: 'lied_to_family',
                                        consequence: 'Vi·ªác che gi·∫•u s·ª± th·∫≠t khi·∫øn √°p l·ª±c tƒÉng l√™n...'
                                    },
                                    { 
                                        text: 'Ch√°u... ch√°u c·∫ßn th·ªùi gian ƒë·ªÉ suy nghƒ©.', 
                                        effect: { pressure: 5, mental: -2 },
                                        memory: 'avoided_family_talk'
                                    }
                                ]
                            },
                            {
                                speaker: 'B·ªë An',
                                text: 'Con...',
                                character: null,
                                dynamic: true
                            },
                            {
                                speaker: '√îng n·ªôi',
                                text: 'An...',
                                character: null,
                                dynamic: true
                            },
                            {
                                speaker: 'K·ªÉ chuy·ªán',
                                text: 'Cu·ªôc h·ªçp gia ƒë√¨nh k·∫øt th√∫c v·ªõi nh·ªØng quy·∫øt ƒë·ªãnh quan tr·ªçng...',
                                character: null,
                                dynamic: true
                            }
                        ]
                    },
                    14: {
                        title: "C∆° H·ªôi Cu·ªëi",
                        background: "bg-school-yard",
                        dialogues: [
                            {
                                speaker: 'K·ªÉ chuy·ªán',
                                text: 'M·ªôt tu·∫ßn sau cu·ªôc h·ªçp gia ƒë√¨nh, th·∫ßy B√¨nh t√¨m ƒë·∫øn An v·ªõi m·ªôt ƒë·ªÅ ngh·ªã b·∫•t ng·ªù.',
                                character: null
                            },
                            {
                                speaker: 'Th·∫ßy B√¨nh',
                                text: 'An, th·∫ßy c√≥ m·ªôt ƒë·ªÅ ngh·ªã ƒë·∫∑c bi·ªát cho em.',
                                character: null
                            },
                            {
                                speaker: 'An',
                                text: 'D·∫° th·∫ßy? ƒê·ªÅ ngh·ªã g√¨ ·∫°?',
                                character: 'characterAn'
                            },
                            {
                                speaker: 'Th·∫ßy B√¨nh',
                                text: 'CLB S·ª©c Kh·ªèe H·ªçc Sinh c·ªßa th√†nh ph·ªë mu·ªën m·ªùi em l√†m di·ªÖn gi·∫£ trong ch∆∞∆°ng tr√¨nh "Tu·ªïi Tr·∫ª N√≥i Kh√¥ng V·ªõi T·ªá N·∫°n".',
                                character: null
                            },
                            {
                                speaker: 'An',
                                text: 'Di·ªÖn gi·∫£ ·∫°? Nh∆∞ng m√†... t·∫°i sao l·∫°i ch·ªçn em?',
                                character: 'characterAn'
                            },
                            {
                                speaker: 'Th·∫ßy B√¨nh',
                                text: 'V√¨ em ƒë√£ tr·∫£i qua nh·ªØng th·ª≠ th√°ch. C√¢u chuy·ªán c·ªßa em c√≥ th·ªÉ gi√∫p nhi·ªÅu b·∫°n tr·∫ª kh√°c.',
                                character: null,
                                dynamic: true
                            },
                            {
                                speaker: 'Lan',
                                text: '*xu·∫•t hi·ªán* An! M√¨nh v·ª´a nghe th·∫ßy B√¨nh n√≥i. ƒê√¢y l√† c∆° h·ªôi tuy·ªát v·ªùi!',
                                character: 'characterLan',
                                dynamic: true
                            },
                            {
                                speaker: 'An',
                                text: 'Nh∆∞ng m√¨nh... m√¨nh c√≥ ƒë·ªß t·ª± tin ƒë·ªÉ ƒë·ª©ng tr∆∞·ªõc h√†ng trƒÉm ng∆∞·ªùi kh√¥ng?',
                                character: 'characterAn'
                            },
                            {
                                speaker: 'Th·∫ßy B√¨nh',
                                text: 'Th·∫ßy tin em c√≥ th·ªÉ l√†m ƒë∆∞·ª£c. ƒê√¢y c≈©ng l√† c√°ch ƒë·ªÉ em chu·ªôc l·ªói v√† gi√∫p ƒë·ª° c·ªông ƒë·ªìng.',
                                character: null,
                                dynamic: true
                            },
                            {
                                speaker: 'K·ªÉ chuy·ªán',
                                text: 'ƒê√¢y c√≥ th·ªÉ l√† c∆° h·ªôi cu·ªëi c√πng ƒë·ªÉ An thay ƒë·ªïi ho√†n to√†n cu·ªôc ƒë·ªùi m√¨nh...',
                                character: null
                            },
                            {
                                speaker: 'An',
                                text: 'ƒê√¢y l√† quy·∫øt ƒë·ªãnh quan tr·ªçng nh·∫•t...',
                                character: 'characterAn',
                                choices: [
                                    { 
                                        text: 'Em nh·∫≠n l·ªùi! Em s·∫Ω chu·∫©n b·ªã k·ªπ l∆∞·ª°ng v√† chia s·∫ª c√¢u chuy·ªán th·∫≠t c·ªßa m√¨nh.', 
                                        effect: { reputation: 10, mental: 8, familyRel: 5, lanRel: 5, grades: 5 },
                                        memory: 'accepted_speaker_role_prepared',
                                        consequence: 'ƒê√¢y l√† b∆∞·ªõc ngo·∫∑t t√≠ch c·ª±c! B·∫°n ƒë√£ ch·ªçn con ƒë∆∞·ªùng chu·ªôc l·ªói v√† gi√∫p ƒë·ª° ng∆∞·ªùi kh√°c.'
                                    },
                                    { 
                                        text: 'Em xin l·ªói th·∫ßy. Em ch∆∞a s·∫µn s√†ng ƒë·ªëi m·∫∑t v·ªõi ƒë√°m ƒë√¥ng.', 
                                        effect: { mental: -3, pressure: 3, reputation: -2 },
                                        memory: 'refused_speaker_role',
                                        consequence: 'B·∫°n ƒë√£ b·ªè l·ª° c∆° h·ªôi quan tr·ªçng... Li·ªáu c√≤n c∆° h·ªôi n√†o kh√°c?'
                                    },
                                    { 
                                        text: 'Em nh·∫≠n l·ªùi... nh∆∞ng em s·∫Ω n√≥i theo c√°ch c·ªßa em th√¥i.', 
                                        effect: { reputation: 3, mental: 2, pressure: 5 },
                                        memory: 'accepted_speaker_role_unprepared',
                                        consequence: 'B·∫°n ƒë√£ nh·∫≠n l·ªùi nh∆∞ng kh√¥ng cam k·∫øt chu·∫©n b·ªã k·ªπ... ƒêi·ªÅu n√†y c√≥ th·ªÉ r·ªßi ro.'
                                    }
                                ]
                            },
                            {
                                speaker: 'Th·∫ßy B√¨nh',
                                text: 'Quy·∫øt ƒë·ªãnh c·ªßa em...',
                                character: null,
                                dynamic: true
                            },
                            {
                                speaker: 'Lan',
                                text: 'An...',
                                character: 'characterLan',
                                dynamic: true
                            },
                            {
                                speaker: 'K·ªÉ chuy·ªán',
                                text: 'Quy·∫øt ƒë·ªãnh n√†y s·∫Ω ƒë·ªãnh h√¨nh ho√†n to√†n t∆∞∆°ng lai c·ªßa An...',
                                character: null
                            }
                        ]
                    }
                }
            }
        };
        
        function startGame() {
            document.getElementById('titleScreen').classList.add('hidden');
            document.getElementById('dialogueBox').classList.remove('hidden');
            document.getElementById('statsPanel').classList.remove('hidden');
            document.getElementById('chapterInfo').classList.remove('hidden');
            updateChapterInfo();
            showDialogue();
        }
        
        function updateChapterInfo() {
            const act = acts[currentAct];
            const chapter = act.chapters[currentChapter];
            document.getElementById('chapterTitle').textContent = `H·ªìi ${currentAct} - Ch∆∞∆°ng ${currentChapter}`;
            document.getElementById('actInfo').textContent = `${act.title}: ${chapter.title}`;
        }
        
        function showDialogue() {
            const act = acts[currentAct];
            const chapter = act.chapters[currentChapter];
            const dialogue = chapter.dialogues[currentDialogue];
            
            // Change background
            const bg = document.getElementById('background');
            bg.className = `background ${chapter.background}`;
            
            // Show/hide characters
            hideAllCharacters();
            
            if (dialogue.character) {
                document.getElementById(dialogue.character).classList.add('active');
            }
            
            // Handle dynamic dialogue based on memory
            let dialogueText = dialogue.text;
            if (dialogue.dynamic) {
                dialogueText = getDynamicDialogue(dialogue);
            }
            
            // Show dialogue
            document.getElementById('speakerName').textContent = dialogue.speaker;
            document.getElementById('dialogueText').textContent = dialogueText;
            
            // Handle choices or continue button
            const choicesDiv = document.getElementById('choices');
            const continueBtn = document.getElementById('continueBtn');
            const memoryIndicator = document.getElementById('memoryIndicator');
            
            choicesDiv.innerHTML = '';
            memoryIndicator.classList.add('hidden');
            
            if (dialogue.choices) {
                continueBtn.classList.add('hidden');
                
                // Check if any choice has memory flag
                const hasMemoryChoice = dialogue.choices.some(choice => choice.memory);
                if (hasMemoryChoice) {
                    memoryIndicator.classList.remove('hidden');
                }
                
                dialogue.choices.forEach((choice, index) => {
                    const btn = document.createElement('button');
                    btn.className = 'choice-btn';
                    btn.textContent = choice.text;
                    btn.onclick = () => makeChoice(choice);
                    choicesDiv.appendChild(btn);
                });
            } else {
                continueBtn.classList.remove('hidden');
            }
        }
        
        function getDynamicDialogue(dialogue) {
            const speaker = dialogue.speaker;
            
            // Chapter 6 - Chuy·ªán Gia ƒê√¨nh
            if (speaker === 'An' && dialogue.text.includes('con hi·ªÉu r·ªìi ·∫°')) {
                if (gameMemory.first_vape_yes || gameMemory.party_full_participation) {
                    return 'Con... con ƒë√£ l√†m ƒëi·ªÅu sai tr√°i r·ªìi. *kh√¥ng d√°m nh√¨n b·ªë*';
                } else if (gameMemory.promised_lan_avoid) {
                    return 'Con hi·ªÉu t·∫°i sao b·ªë l·∫°i k·ªÉ chuy·ªán n√†y. Con s·∫Ω c·∫©n th·∫≠n h∆°n.';
                } else {
                    return 'Con hi·ªÉu r·ªìi ·∫°. Con s·∫Ω kh√¥ng bao gi·ªù l√†m nh·ªØng ƒëi·ªÅu nh∆∞ v·∫≠y.';
                }
            }
            
            if (speaker === 'B·ªë An' && dialogue.text.includes('tin con l√† ƒë·ª©a tr·∫ª th√¥ng minh')) {
                if (gameMemory.confessed_vaping_to_parents) {
                    return 'Con ƒë√£ th√†nh th·∫≠t v·ªõi b·ªë m·∫π, ƒëi·ªÅu ƒë√≥ r·∫•t t·ªët. Gi·ªù ch√∫ng ta s·∫Ω c√πng nhau gi√∫p con b·ªè nh·ªØng th√≥i quen x·∫•u.';
                } else if (gameMemory.lied_to_parents_about_vaping) {
                    return 'B·ªë tin con. Nh∆∞ng n·∫øu c√≥ chuy·ªán g√¨, ƒë·ª´ng gi·∫•u b·ªë m·∫π nh√©.';
                } else if (gameMemory.honest_about_avoiding_bad_friends) {
                    return 'Con r·∫•t kh√¥n ngoan khi tr√°nh xa nh·ªØng ·∫£nh h∆∞·ªüng x·∫•u. B·ªë m·∫π t·ª± h√†o v·ªÅ con.';
                } else {
                    return dialogue.text;
                }
            }
            
            if (speaker === 'M·∫π An' && dialogue.text.includes('ch√∫ √Ω h∆°n ƒë·∫øn con')) {
                if (gameMemory.confessed_vaping_to_parents) {
                    return 'T·ª´ gi·ªù m·∫π s·∫Ω ki·ªÉm tra ph√≤ng con th∆∞·ªùng xuy√™n h∆°n. Con ƒë·ª´ng gi·∫•u g√¨ m·∫π n·ªØa nh√©.';
                } else if (gameMemory.lied_to_parents_about_vaping && (gameMemory.first_vape_yes || gameMemory.party_light_participation)) {
                    return 'M·∫π c·∫£m th·∫•y con c√≥ g√¨ ƒë√≥ thay ƒë·ªïi. M·∫π s·∫Ω ƒë·ªÉ √Ω h∆°n.';
                } else if (gameMemory.honest_about_avoiding_bad_friends) {
                    return 'M·∫π tin t∆∞·ªüng con. T·ª´ gi·ªù con c√≥ th·ªÉ c√≥ th√™m tr√°ch nhi·ªám ·ªü nh√†.';
                } else {
                    return dialogue.text;
                }
            }
            
            // Chapter 7 - Minh Thay ƒê·ªïi
            if (speaker === 'Minh' && dialogue.text.includes('kh√¥ng mu·ªën thay ƒë·ªïi')) {
                if (gameMemory.first_vape_yes || gameMemory.party_full_participation) {
                    return 'B·∫°n ƒë√£ th·ª≠ r·ªìi m√†, sao gi·ªù l·∫°i ng·∫°i ng√πng th·∫ø n√†y?';
                } else if (gameMemory.first_vape_no || gameMemory.party_refused_all) {
                    return 'B·∫°n lu√¥n t·ª´ ch·ªëi m·ªçi th·ª©. C√≥ ph·∫£i b·∫°n s·ª£ th·ª≠ nh·ªØng ƒëi·ªÅu m·ªõi kh√¥ng?';
                } else if (gameMemory.promised_lan_avoid) {
                    return 'B·∫°n b·ªã Lan ·∫£nh h∆∞·ªüng qu√° nhi·ªÅu r·ªìi. Cu·ªôc s·ªëng kh√¥ng ch·ªâ c√≥ h·ªçc h√†nh ƒë√¢u.';
                } else {
                    return dialogue.text;
                }
            }
            
            if (speaker === 'Tu·∫•n' && dialogue.text.includes('t√≠nh c√°ch c·ªßa b·∫°n')) {
                if (gameMemory.first_vape_no && gameMemory.party_refused_all) {
                    return 'Minh n√≥i b·∫°n r·∫•t kh√≥ h√≤a nh·∫≠p. B·∫°n t·ª´ ch·ªëi m·ªçi th·ª© m√¨nh m·ªùi.';
                } else if (gameMemory.gave_in_to_minh_pressure) {
                    return 'Nh∆∞ng gi·ªù b·∫°n ƒë√£ thay ƒë·ªïi r·ªìi ƒë√∫ng kh√¥ng? Minh n√≥i b·∫°n ƒë√£ b·∫Øt ƒë·∫ßu hi·ªÉu.';
                } else {
                    return 'C√≥ v·∫ª nh∆∞ b·∫°n h∆°i... kh√≥ h√≤a nh·∫≠p.';
                }
            }
            
            if (speaker === 'Minh' && dialogue.text.includes('kh√¥ng ch·ªâ c√≥ h·ªçc h√†nh')) {
                if (gameMemory.party_full_participation) {
                    return 'B·∫°n ƒë√£ bi·∫øt c·∫£m gi√°c r·ªìi ƒë√∫ng kh√¥ng? C√≤n nhi·ªÅu th·ª© th√∫ v·ªã h∆°n n·ªØa ƒë·∫•y!';
                } else if (gameMemory.tried_to_save_friendship_minh) {
                    return 'T√¨nh b·∫°n th√¨ quan tr·ªçng, nh∆∞ng b·∫°n c≈©ng ph·∫£i m·ªü l√≤ng v·ªõi nh·ªØng ƒëi·ªÅu m·ªõi.';
                } else {
                    return 'C√≥ nh·ªØng tr·∫£i nghi·ªám m√† b·∫°n ƒëang b·ªè l·ª°.';
                }
            }
            
            if (speaker === 'Tu·∫•n' && dialogue.text.includes('ho·∫°t ƒë·ªông th√∫ v·ªã')) {
                if (gameMemory.party_full_participation) {
                    return 'L·∫ßn t·ªõi s·∫Ω c√≥ nh·ªØng th·ª© m·∫°nh h∆°n ƒë·∫•y. B·∫°n ƒë√£ s·∫µn s√†ng ch∆∞a?';
                } else if (gameMemory.party_light_participation) {
                    return 'L·∫ßn tr∆∞·ªõc b·∫°n ch·ªâ th·ª≠ m·ªôt ch√∫t. L·∫ßn n√†y h√£y th·ª≠ h·∫øt m√¨nh ƒëi!';
                } else if (gameMemory.party_refused_all) {
                    return 'L·∫ßn tr∆∞·ªõc b·∫°n kh√¥ng tham gia g√¨. Nh∆∞ng l·∫ßn n√†y s·∫Ω kh√°c ƒë·∫•y.';
                } else {
                    return dialogue.text;
                }
            }
            
            if (speaker === 'An' && dialogue.text.includes('T√¨nh b·∫°n 10 nƒÉm')) {
                if (gameMemory.tried_to_save_friendship_minh) {
                    return 'M√¨nh ƒë√£ c·ªë g·∫Øng c·ª©u v√£n t√¨nh b·∫°n... nh∆∞ng c√≥ v·∫ª nh∆∞ ƒë√£ mu·ªôn r·ªìi.';
                } else if (gameMemory.gave_in_to_minh_pressure) {
                    return 'M√¨nh ƒë√£ thay ƒë·ªïi theo Minh... nh∆∞ng c√≥ ƒë√∫ng kh√¥ng nh·ªâ?';
                } else {
                    return 'T√¨nh b·∫°n 10 nƒÉm... c√≥ d·ªÖ d√†ng thay ƒë·ªïi th·∫ø kh√¥ng?';
                }
            }
            
            // Chapter 8 - L√†n S√≥ng Tin ƒê·ªìn
            if (speaker === 'An' && dialogue.text.includes('tin ƒë·ªìn')) {
                if (gameMemory.first_vape_yes) {
                    return 'Ch·∫Øc l√† do h√¥m qua m√¨nh ƒë√£ th·ª≠ vape v·ªõi Tu·∫•n... Tin ƒë·ªìn lan nhanh th·∫≠t.';
                } else if (gameMemory.first_vape_no) {
                    return 'M√¨nh ƒë√£ t·ª´ ch·ªëi th·ª≠ vape m√† sao v·∫´n c√≥ tin ƒë·ªìn? C√≥ l·∫Ω ch·ªâ v√¨ ƒëi v·ªõi Tu·∫•n th√¥i.';
                } else {
                    return 'Ch·ªâ v√¨ ƒëi ch∆°i v·ªõi Tu·∫•n th√¥i m√† ƒë√£ c√≥ tin ƒë·ªìn r·ªìi sao?';
                }
            }
            
            // Chapter 9 - Party ƒê√™m
            if (speaker === 'Tu·∫•n' && dialogue.text.includes('th·ª±c s·ª± th∆∞ gi√£n')) {
                if (gameMemory.first_vape_yes) {
                    return 'An, b·∫°n ƒë√£ bi·∫øt c·∫£m gi√°c r·ªìi ƒë√∫ng kh√¥ng? H√¥m nay c√≥ th√™m r∆∞·ª£u n·ªØa ƒë·∫•y!';
                } else if (gameMemory.first_vape_no) {
                    return 'An, l·∫ßn tr∆∞·ªõc b·∫°n t·ª´ ch·ªëi, nh∆∞ng h√¥m nay l√† sinh nh·∫≠t Huy. B·∫°n kh√¥ng th·ªÉ t·ª´ ch·ªëi m√£i ƒë∆∞·ª£c!';
                } else if (gameMemory.promised_lan_avoid) {
                    return 'An, m√¨nh bi·∫øt b·∫°n ƒë√£ h·ª©a v·ªõi Lan, nh∆∞ng... ch·ªâ m·ªôt l·∫ßn th√¥i m√†!';
                } else {
                    return dialogue.text;
                }
            }
            
            // Chapter 11 - S·ª± C·ªë Trong S·ª± Ki·ªán
            if (speaker === 'Tu·∫•n' && dialogue.text.includes('Ch·ªâ m·ªôt ch√∫t th√¥i')) {
                if (gameMemory.party_full_participation) {
                    return 'B·∫°n ƒë√£ bi·∫øt c·∫£m gi√°c r·ªìi. L·∫ßn n√†y trong tr∆∞·ªùng s·∫Ω th√∫ v·ªã h∆°n ƒë·∫•y!';
                } else if (gameMemory.party_refused_all) {
                    return 'L·∫ßn tr∆∞·ªõc b·∫°n t·ª´ ch·ªëi party. Nh∆∞ng l·∫ßn n√†y kh√°c, ngay trong tr∆∞·ªùng ƒë·∫•y!';
                } else if (gameMemory.promised_lan_avoid) {
                    return 'M√¨nh bi·∫øt b·∫°n ƒë√£ h·ª©a v·ªõi Lan, nh∆∞ng ch·ªâ m·ªôt l·∫ßn th√¥i m√†!';
                } else {
                    return dialogue.text;
                }
            }
            
            if (speaker === 'K·ªÉ chuy·ªán' && dialogue.text.includes('Quy·∫øt ƒë·ªãnh c·ªßa An s·∫Ω ·∫£nh h∆∞·ªüng')) {
                if (gameMemory.reported_vaping_plan) {
                    return 'An ƒë√£ quy·∫øt ƒë·ªãnh b√°o cho th·∫ßy c√¥. Tu·∫•n v√† Minh b·ªã b·∫Øt g·∫∑p ngay khi chu·∫©n b·ªã h√∫t vape...';
                } else if (gameMemory.ignored_vaping_plan) {
                    return 'An ƒë√£ ch·ªçn l√†m ng∆°. Nh√≥m c·ªßa Tu·∫•n ti·∫øp t·ª•c k·∫ø ho·∫°ch, v√† h·∫≠u qu·∫£ s·∫Ω ƒë·∫øn...';
                } else if (gameMemory.joined_school_vaping) {
                    return 'An ƒë√£ tham gia c√πng nh√≥m. H·ªç b·ªã b·∫Øt g·∫∑p ngay t·∫°i ch·ªó b·ªüi th·∫ßy hi·ªáu tr∆∞·ªüng...';
                } else {
                    return dialogue.text;
                }
            }
            
            // Chapter 12 - M√¢u Thu·∫´n B√πng N·ªï
            if (speaker === 'An' && dialogue.text.includes('kh√¥ng ng·ªù chuy·ªán l·∫°i ƒë·∫øn n·ªói n√†y')) {
                if (gameMemory.reported_vaping_plan) {
                    return 'M√¨nh ƒë√£ c·ªë g·∫Øng ngƒÉn c·∫£n... M√¨nh ƒë√£ b√°o cho th·∫ßy c√¥ r·ªìi m√†...';
                } else if (gameMemory.ignored_vaping_plan) {
                    return 'M√¨nh ƒë√£ bi·∫øt tr∆∞·ªõc nh∆∞ng kh√¥ng ngƒÉn ƒë∆∞·ª£c... Gi·ªù Minh ph·∫£i ch·ªãu h·∫≠u qu·∫£...';
                } else if (gameMemory.joined_school_vaping) {
                    return 'M√¨nh c≈©ng b·ªã b·∫Øt g·∫∑p c√πng Minh... May m·∫Øn l√† m√¨nh ch·ªâ b·ªã c·∫£nh c√°o...';
                } else {
                    return dialogue.text;
                }
            }
            
            // Chapter 13 - √Åp L·ª±c Gia ƒê√¨nh
            if (speaker === 'B·ªë An' && dialogue.text.includes('b√†n v·ªÅ t∆∞∆°ng lai c·ªßa An')) {
                if (gameStats.addiction >= 15) {
                    return 'H√¥m nay b·ªë m·∫π m·ªùi m·ªçi ng∆∞·ªùi ƒë·∫øn ƒë·ªÉ b√†n v·ªÅ vi·ªác gi√∫p An cai nghi·ªán v√† t√¨m l·∫°i con ƒë∆∞·ªùng ƒë√∫ng ƒë·∫Øn.';
                } else if (gameStats.reputation >= 70 && gameStats.addiction <= 5) {
                    return 'H√¥m nay b·ªë m·∫π m·ªùi m·ªçi ng∆∞·ªùi ƒë·∫øn ƒë·ªÉ ch√∫c m·ª´ng An ƒë√£ v∆∞·ª£t qua th·ª≠ th√°ch v√† l√†m g∆∞∆°ng cho em nh·ªè.';
                } else {
                    return 'H√¥m nay b·ªë m·∫π m·ªùi m·ªçi ng∆∞·ªùi ƒë·∫øn ƒë·ªÉ b√†n v·ªÅ t∆∞∆°ng lai c·ªßa An.';
                }
            }
            
            if (speaker === '√îng n·ªôi' && dialogue.text.includes('c√≥ v·∫•n ƒë·ªÅ ·ªü tr∆∞·ªùng')) {
                if (gameStats.addiction >= 15) {
                    return 'An, √¥ng nghe n√≥i ch√°u c√≥ v·∫•n ƒë·ªÅ nghi√™m tr·ªçng v·ªõi ch·∫•t k√≠ch th√≠ch. √îng r·∫•t lo l·∫Øng.';
                } else if (gameStats.reputation >= 70) {
                    return 'An, √¥ng nghe n√≥i ch√°u ƒë√£ l√†m nh·ªØng ƒëi·ªÅu t·ªët ·ªü tr∆∞·ªùng. √îng r·∫•t t·ª± h√†o.';
                } else {
                    return 'An, √¥ng nghe n√≥i ch√°u c√≥ v·∫•n ƒë·ªÅ ·ªü tr∆∞·ªùng. √îng mu·ªën hi·ªÉu r√µ chuy·ªán g√¨ ƒëang x·∫£y ra.';
                }
            }
            
            if (speaker === 'An' && dialogue.text.includes('D·∫° √¥ng... ch√°u...')) {
                if (gameStats.addiction >= 15) {
                    return 'D·∫° √¥ng... ch√°u bi·∫øt ch√°u ƒë√£ l√†m gia ƒë√¨nh th·∫•t v·ªçng... *c√∫i ƒë·∫ßu*';
                } else if (gameStats.reputation >= 70) {
                    return 'D·∫° √¥ng, ch√°u ƒë√£ c·ªë g·∫Øng l√†m ƒëi·ªÅu ƒë√∫ng ƒë·∫Øn ·∫°.';
                } else {
                    return 'D·∫° √¥ng... ch√°u...';
                }
            }
            
            if (speaker === 'M·∫π An' && dialogue.text.includes('th√†nh th·∫≠t v·ªõi gia ƒë√¨nh')) {
                if (gameMemory.confessed_to_parents) {
                    return 'Con ƒë√£ t·ª´ng th√†nh th·∫≠t v·ªõi b·ªë m·∫π r·ªìi. Gi·ªù h√£y n√≥i v·ªõi c·∫£ gia ƒë√¨nh.';
                } else if (gameMemory.lied_to_parents) {
                    return 'Con h√£y th√†nh th·∫≠t l·∫ßn n√†y. M·∫π bi·∫øt con ƒë√£ gi·∫•u ƒëi·ªÅu g√¨ ƒë√≥.';
                } else {
                    return 'Con h√£y th√†nh th·∫≠t v·ªõi gia ƒë√¨nh. Ch√∫ng ta ƒë·ªÅu y√™u th∆∞∆°ng con.';
                }
            }
            
            if (speaker === 'C√¥ An' && dialogue.text.includes('tr·∫£i qua tu·ªïi 17')) {
                if (gameStats.addiction >= 15) {
                    return 'An, c√¥ c≈©ng t·ª´ng m·∫Øc sai l·∫ßm ·ªü tu·ªïi 17. Nh∆∞ng quan tr·ªçng l√† bi·∫øt s·ª≠a ch·ªØa.';
                } else if (gameStats.reputation >= 70) {
                    return 'An, c√¥ th·∫•y con ƒë√£ r·∫•t tr∆∞·ªüng th√†nh. C√¥ t·ª± h√†o v·ªÅ con.';
                } else {
                    return 'An, c√¥ t·ª´ng tr·∫£i qua tu·ªïi 17 nh∆∞ con. C√¥ hi·ªÉu √°p l·ª±c c·ªßa con.';
                }
            }
            
            if (speaker === 'Em h·ªç' && dialogue.text.includes('ng∆∞·ª°ng m·ªô anh')) {
                if (gameStats.addiction >= 15) {
                    return 'Anh An... em nghe n√≥i anh c√≥ v·∫•n ƒë·ªÅ. Anh c√≥ th·ªÉ k·ªÉ cho em nghe ƒë·ªÉ em tr√°nh kh√¥ng?';
                } else if (gameStats.reputation >= 70) {
                    return 'Anh An, em ng∆∞·ª°ng m·ªô anh l·∫Øm. Anh ƒë√£ v∆∞·ª£t qua kh√≥ khƒÉn nh∆∞ th·∫ø n√†o?';
                } else {
                    return 'Anh An, em ng∆∞·ª°ng m·ªô anh l·∫Øm. Anh c√≥ th·ªÉ k·ªÉ cho em nghe kh√¥ng?';
                }
            }
            
            if (speaker === 'An' && dialogue.text.includes('m√¨nh ph·∫£i n√≥i g√¨ ƒë√¢y')) {
                if (gameStats.addiction >= 15) {
                    return 'Gia ƒë√¨nh m√¨nh... m√¨nh ƒë√£ l√†m m·ªçi ng∆∞·ªùi th·∫•t v·ªçng r·ªìi...';
                } else if (gameStats.reputation >= 70) {
                    return 'Gia ƒë√¨nh m√¨nh... m√¨nh bi·∫øt m·ªçi ng∆∞·ªùi ƒëang t·ª± h√†o v·ªÅ m√¨nh...';
                } else {
                    return 'Gia ƒë√¨nh m√¨nh... m√¨nh ph·∫£i n√≥i g√¨ ƒë√¢y?';
                }
            }
            
            if (speaker === 'B·ªë An' && dialogue.text === 'Con...') {
                if (gameMemory.confessed_to_family) {
                    return 'Con ƒë√£ r·∫•t d≈©ng c·∫£m khi th√†nh th·∫≠t. B·ªë m·∫π s·∫Ω gi√∫p con v∆∞·ª£t qua.';
                } else if (gameMemory.lied_to_family) {
                    return 'Con... b·ªë bi·∫øt con ƒëang che gi·∫•u ƒëi·ªÅu g√¨ ƒë√≥. H√£y tin t∆∞·ªüng gia ƒë√¨nh.';
                } else {
                    return 'Con c·∫ßn th·ªùi gian th√¨ b·ªë m·∫π s·∫Ω ƒë·ª£i. Nh∆∞ng ƒë·ª´ng m·ªôt m√¨nh g√°nh v√°c.';
                }
            }
            
            if (speaker === '√îng n·ªôi' && dialogue.text === 'An...') {
                if (gameMemory.confessed_to_family) {
                    return 'Ch√°u ƒë√£ l√†m ƒë√∫ng khi th√†nh th·∫≠t. √îng s·∫Ω h·ªó tr·ª£ ch√°u h·∫øt m√¨nh.';
                } else if (gameMemory.lied_to_family) {
                    return '√îng th·∫•t v·ªçng v√¨ ch√°u v·∫´n kh√¥ng th√†nh th·∫≠t v·ªõi gia ƒë√¨nh.';
                } else {
                    return '√îng hi·ªÉu ch√°u c·∫ßn th·ªùi gian. Nh∆∞ng gia ƒë√¨nh lu√¥n ·ªü ƒë√¢y.';
                }
            }
            
            if (speaker === 'K·ªÉ chuy·ªán' && dialogue.text.includes('quy·∫øt ƒë·ªãnh quan tr·ªçng')) {
                if (gameMemory.confessed_to_family) {
                    return 'Cu·ªôc h·ªçp gia ƒë√¨nh k·∫øt th√∫c v·ªõi k·∫ø ho·∫°ch h·ªó tr·ª£ An cai nghi·ªán v√† t√°i h√≤a nh·∫≠p. Gia ƒë√¨nh quy·∫øt ƒë·ªãnh ƒë·ªìng h√†nh c√πng An...';
                } else if (gameMemory.lied_to_family) {
                    return 'Cu·ªôc h·ªçp gia ƒë√¨nh k·∫øt th√∫c trong cƒÉng th·∫≥ng. Gia ƒë√¨nh quy·∫øt ƒë·ªãnh theo d√µi An ch·∫∑t ch·∫Ω h∆°n...';
                } else {
                    return 'Cu·ªôc h·ªçp gia ƒë√¨nh k·∫øt th√∫c v·ªõi quy·∫øt ƒë·ªãnh cho An th√™m th·ªùi gian suy nghƒ©, nh∆∞ng s·∫Ω c√≥ cu·ªôc n√≥i chuy·ªán ti·∫øp theo...';
                }
            }
            
            // Chapter 14 - C∆° H·ªôi Cu·ªëi
            if (speaker === 'Th·∫ßy B√¨nh' && dialogue.text.includes('tr·∫£i qua nh·ªØng th·ª≠ th√°ch')) {
                if (gameStats.addiction >= 15) {
                    return 'V√¨ em ƒë√£ tr·∫£i qua nh·ªØng th·ª≠ th√°ch v·ªõi ch·∫•t k√≠ch th√≠ch. C√¢u chuy·ªán th·∫≠t c·ªßa em c√≥ th·ªÉ c·∫£nh b√°o c√°c b·∫°n kh√°c.';
                } else if (gameStats.reputation >= 70) {
                    return 'V√¨ em ƒë√£ v∆∞·ª£t qua th·ª≠ th√°ch v√† gi·ªØ ƒë∆∞·ª£c con ƒë∆∞·ªùng ƒë√∫ng ƒë·∫Øn. C√¢u chuy·ªán c·ªßa em s·∫Ω truy·ªÅn c·∫£m h·ª©ng.';
                } else {
                    return 'V√¨ em ƒë√£ tr·∫£i qua nh·ªØng th·ª≠ th√°ch. C√¢u chuy·ªán c·ªßa em c√≥ th·ªÉ gi√∫p nhi·ªÅu b·∫°n tr·∫ª kh√°c.';
                }
            }
            
            if (speaker === 'Lan' && dialogue.text.includes('c∆° h·ªôi tuy·ªát v·ªùi')) {
                if (gameMemory.confessed_love_lan) {
                    return '*xu·∫•t hi·ªán* An! M√¨nh v·ª´a nghe th·∫ßy B√¨nh n√≥i. ƒê√¢y l√† c∆° h·ªôi ƒë·ªÉ b·∫°n ch·ª©ng minh b·∫°n ƒë√£ thay ƒë·ªïi!';
                } else if (gameStats.addiction >= 15) {
                    return '*xu·∫•t hi·ªán* An! ƒê√¢y c√≥ th·ªÉ l√† c∆° h·ªôi ƒë·ªÉ b·∫°n chu·ªôc l·ªói...';
                } else {
                    return '*xu·∫•t hi·ªán* An! M√¨nh v·ª´a nghe th·∫ßy B√¨nh n√≥i. ƒê√¢y l√† c∆° h·ªôi tuy·ªát v·ªùi!';
                }
            }
            
            if (speaker === 'Th·∫ßy B√¨nh' && dialogue.text.includes('chu·ªôc l·ªói')) {
                if (gameStats.addiction >= 15) {
                    return 'Th·∫ßy tin em c√≥ th·ªÉ l√†m ƒë∆∞·ª£c. ƒê√¢y l√† c√°ch ƒë·ªÉ em chu·ªôc l·ªói v√† gi√∫p c√°c b·∫°n tr√°nh kh·ªèi con ƒë∆∞·ªùng sai l·∫ßm.';
                } else if (gameStats.reputation >= 70) {
                    return 'Th·∫ßy tin em c√≥ th·ªÉ l√†m ƒë∆∞·ª£c. ƒê√¢y l√† c√°ch ƒë·ªÉ em chia s·∫ª kinh nghi·ªám t√≠ch c·ª±c v·ªõi c·ªông ƒë·ªìng.';
                } else {
                    return 'Th·∫ßy tin em c√≥ th·ªÉ l√†m ƒë∆∞·ª£c. ƒê√¢y c≈©ng l√† c√°ch ƒë·ªÉ em chu·ªôc l·ªói v√† gi√∫p ƒë·ª° c·ªông ƒë·ªìng.';
                }
            }
            
            if (speaker === 'Th·∫ßy B√¨nh' && dialogue.text === 'Quy·∫øt ƒë·ªãnh c·ªßa em...') {
                if (gameMemory.accepted_speaker_role_prepared) {
                    return 'Th·∫ßy r·∫•t t·ª± h√†o v·ªÅ quy·∫øt ƒë·ªãnh c·ªßa em. Th·∫ßy s·∫Ω h·ªó tr·ª£ em chu·∫©n b·ªã b√†i ph√°t bi·ªÉu.';
                } else if (gameMemory.refused_speaker_role) {
                    return 'Th·∫ßy hi·ªÉu em ch∆∞a s·∫µn s√†ng. Nh∆∞ng c∆° h·ªôi kh√¥ng c√≥ nhi·ªÅu, em h√£y suy nghƒ© l·∫°i.';
                } else if (gameMemory.accepted_speaker_role_unprepared) {
                    return 'Em ƒë√£ nh·∫≠n l·ªùi, nh∆∞ng th·∫ßy lo em ch∆∞a th·ª±c s·ª± cam k·∫øt. H√£y chu·∫©n b·ªã k·ªπ nh√©.';
                } else {
                    return dialogue.text;
                }
            }
            
            if (speaker === 'Lan' && dialogue.text === 'An...') {
                if (gameMemory.accepted_speaker_role_prepared) {
                    return 'M√¨nh tin b·∫°n s·∫Ω l√†m ƒë∆∞·ª£c! M√¨nh s·∫Ω ·ªü ƒë√≥ ·ªßng h·ªô b·∫°n.';
                } else if (gameMemory.refused_speaker_role) {
                    return 'M√¨nh hi·ªÉu b·∫°n s·ª£... Nh∆∞ng ƒë√¥i khi ph·∫£i d≈©ng c·∫£m m·ªõi thay ƒë·ªïi ƒë∆∞·ª£c.';
                } else if (gameMemory.accepted_speaker_role_unprepared) {
                    return 'B·∫°n nh·∫≠n l·ªùi r·ªìi... Nh∆∞ng m√¨nh lo b·∫°n ch∆∞a th·ª±c s·ª± s·∫µn s√†ng.';
                } else {
                    return dialogue.text;
                }
            }
            
            if (speaker === 'Tu·∫•n' && dialogue.text.includes('kh√¥ng c·∫£nh b√°o cho Minh')) {
                if (gameMemory.reported_vaping_plan) {
                    return '*t·ª©c gi·∫≠n* Ch√≠nh b·∫°n ƒë√£ b√°o c√°o ch√∫ng m√¨nh! B·∫°n ƒë√£ ph·∫£n b·ªôi b·∫°n b√®!';
                } else if (gameMemory.ignored_vaping_plan) {
                    return 'B·∫°n bi·∫øt m√† kh√¥ng n√≥i! T·∫°i sao b·∫°n kh√¥ng c·∫£nh b√°o Minh?';
                } else if (gameMemory.joined_school_vaping) {
                    return 'B·∫°n c≈©ng tham gia m√†! Sao b·∫°n kh√¥ng b·ªã ƒë√¨nh ch·ªâ nh∆∞ Minh?';
                } else {
                    return dialogue.text;
                }
            }
            
            if (speaker === 'Minh' && dialogue.text.includes('kh√¥ng c√≤n l√† ng∆∞·ªùi b·∫°n')) {
                if (gameMemory.reported_vaping_plan) {
                    return 'B·∫°n ƒë√£ ph·∫£n b·ªôi m√¨nh! M√¨nh tin t∆∞·ªüng b·∫°n m√† b·∫°n l·∫°i b√°o c√°o m√¨nh!';
                } else if (gameMemory.ignored_vaping_plan) {
                    return 'B·∫°n bi·∫øt m√¨nh s·∫Ω g·∫∑p r·∫Øc r·ªëi m√† kh√¥ng ngƒÉn... ƒê√≥ c√≥ ph·∫£i t√¨nh b·∫°n kh√¥ng?';
                } else if (gameMemory.joined_school_vaping) {
                    return 'Sao b·∫°n kh√¥ng b·ªã ƒë√¨nh ch·ªâ nh∆∞ m√¨nh? B·∫°n ƒë√£ l√†m g√¨ ƒë·ªÉ tho√°t?';
                } else {
                    return dialogue.text;
                }
            }
            
            if (speaker === 'Tu·∫•n' && dialogue.text.includes('lo cho b·∫£n th√¢n')) {
                if (gameMemory.reported_vaping_plan) {
                    return 'B·∫°n ƒë√£ b√°n ƒë·ª©ng b·∫°n b√® ƒë·ªÉ b·∫£o v·ªá b·∫£n th√¢n! ƒê√≥ l√† h√†nh vi ƒë√°ng khinh!';
                } else if (gameMemory.cut_ties_with_minh) {
                    return 'Gi·ªù b·∫°n c√≤n c·∫Øt ƒë·ª©t v·ªõi Minh n·ªØa! B·∫°n th·∫≠t √≠ch k·ª∑!';
                } else {
                    return dialogue.text;
                }
            }
            
            if (speaker === 'Minh' && dialogue.text === 'An...') {
                if (gameMemory.tried_to_help_minh_quit) {
                    return 'Th·∫≠t sao? B·∫°n th·ª±c s·ª± mu·ªën gi√∫p m√¨nh? *√°nh m·∫Øt hy v·ªçng*';
                } else if (gameMemory.apologized_to_minh) {
                    return 'L·ªùi xin l·ªói kh√¥ng th·ªÉ thay ƒë·ªïi ƒë∆∞·ª£c g√¨... Nh∆∞ng √≠t ra b·∫°n c√≤n bi·∫øt l·ªói...';
                } else if (gameMemory.cut_ties_with_minh) {
                    return 'V·∫≠y l√†... t√¨nh b·∫°n 10 nƒÉm c·ªßa ch√∫ng ta k·∫øt th√∫c ·ªü ƒë√¢y... *n∆∞·ªõc m·∫Øt r∆°i*';
                } else {
                    return dialogue.text;
                }
            }
            
            if (speaker === 'Tu·∫•n' && dialogue.text === 'Hmm...') {
                if (gameMemory.tried_to_help_minh_quit) {
                    return 'Gi√∫p Minh b·ªè? B·∫°n nghƒ© m√¨nh l√† ai? B·∫°n kh√¥ng hi·ªÉu g√¨ v·ªÅ ch√∫ng m√¨nh c·∫£!';
                } else if (gameMemory.cut_ties_with_minh) {
                    return 'T·ªët! Ch√∫ng m√¨nh c≈©ng kh√¥ng c·∫ßn b·∫°n. B·∫°n ch·ªâ l√† g√°nh n·∫∑ng th√¥i!';
                } else if (gameMemory.apologized_to_minh) {
                    return 'Xin l·ªói th√¥i √†? Qu√° mu·ªôn r·ªìi, An. Thi·ªát h·∫°i ƒë√£ g√¢y ra r·ªìi.';
                } else {
                    return dialogue.text;
                }
            }
            
            if (speaker === 'Lan' && dialogue.text.includes('B·∫°n ·ªïn ch·ª©')) {
                if (gameMemory.cut_ties_with_minh) {
                    return 'An, m√¨nh th·∫•y b·∫°n ƒë√£ l√†m ƒëi·ªÅu ƒë√∫ng ƒë·∫Øn. T√¨nh b·∫°n kh√¥ng c√≥ nghƒ©a l√† che gi·∫•u sai l·∫ßm.';
                } else if (gameMemory.reported_vaping_plan) {
                    return 'M√¨nh t·ª± h√†o v·ªÅ b·∫°n, An. B·∫°n ƒë√£ c√≥ can ƒë·∫£m l√†m ƒëi·ªÅu ƒë√∫ng.';
                } else if (gameMemory.tried_to_help_minh_quit) {
                    return 'B·∫°n mu·ªën gi√∫p Minh √†? ƒê√≥ l√† ƒëi·ªÅu t·ªët, nh∆∞ng b·∫°n ph·∫£i c·∫©n th·∫≠n...';
                } else {
                    return dialogue.text;
                }
            }
            
            if (speaker === 'An' && dialogue.text.includes('kh√¥ng bi·∫øt m√¨nh ƒë√£ l√†m ƒë√∫ng hay sai')) {
                if (gameMemory.cut_ties_with_minh) {
                    return 'M√¨nh ƒë√£ c·∫Øt ƒë·ª©t v·ªõi Minh... C√≥ ph·∫£i m√¨nh qu√° t√†n nh·∫´n kh√¥ng?';
                } else if (gameMemory.reported_vaping_plan) {
                    return 'M√¨nh ƒë√£ b√°o c√°o b·∫°n b√®... Li·ªáu ƒë√≥ c√≥ ph·∫£i ƒëi·ªÅu ƒë√∫ng ƒë·∫Øn?';
                } else if (gameMemory.tried_to_help_minh_quit) {
                    return 'M√¨nh mu·ªën gi√∫p Minh, nh∆∞ng kh√¥ng bi·∫øt c√≥ th√†nh c√¥ng kh√¥ng...';
                } else {
                    return dialogue.text;
                }
            }
            
            // Chapter 12 - L·ªùi M·ªùi Nguy Hi·ªÉm
            if (speaker === 'Tu·∫•n' && dialogue.text.includes('kh√¥ng th·ªÉ t·∫£ ƒë∆∞·ª£c')) {
                if (gameMemory.party_full_participation) {
                    return 'B·∫°n ƒë√£ th·ª≠ ·ªü party r·ªìi, nh∆∞ng ƒë√¢y l√† level kh√°c ho√†n to√†n. Tin m√¨nh ƒëi.';
                } else if (gameMemory.party_light_participation) {
                    return 'L·∫ßn tr∆∞·ªõc b·∫°n ch·ªâ th·ª≠ m·ªôt ch√∫t. ƒê√¢y m·ªõi l√† th·ª© th·ª±c s·ª± ƒë√°ng gi√°.';
                } else if (gameMemory.party_refused_all) {
                    return 'B·∫°n ƒë√£ b·ªè l·ª° party r·ªìi. ƒê√¢y l√† c∆° h·ªôi cu·ªëi ƒë·ªÉ tr·∫£i nghi·ªám th·ª© ƒë·∫∑c bi·ªát.';
                } else {
                    return dialogue.text;
                }
            }
            
            if (speaker === 'Tu·∫•n' && dialogue.text === 'Hmm...') {
                if (gameMemory.joined_secret_club) {
                    return 'Tuy·ªát! Ch√†o m·ª´ng b·∫°n ƒë·∫øn v·ªõi th·∫ø gi·ªõi m·ªõi. B·∫°n s·∫Ω kh√¥ng h·ªëi h·∫≠n ƒë√¢u.';
                } else if (gameMemory.hesitated_about_club) {
                    return 'Suy nghƒ© nhanh ƒëi. C∆° h·ªôi n√†y kh√¥ng c√≥ m√£i ƒë√¢u.';
                } else if (gameMemory.refused_secret_club) {
                    return 'Th·∫•t v·ªçng qu√°... Nh∆∞ng ƒë·ª´ng nghƒ© l√† m√¨nh s·∫Ω ƒë·ªÉ y√™n cho b·∫°n ƒë√¢u.';
                } else {
                    return dialogue.text;
                }
            }
            
            if (speaker === 'K·ªÉ chuy·ªán' && dialogue.text.includes('√Ånh m·∫Øt c·ªßa Tu·∫•n')) {
                if (gameMemory.refused_secret_club) {
                    return '√Ånh m·∫Øt c·ªßa Tu·∫•n tr·ªü n√™n l·∫°nh l√πng v√† ƒë·∫ßy t√≠nh to√°n. C√≥ v·∫ª nh∆∞ anh ta ƒëang l√™n k·∫ø ho·∫°ch tr·∫£ th√π...';
                } else if (gameMemory.hesitated_about_club) {
                    return 'Tu·∫•n c√≥ v·∫ª kh√¥ng h√†i l√≤ng v·ªõi s·ª± do d·ª± c·ªßa An. ƒêi·ªÅu g√¨ s·∫Ω x·∫£y ra ti·∫øp theo?';
                } else {
                    return dialogue.text;
                }
            }
            
            if (speaker === 'Th·∫ßy B√¨nh') {
                if (gameMemory.first_vape_yes) {
                    return 'An, th·∫ßy nghe c√≥ tin ƒë·ªìn kh√¥ng hay v·ªÅ em. Th·∫ßy hy v·ªçng ƒë√≥ ch·ªâ l√† tin ƒë·ªìn th√¥i.';
                } else {
                    return dialogue.text;
                }
            }
            
            if (speaker === 'Tu·∫•n' && dialogue.text.includes('nh√≥m chat')) {
                if (gameMemory.first_vape_yes) {
                    return 'B·∫°n ƒë√£ th·ª≠ r·ªìi, gi·ªù mu·ªën tham gia nh√≥m chat b√≠ m·∫≠t kh√¥ng? Ch√∫ng m√¨nh t·ªï ch·ª©c nh·ªØng bu·ªïi party th√∫ v·ªã l·∫Øm.';
                } else if (gameMemory.first_vape_no) {
                    return 'Tuy b·∫°n ch∆∞a th·ª≠, nh∆∞ng m√¨nh th·∫•y b·∫°n c√≥ ti·ªÅm nƒÉng. Mu·ªën tham gia nh√≥m chat b√≠ m·∫≠t kh√¥ng?';
                } else {
                    return dialogue.text;
                }
            }
            
            // Chapter 7 - G√≥c S√¢n Tr∆∞·ªùng
            if (speaker === 'Tu·∫•n' && dialogue.text.includes('Minh v·ª´a quy·∫øt ƒë·ªãnh')) {
                if (gameMemory.first_vape_yes) {
                    return 'Ch√†o An! Minh c≈©ng mu·ªën th·ª≠ nh∆∞ b·∫°n h√¥m tr∆∞·ªõc. L·∫ßn n√†y b·∫°n c√≥ mu·ªën c√πng kh√¥ng?';
                } else if (gameMemory.rejected_secret_group) {
                    return '·ªí, An ƒë√¢y r·ªìi. Tuy b·∫°n kh√¥ng mu·ªën tham gia nh√≥m, nh∆∞ng Minh th√¨ kh√°c...';
                } else {
                    return dialogue.text;
                }
            }
            
            if (speaker === 'Lan' && dialogue.text.includes('lo l·∫Øng cho b·∫°n')) {
                if (gameMemory.promised_lan_avoid) {
                    return 'C·∫£m ∆°n b·∫°n ƒë√£ h·ª©a v·ªõi m√¨nh. M√¨nh tin b·∫°n s·∫Ω gi·ªØ l·ªùi.';
                } else if (gameMemory.dismissed_lan_warning) {
                    return 'M√¨nh th·∫•t v·ªçng v·ªÅ th√°i ƒë·ªô c·ªßa b·∫°n, An. Hy v·ªçng b·∫°n s·∫Ω suy nghƒ© l·∫°i.';
                } else {
                    return dialogue.text;
                }
            }
            
            // Chapter 8 - Party ƒê√™m
            if (speaker === 'Tu·∫•n' && dialogue.text.includes('th·ª≠ c√°i n√†y ch∆∞a')) {
                if (gameMemory.first_vape_yes) {
                    return 'An, b·∫°n ƒë√£ bi·∫øt c·∫£m gi√°c r·ªìi ƒë√∫ng kh√¥ng? H√¥m nay c√≥ th√™m r∆∞·ª£u n·ªØa ƒë·∫•y!';
                } else if (gameMemory.first_vape_no) {
                    return 'An, l·∫ßn tr∆∞·ªõc b·∫°n t·ª´ ch·ªëi, nh∆∞ng h√¥m nay l√† sinh nh·∫≠t Huy. B·∫°n kh√¥ng th·ªÉ t·ª´ ch·ªëi m√£i ƒë∆∞·ª£c!';
                } else if (gameMemory.promised_lan_avoid) {
                    return 'An, m√¨nh bi·∫øt b·∫°n ƒë√£ h·ª©a v·ªõi Lan, nh∆∞ng... ch·ªâ m·ªôt l·∫ßn th√¥i m√†!';
                } else {
                    return dialogue.text;
                }
            }
            
            if (speaker === 'K·ªÉ chuy·ªán' && dialogue.text.includes('ch·ª•p ·∫£nh v√† quay video')) {
                if (gameMemory.party_full_participation) {
                    return 'Trong l√∫c An ƒëang say v√† m·ªù m·∫Øt, c√≥ ng∆∞·ªùi ƒëang l√©n ch·ª•p ·∫£nh v√† quay video nh·ªØng h√†nh ƒë·ªông c·ªßa An...';
                } else if (gameMemory.party_light_participation) {
                    return 'M·∫∑c d√π An ch·ªâ th·ª≠ m·ªôt ch√∫t, nh∆∞ng v·∫´n c√≥ ng∆∞·ªùi ghi l·∫°i kho·∫£nh kh·∫Øc ƒë√≥...';
                } else {
                    return 'An nh·∫≠n ra c√≥ ng∆∞·ªùi ƒëang ch·ª•p ·∫£nh, nh∆∞ng may m·∫Øn l√† An kh√¥ng l√†m g√¨ ƒë√°ng lo ng·∫°i...';
                }
            }
            
            if (speaker === 'An' && dialogue.text.includes('ch·ª•p ·∫£nh √†')) {
                if (gameMemory.party_full_participation) {
                    return '∆†... ch·ª•p ·∫£nh √†? *ƒëang say, kh√¥ng ki·ªÉm so√°t ƒë∆∞·ª£c* Ch·ª•p ƒëi ch·ª•p ƒëi!';
                } else if (gameMemory.party_light_participation) {
                    return 'Ch·ª•p ·∫£nh √†? M√¨nh... m√¨nh h∆°i lo...';
                } else {
                    return 'Ch·ª•p ·∫£nh th√¨ kh√¥ng sao, m√¨nh kh√¥ng l√†m g√¨ sai c·∫£.';
                }
            }
            
            // Chapter 9 - Video B·ªã R√≤ R·ªâ
            if (speaker === 'B·∫°n l·ªõp B' && dialogue.text.includes('ch√≠nh l√† b·∫°n ·∫•y')) {
                if (gameMemory.party_full_participation) {
                    return '*nh√¨n An* √îi tr·ªùi, ch√≠nh l√† b·∫°n ·∫•y trong video ƒë√≥! H√∫t vape v√† u·ªëng r∆∞·ª£u!';
                } else if (gameMemory.party_light_participation) {
                    return '*nh√¨n An* C√≥ ph·∫£i b·∫°n ·∫•y trong video kh√¥ng nh·ªâ? C√≥ v·∫ª gi·ªëng...';
                } else if (gameMemory.party_refused_all) {
                    return '*nh√¨n An* May m·∫Øn l√† b·∫°n ·∫•y kh√¥ng l√†m g√¨ trong video...';
                } else {
                    return dialogue.text;
                }
            }
            
            if (speaker === 'An' && dialogue.text.includes('Video g√¨? Cho m√¨nh xem!')) {
                if (gameMemory.party_full_participation) {
                    return 'Video g√¨? *lo l·∫Øng* Cho m√¨nh xem! Kh√¥ng l·∫Ω...';
                } else if (gameMemory.party_refused_all) {
                    return 'Video g√¨? M√¨nh kh√¥ng l√†m g√¨ sai m√†...';
                } else {
                    return dialogue.text;
                }
            }
            
            if (speaker === 'K·ªÉ chuy·ªán' && dialogue.text.includes('Video quay c·∫£nh party')) {
                if (gameMemory.party_full_participation) {
                    return 'Minh ƒë∆∞a ƒëi·ªán tho·∫°i cho An xem. Video r√µ n√©t cho th·∫•y An ƒëang h√∫t vape v√† u·ªëng r∆∞·ª£u, c∆∞·ªùi ƒë√πa v·ªõi c√°c b·∫°n...';
                } else if (gameMemory.party_light_participation) {
                    return 'Minh ƒë∆∞a ƒëi·ªán tho·∫°i cho An xem. Video c√≥ c·∫£nh An th·ª≠ vape, m·∫∑c d√π ch·ªâ m·ªôt ch√∫t nh∆∞ng v·∫´n r√µ r√†ng...';
                } else if (gameMemory.party_refused_all) {
                    return 'Minh ƒë∆∞a ƒëi·ªán tho·∫°i cho An xem. Video quay c·∫£nh party, An xu·∫•t hi·ªán nh∆∞ng ch·ªâ ƒë·ª©ng b√™n c·∫°nh, kh√¥ng tham gia g√¨...';
                } else {
                    return dialogue.text;
                }
            }
            
            if (speaker === 'An' && dialogue.text.includes('Kh√¥ng... kh√¥ng th·ªÉ n√†o!')) {
                if (gameMemory.party_full_participation) {
                    return 'Kh√¥ng... sao m√¨nh l·∫°i ngu ng·ªëc th·∫ø! Gi·ªù m·ªçi ng∆∞·ªùi ƒë·ªÅu bi·∫øt r·ªìi!';
                } else if (gameMemory.party_light_participation) {
                    return '√îi kh√¥ng... ch·ªâ th·ª≠ m·ªôt ch√∫t th√¥i m√† c≈©ng b·ªã quay l·∫°i...';
                } else if (gameMemory.party_refused_all) {
                    return 'May m·∫Øn l√† m√¨nh kh√¥ng l√†m g√¨ sai... nh∆∞ng v·∫´n c√≥ m·∫∑t ·ªü ƒë√≥...';
                } else {
                    return dialogue.text;
                }
            }
            
            if (speaker === 'Th·∫ßy B√¨nh' && dialogue.text.includes('v√†o ph√≤ng hi·ªáu tr∆∞·ªüng')) {
                if (gameMemory.party_full_participation) {
                    return '*xu·∫•t hi·ªán ƒë·ªôt ng·ªôt v·ªõi v·∫ª m·∫∑t nghi√™m tr·ªçng* An, em v√†o ph√≤ng hi·ªáu tr∆∞·ªüng ngay l·∫≠p t·ª©c! Chuy·ªán n√†y r·∫•t nghi√™m tr·ªçng!';
                } else if (gameMemory.party_refused_all) {
                    return '*xu·∫•t hi·ªán* An, th·∫ßy c·∫ßn l√†m r√µ v·ªÅ video n√†y. Em v√†o ph√≤ng hi·ªáu tr∆∞·ªüng.';
                } else {
                    return dialogue.text;
                }
            }
            
            if (speaker === 'Hi·ªáu tr∆∞·ªüng' && dialogue.text.includes('v·∫•n ƒë·ªÅ r·∫•t nghi√™m tr·ªçng')) {
                if (gameMemory.party_full_participation) {
                    return 'An, th·∫ßy ƒë√£ xem video ƒë√≥ r·ªìi. Em xu·∫•t hi·ªán r√µ r√†ng ƒëang s·ª≠ d·ª•ng ch·∫•t k√≠ch th√≠ch. ƒê√¢y l√† vi ph·∫°m nghi√™m tr·ªçng!';
                } else if (gameMemory.party_light_participation) {
                    return 'An, trong video c√≥ th·ªÉ th·∫•y em ƒëang th·ª≠ vape. D√π ch·ªâ m·ªôt ch√∫t nh∆∞ng ƒë√¢y v·∫´n l√† vi ph·∫°m.';
                } else if (gameMemory.party_refused_all) {
                    return 'An, may m·∫Øn l√† em kh√¥ng tham gia v√†o nh·ªØng h√†nh vi sai tr√°i trong video. Nh∆∞ng th·∫ßy c·∫ßn l√†m r√µ t·∫°i sao em c√≥ m·∫∑t ·ªü ƒë√≥.';
                } else {
                    return dialogue.text;
                }
            }
            
            if (speaker === 'An' && dialogue.text.includes('Th∆∞a th·∫ßy...')) {
                if (gameMemory.party_full_participation) {
                    return 'Th∆∞a th·∫ßy... em bi·∫øt em ƒë√£ sai r·ªìi... *c√∫i ƒë·∫ßu*';
                } else if (gameMemory.party_refused_all) {
                    return 'Th∆∞a th·∫ßy, em ch·ªâ ƒëi d·ª± sinh nh·∫≠t b·∫°n th√¥i ·∫°. Em kh√¥ng tham gia g√¨ sai tr√°i c·∫£.';
                } else {
                    return dialogue.text;
                }
            }
            
            if (speaker === 'Hi·ªáu tr∆∞·ªüng' && dialogue.text.includes('ph·ª• thu·ªôc v√†o vi·ªác em c√≥ xu·∫•t hi·ªán')) {
                if (gameMemory.confessed_video_guilt) {
                    return 'Em ƒë√£ th√†nh th·∫≠t th·ª´a nh·∫≠n. Th·∫ßy s·∫Ω c√¢n nh·∫Øc ƒëi·ªÅu n√†y khi ƒë∆∞a ra quy·∫øt ƒë·ªãnh k·ª∑ lu·∫≠t.';
                } else if (gameMemory.denied_participation_video && gameMemory.party_refused_all) {
                    return 'Th·∫ßy ƒë√£ xem k·ªπ video. Em kh√¥ng tham gia v√†o h√†nh vi sai tr√°i n√†o. Th·∫ßy s·∫Ω m·ªùi em tham gia ch∆∞∆°ng tr√¨nh tuy√™n truy·ªÅn s·ª©c kh·ªèe.';
                } else if (gameMemory.denied_participation_video && gameMemory.party_full_participation) {
                    return 'Nh∆∞ng trong video r√µ r√†ng th·∫•y em ƒëang h√∫t vape. Em kh√¥ng n√™n ch·ªëi c√£i n·ªØa.';
                } else {
                    return dialogue.text;
                }
            }
            
            if (speaker === 'K·ªÉ chuy·ªán' && dialogue.text.includes('b∆∞·ªõc ra h√†nh lang')) {
                if (gameMemory.confessed_video_guilt) {
                    return 'Sau cu·ªôc h·ªçp, An b∆∞·ªõc ra v·ªõi t√¢m tr·∫°ng n·∫∑ng n·ªÅ. Vi·ªác th√†nh th·∫≠t c√≥ th·ªÉ gi√∫p gi·∫£m nh·∫π h√¨nh ph·∫°t, nh∆∞ng h·∫≠u qu·∫£ v·∫´n r·∫•t nghi√™m tr·ªçng...';
                } else if (gameMemory.denied_participation_video && gameMemory.party_refused_all) {
                    return 'An th·ªü ph√†o nh·∫π nh√µm. May m·∫Øn l√† m√¨nh ƒë√£ kh√¥ng tham gia v√†o nh·ªØng h√†nh vi sai tr√°i. Th·∫ßy hi·ªáu tr∆∞·ªüng c√≤n m·ªùi m√¨nh tham gia ch∆∞∆°ng tr√¨nh tuy√™n truy·ªÅn...';
                } else {
                    return dialogue.text;
                }
            }
            
            // Chapter 10 - T√¨nh C·∫£m
            if (speaker === 'Lan' && dialogue.text.includes('ƒëi·ªÅu mu·ªën n√≥i v·ªõi b·∫°n')) {
                if (gameMemory.promised_lan_avoid && gameStats.addiction <= 5) {
                    return 'An... m√¨nh th·∫•y b·∫°n ƒë√£ c·ªë g·∫Øng thay ƒë·ªïi. M√¨nh c√≥ ƒëi·ªÅu mu·ªën n√≥i v·ªõi b·∫°n t·ª´ l√¢u r·ªìi.';
                } else if (gameStats.addiction >= 15) {
                    return 'An... m√¨nh th·∫•y b·∫°n ƒë√£ thay ƒë·ªïi nhi·ªÅu. M√¨nh c√≥ ƒëi·ªÅu mu·ªën n√≥i, nh∆∞ng...';
                } else if (gameMemory.party_refused_all) {
                    return 'An... m√¨nh ng∆∞·ª°ng m·ªô s·ª± ki√™n ƒë·ªãnh c·ªßa b·∫°n. M√¨nh c√≥ ƒëi·ªÅu mu·ªën n√≥i v·ªõi b·∫°n t·ª´ l√¢u r·ªìi.';
                } else {
                    return dialogue.text;
                }
            }
            
            if (speaker === 'Lan' && dialogue.text.includes('m√¨nh th√≠ch b·∫°n')) {
                if (gameStats.addiction >= 15) {
                    return 'M√¨nh... m√¨nh t·ª´ng th√≠ch b·∫°n, An. Nh∆∞ng gi·ªù...';
                } else if (gameMemory.confessed_love_lan) {
                    return 'M√¨nh... m√¨nh th√≠ch b·∫°n, An. T·ª´ l√¢u r·ªìi.';
                } else {
                    return dialogue.text;
                }
            }
            
            if (speaker === 'An' && dialogue.text.includes('Lan... m√¨nh...')) {
                if (gameStats.addiction >= 15) {
                    return 'Lan... m√¨nh bi·∫øt m√¨nh ƒë√£ thay ƒë·ªïi... kh√¥ng ph·∫£i theo h∆∞·ªõng t·ªët...';
                } else if (gameMemory.promised_lan_avoid) {
                    return 'Lan... m√¨nh c≈©ng c√≥ c·∫£m gi√°c ƒë·∫∑c bi·ªát v·ªõi b·∫°n...';
                } else {
                    return dialogue.text;
                }
            }
            
            if (speaker === 'Lan' && dialogue.text === 'Nh∆∞ng...') {
                if (gameStats.addiction >= 15) {
                    return 'Nh∆∞ng m√¨nh kh√¥ng th·ªÉ ·ªü c·∫°nh ng∆∞·ªùi nh∆∞ v·∫≠y ƒë∆∞·ª£c, An. M√¨nh xin l·ªói...';
                } else if (gameStats.addiction <= 5 && gameMemory.promised_lan_avoid) {
                    return 'Nh∆∞ng m√¨nh mu·ªën ch·∫Øc ch·∫Øn r·∫±ng b·∫°n th·ª±c s·ª± ƒë√£ thay ƒë·ªïi...';
                } else {
                    return 'Nh∆∞ng m√¨nh lo l·∫Øng v·ªÅ nh·ªØng thay ƒë·ªïi c·ªßa b·∫°n g·∫ßn ƒë√¢y...';
                }
            }
            
            if (speaker === 'An' && dialogue.text.includes('Nh∆∞ng g√¨, Lan?')) {
                if (gameStats.addiction >= 15) {
                    return 'M√¨nh hi·ªÉu r·ªìi, Lan... M√¨nh kh√¥ng x·ª©ng ƒë√°ng v·ªõi b·∫°n...';
                } else {
                    return dialogue.text;
                }
            }
            
            // Chapter 9 - H·∫≠u Qu·∫£ Bu·ªïi Ti·ªác
            if (speaker === 'Tu·∫•n' && dialogue.text.includes('ti·∫øn ƒë·∫øn ch·ªó An')) {
                if (gameMemory.party_full_participation) {
                    return 'An, ch√∫ng ta c√≥ v·∫•n ƒë·ªÅ l·ªõn r·ªìi. ·∫¢nh v√† video h√¥m qua...';
                } else if (gameMemory.party_refused_all) {
                    return 'An, tuy b·∫°n kh√¥ng tham gia g√¨, nh∆∞ng vi·ªác b·∫°n c√≥ m·∫∑t ·ªü ƒë√≥ c≈©ng ƒë·ªß g√¢y tin ƒë·ªìn r·ªìi.';
                } else {
                    return dialogue.text;
                }
            }
            
            if (speaker === 'K·ªÉ chuy·ªán' && dialogue.text.includes('tin nh·∫Øn t·ª´ s·ªë l·∫°')) {
                if (gameMemory.party_full_participation) {
                    return 'ƒêi·ªán tho·∫°i c·ªßa An rung l√™n. M·ªôt tin nh·∫Øn t·ª´ s·ªë l·∫° k√®m theo nh·ªØng h√¨nh ·∫£nh ƒë√°ng lo ng·∫°i...';
                } else if (gameMemory.party_light_participation) {
                    return 'ƒêi·ªán tho·∫°i c·ªßa An rung l√™n. C√≥ v·∫ª nh∆∞ ai ƒë√≥ ƒë√£ ch·ª•p ƒë∆∞·ª£c kho·∫£nh kh·∫Øc An th·ª≠ vape...';
                } else if (gameMemory.party_refused_all) {
                    return 'May m·∫Øn l√† An kh√¥ng nh·∫≠n ƒë∆∞·ª£c tin nh·∫Øn ƒëe d·ªça n√†o...';
                } else {
                    return dialogue.text;
                }
            }
            
            if (speaker === 'Tin nh·∫Øn l·∫°') {
                if (gameMemory.party_full_participation) {
                    return '"·∫¢nh An say x·ªân v√† h√∫t vape ƒë√¢y. 50k ho·∫∑c t√¥i s·∫Ω g·ª≠i cho th·∫ßy c√¥ v√† gia ƒë√¨nh b·∫°n üòà"';
                } else if (gameMemory.party_light_participation) {
                    return '"·∫¢nh An th·ª≠ vape ƒë√¢y. B·∫°n c√≥ mu·ªën n√≥ lan truy·ªÅn kh√¥ng? üòè"';
                } else {
                    return dialogue.text;
                }
            }
            
            if (speaker === 'An' && dialogue.text.includes('ch·ª•p ·∫£nh m√¨nh')) {
                if (gameMemory.party_full_participation) {
                    return 'Kh√¥ng... t·∫°i sao m√¨nh l·∫°i say ƒë·∫øn th·∫ø? Gi·ªù b·ªã ch·ª•p ·∫£nh r·ªìi!';
                } else if (gameMemory.party_light_participation) {
                    return 'M√¨nh ch·ªâ th·ª≠ m·ªôt ch√∫t th√¥i m√†... Sao l·∫°i b·ªã ch·ª•p ·∫£nh?';
                } else if (gameMemory.party_refused_all) {
                    return 'May m·∫Øn l√† m√¨nh kh√¥ng l√†m g√¨ sai...';
                } else {
                    return dialogue.text;
                }
            }
            
            if (speaker === 'Th·∫ßy B√¨nh' && dialogue.text.includes('h√†nh vi c·ªßa em')) {
                if (gameMemory.confessed_to_teacher) {
                    return 'Em ƒë√£ th√†nh th·∫≠t v·ªõi th·∫ßy, ƒëi·ªÅu ƒë√≥ t·ªët. Nh∆∞ng h√†nh vi n√†y v·∫´n r·∫•t nghi√™m tr·ªçng, An.';
                } else if (gameMemory.denied_to_teacher) {
                    return 'An, th·∫ßy c√≥ b·∫±ng ch·ª©ng r·ªìi. Em kh√¥ng n√™n ch·ªëi c√£i n·ªØa.';
                } else {
                    return dialogue.text;
                }
            }
            
            if (speaker === 'An' && dialogue.text.includes('Lan... m√¨nh...')) {
                if (gameMemory.promised_lan_avoid) {
                    return 'Lan... m√¨nh ƒë√£ th·∫•t h·ª©a v·ªõi b·∫°n r·ªìi. M√¨nh xin l·ªói...';
                } else if (gameMemory.dismissed_lan_warning) {
                    return 'Lan... c√≥ l·∫Ω b·∫°n ƒë√£ ƒë√∫ng t·ª´ ƒë·∫ßu...';
                } else {
                    return 'Lan... m√¨nh kh√¥ng bi·∫øt ph·∫£i n√≥i g√¨...';
                }
            }
            
            if (speaker === 'Tu·∫•n' && dialogue.text.includes('ch√∫ng ta c·∫ßn n√≥i chuy·ªán')) {
                if (gameMemory.party_full_participation) {
                    return 'An, t√¨nh h√¨nh r·∫•t t·ªá. ·∫¢nh c·ªßa b·∫°n ƒëang ƒë∆∞·ª£c lan truy·ªÅn. Ch√∫ng ta ph·∫£i t√¨m c√°ch x·ª≠ l√Ω.';
                } else if (gameMemory.blamed_tuan) {
                    return 'Sao b·∫°n l·∫°i ƒë·ªï l·ªói cho m√¨nh? M√¨nh ch·ªâ m·ªùi th√¥i, quy·∫øt ƒë·ªãnh l√† c·ªßa b·∫°n m√†!';
                } else {
                    return dialogue.text;
                }
            }
            
            // Chapter 5 - H·∫≠u Qu·∫£ ƒê·∫ßu Ti√™n
            if (speaker === 'M·∫π An') {
                if (gameMemory.first_vape_yes) {
                    return 'Con h√¥m nay c√≥ v·∫ª m·ªát m·ªèi. C√≥ ph·∫£i do ch∆°i v·ªõi b·∫°n m·ªõi kh√¥ng?';
                } else if (gameMemory.first_vape_no) {
                    return 'Con tr√¥ng c√≥ v·∫ª t·ª± tin h∆°n h√¥m nay. B·∫°n m·ªõi c√≥ ·∫£nh h∆∞·ªüng t√≠ch c·ª±c ƒë·∫øn con nh·ªâ?';
                } else {
                    return dialogue.text;
                }
            }
            
            // Chapter 10 - Chuy·ªán Gia ƒê√¨nh
            if (speaker === 'M·∫π An' && dialogue.text.includes('m·ªát m·ªèi')) {
                if (gameMemory.party_full_participation) {
                    return 'Con tr√¥ng r·∫•t m·ªát m·ªèi v√† c√≥ m√πi l·∫°. Con c√≥ ·ªïn kh√¥ng?';
                } else if (gameMemory.confessed_to_teacher) {
                    return 'Th·∫ßy B√¨nh ƒë√£ g·ªçi ƒëi·ªán cho m·∫π r·ªìi. Con c√≥ mu·ªën gi·∫£i th√≠ch kh√¥ng?';
                } else if (gameMemory.party_refused_all) {
                    return 'Con tr√¥ng lo l·∫Øng. C√≥ chuy·ªán g√¨ ·ªü tr∆∞·ªùng kh√¥ng?';
                } else {
                    return dialogue.text;
                }
            }
            
            if (speaker === 'An' && dialogue.text.includes('c·∫£m th·∫•y t·ªôi l·ªói')) {
                if (gameMemory.party_full_participation) {
                    return 'Con... con ƒë√£ l√†m ƒëi·ªÅu sai tr√°i r·ªìi. *kh√¥ng d√°m nh√¨n b·ªë*';
                } else if (gameMemory.promised_lan_avoid && gameMemory.party_light_participation) {
                    return 'Con ƒë√£ th·∫•t h·ª©a v·ªõi m·ªôt ng∆∞·ªùi b·∫°n... *c·∫£m th·∫•y t·ªôi l·ªói*';
                } else if (gameMemory.party_refused_all) {
                    return 'Con hi·ªÉu t·∫°i sao b·ªë l·∫°i k·ªÉ chuy·ªán n√†y. Con s·∫Ω c·∫©n th·∫≠n.';
                } else {
                    return dialogue.text;
                }
            }
            
            if (speaker === 'B·ªë An' && dialogue.text.includes('tin con l√† ƒë·ª©a tr·∫ª th√¥ng minh')) {
                if (gameMemory.confessed_to_parents) {
                    return 'Con ƒë√£ th√†nh th·∫≠t v·ªõi b·ªë m·∫π, ƒëi·ªÅu ƒë√≥ r·∫•t t·ªët. Gi·ªù ch√∫ng ta s·∫Ω c√πng nhau gi√∫p con b·ªè nh·ªØng th√≥i quen x·∫•u.';
                } else if (gameMemory.lied_to_parents) {
                    return 'B·ªë tin con. Nh∆∞ng n·∫øu c√≥ chuy·ªán g√¨, ƒë·ª´ng gi·∫•u b·ªë m·∫π nh√©.';
                } else if (gameMemory.honest_about_avoiding) {
                    return 'Con r·∫•t kh√¥n ngoan khi tr√°nh xa nh·ªØng ·∫£nh h∆∞·ªüng x·∫•u. B·ªë m·∫π t·ª± h√†o v·ªÅ con.';
                } else {
                    return dialogue.text;
                }
            }
            
            // Chapter 11 - Minh Thay ƒê·ªïi
            if (speaker === 'Tu·∫•n' && dialogue.text.includes('th√†nh vi√™n t√≠ch c·ª±c')) {
                if (gameMemory.party_full_participation) {
                    return 'Ch√†o An! Sau party h√¥m tr∆∞·ªõc, Minh ƒë√£ ho√†n to√†n thay ƒë·ªïi. B·∫°n c≈©ng v·∫≠y ph·∫£i kh√¥ng?';
                } else if (gameMemory.party_refused_all) {
                    return 'Ch√†o An! Tuy b·∫°n kh√¥ng tham gia party, nh∆∞ng Minh th√¨ kh√°c. B·∫°n c√≥ mu·ªën theo k·ªãp kh√¥ng?';
                } else if (gameMemory.rejected_secret_group) {
                    return '·ªí, An ƒë√¢y r·ªìi. Tuy b·∫°n t·ª´ ch·ªëi nh√≥m m√¨nh, nh∆∞ng Minh th√¨ kh√¥ng.';
                } else {
                    return dialogue.text;
                }
            }
            
            if (speaker === 'Minh' && dialogue.text.includes('kh√¥ng mu·ªën thay ƒë·ªïi')) {
                if (gameMemory.party_full_participation) {
                    return 'B·∫°n ƒë√£ th·ª≠ r·ªìi m√†, sao gi·ªù l·∫°i ng·∫°i ng√πng th·∫ø n√†y?';
                } else if (gameMemory.party_refused_all) {
                    return 'B·∫°n lu√¥n t·ª´ ch·ªëi m·ªçi th·ª©. C√≥ ph·∫£i b·∫°n s·ª£ th·ª≠ nh·ªØng ƒëi·ªÅu m·ªõi kh√¥ng?';
                } else if (gameMemory.promised_lan_avoid) {
                    return 'B·∫°n b·ªã Lan ·∫£nh h∆∞·ªüng qu√° nhi·ªÅu r·ªìi. Cu·ªôc s·ªëng kh√¥ng ch·ªâ c√≥ h·ªçc h√†nh ƒë√¢u.';
                } else {
                    return dialogue.text;
                }
            }
            
            if (speaker === 'Tu·∫•n' && dialogue.text.includes('kh√≥ h√≤a nh·∫≠p')) {
                if (gameMemory.first_vape_no && gameMemory.party_refused_all) {
                    return 'B·∫°n t·ª´ ch·ªëi m·ªçi th·ª© m√¨nh m·ªùi. C√≥ v·∫ª nh∆∞ b·∫°n kh√¥ng mu·ªën k·∫øt b·∫°n v·ªõi m√¨nh.';
                } else if (gameMemory.gave_in_to_peer_pressure) {
                    return 'Nh∆∞ng gi·ªù b·∫°n ƒë√£ thay ƒë·ªïi r·ªìi ƒë√∫ng kh√¥ng? Minh n√≥i b·∫°n ƒë√£ b·∫Øt ƒë·∫ßu hi·ªÉu.';
                } else {
                    return dialogue.text;
                }
            }
            
            if (speaker === 'Minh' && dialogue.text.includes('tr·∫£i nghi·ªám m√† b·∫°n ƒëang b·ªè l·ª°')) {
                if (gameMemory.party_full_participation) {
                    return 'B·∫°n ƒë√£ bi·∫øt c·∫£m gi√°c r·ªìi ƒë√∫ng kh√¥ng? C√≤n nhi·ªÅu th·ª© th√∫ v·ªã h∆°n n·ªØa ƒë·∫•y!';
                } else if (gameMemory.tried_to_save_friendship) {
                    return 'T√¨nh b·∫°n th√¨ quan tr·ªçng, nh∆∞ng b·∫°n c≈©ng ph·∫£i m·ªü l√≤ng v·ªõi nh·ªØng ƒëi·ªÅu m·ªõi.';
                } else {
                    return dialogue.text;
                }
            }
            
            if (speaker === 'Tu·∫•n' && dialogue.text.includes('party n·ªØa')) {
                if (gameMemory.party_full_participation) {
                    return 'L·∫ßn n√†y s·∫Ω c√≥ nh·ªØng th·ª© m·∫°nh h∆°n ƒë·∫•y. B·∫°n ƒë√£ s·∫µn s√†ng ch∆∞a?';
                } else if (gameMemory.party_light_participation) {
                    return 'L·∫ßn tr∆∞·ªõc b·∫°n ch·ªâ th·ª≠ m·ªôt ch√∫t. L·∫ßn n√†y h√£y th·ª≠ h·∫øt m√¨nh ƒëi!';
                } else if (gameMemory.party_refused_all) {
                    return 'L·∫ßn tr∆∞·ªõc b·∫°n kh√¥ng tham gia g√¨. Nh∆∞ng l·∫ßn n√†y s·∫Ω kh√°c ƒë·∫•y.';
                } else {
                    return dialogue.text;
                }
            }
            
            return dialogue.text;
        }
        
        function hideAllCharacters() {
            document.querySelectorAll('.character').forEach(char => {
                char.classList.remove('active');
            });
        }
        
        function makeChoice(choice) {
            // Apply stat changes
            if (choice.effect) {
                for (let stat in choice.effect) {
                    gameStats[stat] = Math.max(0, Math.min(100, gameStats[stat] + choice.effect[stat]));
                }
            }
            
            // Store memory
            if (choice.memory) {
                gameMemory[choice.memory] = true;
            }
            
            // Show consequence
            if (choice.consequence) {
                showConsequence(choice.consequence);
            }
            
            updateStats();
            
            setTimeout(() => {
                nextDialogue();
            }, choice.consequence ? 2000 : 500);
        }
        
        function showConsequence(text) {
            const indicator = document.createElement('div');
            indicator.className = 'consequence-indicator';
            indicator.textContent = text;
            document.body.appendChild(indicator);
            
            setTimeout(() => {
                document.body.removeChild(indicator);
            }, 2000);
        }
        
        function nextDialogue() {
            currentDialogue++;
            
            const act = acts[currentAct];
            const chapter = act.chapters[currentChapter];
            
            if (currentDialogue >= chapter.dialogues.length) {
                // Move to next chapter
                currentChapter++;
                currentDialogue = 0;
                
                if (!act.chapters[currentChapter]) {
                    // Move to next act
                    currentAct++;
                    currentChapter = 1;
                    
                    if (!acts[currentAct]) {
                        // Game completed
                        showEnding();
                        return;
                    }
                }
                
                updateChapterInfo();
            }
            
            showDialogue();
        }
        
        function updateStats() {
            for (let stat in gameStats) {
                const element = document.getElementById(stat);
                if (element) {
                    element.textContent = gameStats[stat];
                    
                    // Color coding for stats
                    if (gameStats[stat] >= 80) {
                        element.style.color = '#2ecc71';
                    } else if (gameStats[stat] >= 50) {
                        element.style.color = '#4ecdc4';
                    } else if (gameStats[stat] >= 30) {
                        element.style.color = '#f39c12';
                    } else {
                        element.style.color = '#e74c3c';
                    }
                }
            }
        }
        
        function showEnding() {
            // Calculate ending based on stats and memories
            let ending = determineEnding();
            
            document.getElementById('speakerName').textContent = 'K·∫øt th√∫c';
            document.getElementById('dialogueText').textContent = ending.text;
            document.getElementById('choices').innerHTML = '';
            
            const restartBtn = document.createElement('button');
            restartBtn.className = 'choice-btn';
            restartBtn.textContent = 'üîÑ Ch∆°i l·∫°i v·ªõi l·ª±a ch·ªçn kh√°c';
            restartBtn.onclick = () => location.reload();
            document.getElementById('choices').appendChild(restartBtn);
            
            document.getElementById('continueBtn').classList.add('hidden');
        }
        
        function determineEnding() {
            // This is just the beginning - more complex ending logic will be added
            if (gameStats.addiction >= 20) {
                return {
                    type: 'addiction_path',
                    text: 'An ƒë√£ b∆∞·ªõc v√†o con ƒë∆∞·ªùng nghi·ªán ng·∫≠p... ƒê√¢y ch·ªâ l√† kh·ªüi ƒë·∫ßu c·ªßa m·ªôt h√†nh tr√¨nh ƒë·∫ßy th·ª≠ th√°ch. H√£y ch∆°i l·∫°i ƒë·ªÉ kh√°m ph√° nh·ªØng con ƒë∆∞·ªùng kh√°c!'
                };
            } else if (gameStats.reputation >= 80) {
                return {
                    type: 'good_student',
                    text: 'An ƒë√£ gi·ªØ ƒë∆∞·ª£c danh ti·∫øng t·ªët v√† t·∫≠p trung v√†o h·ªçc t·∫≠p. T∆∞∆°ng lai t∆∞∆°i s√°ng ƒëang ch·ªù ƒë·ª£i! Nh∆∞ng c√¢u chuy·ªán v·∫´n c√≤n d√†i...'
                };
            } else {
                return {
                    type: 'balanced',
                    text: 'An ƒë√£ c·ªë g·∫Øng c√¢n b·∫±ng gi·ªØa c√°c m·ªëi quan h·ªá v√† h·ªçc t·∫≠p. Cu·ªôc s·ªëng tu·ªïi 17 kh√¥ng bao gi·ªù ƒë∆°n gi·∫£n... H√†nh tr√¨nh v·∫´n ti·∫øp t·ª•c!'
                };
            }
        }
        
        // Initialize stats display
        updateStats();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96e0cdb7e6c5dd6c',t:'MTc1NTAxMDQyMC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
