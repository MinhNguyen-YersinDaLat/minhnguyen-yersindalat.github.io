<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B·∫£o v·ªá s·ª©c kh·ªèe - N√≥i kh√¥ng v·ªõi thu·ªëc l√°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
        }
        
        .smoke-animation {
            animation: smokeDisappear 3s ease-out forwards;
        }
        
        @keyframes smokeDisappear {
            0% { opacity: 1; transform: translateY(0) scale(1); }
            100% { opacity: 0; transform: translateY(-50px) scale(1.2); }
        }
        
        .organ-glow {
            animation: glow 2s ease-in-out infinite alternate;
        }
        
        @keyframes glow {
            from { box-shadow: 0 0 20px rgba(59, 130, 246, 0.5); }
            to { box-shadow: 0 0 30px rgba(59, 130, 246, 0.8); }
        }
        
        .character {
            transition: all 0.3s ease;
            z-index: 10;
            filter: drop-shadow(0 4px 12px rgba(0, 0, 0, 0.15));
            animation: characterFloat 3s ease-in-out infinite;
        }
        
        .character:hover {
            transform: scale(1.2) rotate(5deg);
            filter: drop-shadow(0 8px 20px rgba(59, 130, 246, 0.4));
        }
        
        .character.moving {
            transition: all 0.5s ease;
            animation: characterWalk 0.5s ease-in-out;
        }
        
        @keyframes characterFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-8px); }
        }
        
        @keyframes characterWalk {
            0% { transform: scale(1) rotate(0deg); }
            25% { transform: scale(1.1) rotate(-3deg); }
            75% { transform: scale(1.1) rotate(3deg); }
            100% { transform: scale(1) rotate(0deg); }
        }
        
        .game-area-animated {
            position: relative;
            overflow: hidden;
        }
        
        .game-area-animated::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, 
                transparent 30%, 
                rgba(255, 255, 255, 0.1) 50%, 
                transparent 70%);
            animation: gameAreaShimmer 8s ease-in-out infinite;
            pointer-events: none;
            z-index: 1;
        }
        
        @keyframes gameAreaShimmer {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            50% { transform: translateX(0%) translateY(0%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }
        
        @keyframes particleFade {
            0% { 
                opacity: 1; 
                transform: scale(1) translateY(0px); 
            }
            100% { 
                opacity: 0; 
                transform: scale(0.3) translateY(-20px); 
            }
        }
        
        .organ-interactive {
            position: relative;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 20px;
            padding: 8px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        .organ-interactive.near-character {
            transform: scale(1.5) rotate(8deg) translateY(-10px);
            filter: drop-shadow(0 0 40px rgba(59, 130, 246, 1)) drop-shadow(0 0 80px rgba(59, 130, 246, 0.8));
            animation: organGlow 1.2s ease-in-out infinite alternate;
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.2), rgba(147, 51, 234, 0.1));
            border: 3px solid rgba(59, 130, 246, 0.6);
        }
        
        @keyframes organGlow {
            from { 
                filter: drop-shadow(0 0 40px rgba(59, 130, 246, 1)) drop-shadow(0 0 80px rgba(59, 130, 246, 0.8));
                transform: scale(1.5) rotate(8deg) translateY(-10px);
                box-shadow: 0 20px 60px rgba(59, 130, 246, 0.4);
            }
            to { 
                filter: drop-shadow(0 0 60px rgba(147, 51, 234, 1)) drop-shadow(0 0 120px rgba(59, 130, 246, 1));
                transform: scale(1.55) rotate(-8deg) translateY(-15px);
                box-shadow: 0 25px 80px rgba(147, 51, 234, 0.5);
            }
        }
        
        .organ-interactive:hover {
            transform: scale(1.15) rotate(2deg) translateY(-8px);
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.15);
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.2), rgba(255, 255, 255, 0.1));
            border: 2px solid rgba(255, 255, 255, 0.4);
        }
        
        .organ-sparkle {
            position: absolute;
            width: 8px;
            height: 8px;
            background: radial-gradient(circle, #fff 0%, rgba(59, 130, 246, 0.8) 50%, transparent 100%);
            border-radius: 50%;
            animation: sparkle 2.5s ease-in-out infinite;
            pointer-events: none;
            box-shadow: 0 0 10px rgba(59, 130, 246, 0.6);
        }
        
        @keyframes sparkle {
            0%, 100% { 
                opacity: 0; 
                transform: scale(0) rotate(0deg); 
                box-shadow: 0 0 5px rgba(59, 130, 246, 0.3);
            }
            50% { 
                opacity: 1; 
                transform: scale(1.2) rotate(180deg); 
                box-shadow: 0 0 20px rgba(59, 130, 246, 1);
            }
        }
        
        .interaction-hint {
            position: absolute;
            top: -40px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 14px;
            white-space: nowrap;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .interaction-hint.show {
            opacity: 1;
        }
        
        .popup-enter {
            animation: popupEnter 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        
        @keyframes popupEnter {
            from { 
                opacity: 0; 
                transform: scale(0.5) rotate(-10deg) translateY(50px);
                filter: blur(10px);
            }
            to { 
                opacity: 1; 
                transform: scale(1) rotate(0deg) translateY(0px);
                filter: blur(0px);
            }
        }
        
        .fade-in {
            animation: fadeIn 1s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .slide-up {
            animation: slideUp 0.5s ease-out;
        }
        
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-green-50 min-h-screen">
    <!-- Th√¥ng tin t√°c gi·∫£ c·ªë ƒë·ªãnh -->
    <div class="fixed top-4 left-4 bg-white/90 backdrop-blur-lg rounded-xl p-3 shadow-lg border border-white/20 z-40">
        <div class="text-center">
            <div class="text-sm font-bold text-blue-800">üë®‚Äçüè´ Th·∫ßy Th√°i Minh Nguy√™n</div>
            <div class="text-xs text-gray-600">üè´ THPT Yersin ƒê√† L·∫°t</div>
        </div>
    </div>

    <!-- M√†n h√¨nh ti√™u ƒë·ªÅ -->
    <div id="titleScreen" class="min-h-screen flex flex-col items-center justify-center p-8 relative overflow-hidden">
        <!-- Background hi·ªáu ·ª©ng -->
        <div class="absolute inset-0 bg-gradient-to-br from-blue-400 via-purple-500 to-pink-500 opacity-20"></div>
        <div class="absolute inset-0 bg-[url('data:image/svg+xml,%3Csvg width="60" height="60" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg"%3E%3Cg fill="none" fill-rule="evenodd"%3E%3Cg fill="%23ffffff" fill-opacity="0.1"%3E%3Ccircle cx="30" cy="30" r="2"/%3E%3C/g%3E%3C/g%3E%3C/svg%3E')] animate-pulse"></div>
        
        <div class="text-center max-w-5xl mx-auto relative z-10">
            <!-- Logo v√† ti√™u ƒë·ªÅ n√¢ng c·∫•p -->
            <div class="mb-12 fade-in">
                <!-- Logo v·ªõi hi·ªáu ·ª©ng -->
                <div class="relative mb-6">
                    <div class="text-8xl mb-4 animate-bounce drop-shadow-2xl">üè•</div>
                    <div class="absolute -top-2 -right-2 text-3xl animate-spin">‚ú®</div>
                    <div class="absolute -bottom-2 -left-2 text-2xl animate-pulse">üíö</div>
                </div>
                
                <!-- Ti√™u ƒë·ªÅ ch√≠nh v·ªõi hi·ªáu ·ª©ng gradient ƒë·ªông -->
                <h1 class="text-6xl md:text-7xl font-black bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 bg-clip-text text-transparent mb-6 animate-pulse">
                    B·∫£o v·ªá s·ª©c kh·ªèe
                </h1>
                
                <!-- Ph·ª• ƒë·ªÅ v·ªõi hi·ªáu ·ª©ng -->
                <h2 class="text-3xl md:text-4xl font-bold text-gray-800 mb-8 drop-shadow-lg">
                    üö≠ N√≥i kh√¥ng v·ªõi thu·ªëc l√° üö≠
                </h2>
                
                <!-- M√¥ t·∫£ n√¢ng c·∫•p -->
                <div class="bg-white/95 backdrop-blur-xl rounded-3xl p-8 shadow-2xl border-2 border-white/40 mb-8 max-w-3xl mx-auto transform hover:scale-105 transition-all duration-300">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                        <div class="text-center">
                            <div class="text-4xl mb-2">üéÆ</div>
                            <p class="text-lg font-semibold text-gray-800">Game t∆∞∆°ng t√°c</p>
                            <p class="text-sm text-gray-600">Kh√°m ph√° c∆° th·ªÉ ng∆∞·ªùi</p>
                        </div>
                        <div class="text-center">
                            <div class="text-4xl mb-2">üß†</div>
                            <p class="text-lg font-semibold text-gray-800">H·ªçc ki·∫øn th·ª©c</p>
                            <p class="text-sm text-gray-600">T√°c h·∫°i c·ªßa thu·ªëc l√°</p>
                        </div>
                    </div>
                    
                    <!-- Th√¥ng tin t√°c gi·∫£ n√¢ng c·∫•p -->
                    <div class="pt-6 border-t-2 border-gradient-to-r from-blue-200 to-purple-200">
                        <div class="bg-gradient-to-r from-blue-50 to-purple-50 rounded-2xl p-4">
                            <p class="text-lg font-bold text-blue-800 mb-1">
                                üë®‚Äçüè´ Th·∫ßy Th√°i Minh Nguy√™n
                            </p>
                            <p class="text-sm text-gray-600 flex items-center justify-center">
                                üè´ <span class="ml-1">Tr∆∞·ªùng THPT Yersin ƒê√† L·∫°t</span>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Menu ch√≠nh n√¢ng c·∫•p -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 slide-up max-w-4xl mx-auto">
                <!-- N√∫t b·∫Øt ƒë·∫ßu ch∆°i -->
                <button onclick="showInstructions()" class="group bg-gradient-to-br from-blue-500 via-blue-600 to-purple-700 hover:from-blue-600 hover:via-purple-600 hover:to-pink-700 text-white font-bold py-6 px-8 rounded-2xl shadow-2xl transition-all duration-500 transform hover:scale-110 hover:rotate-1 border-2 border-white/20">
                    <div class="text-5xl mb-3 group-hover:animate-bounce">üéÆ</div>
                    <div class="text-xl mb-2">B·∫Øt ƒë·∫ßu ch∆°i</div>
                    <div class="text-sm opacity-80">Kh√°m ph√° c∆° th·ªÉ</div>
                    <div class="mt-2 w-full h-1 bg-white/30 rounded-full overflow-hidden">
                        <div class="h-full bg-white/60 rounded-full transform -translate-x-full group-hover:translate-x-0 transition-transform duration-700"></div>
                    </div>
                </button>
                
                <!-- N√∫t h∆∞·ªõng d·∫´n -->
                <button onclick="showGuide()" class="group bg-gradient-to-br from-green-500 via-emerald-600 to-teal-700 hover:from-green-600 hover:via-teal-600 hover:to-cyan-700 text-white font-bold py-6 px-8 rounded-2xl shadow-2xl transition-all duration-500 transform hover:scale-110 hover:rotate-1 border-2 border-white/20">
                    <div class="text-5xl mb-3 group-hover:animate-pulse">üìñ</div>
                    <div class="text-xl mb-2">H∆∞·ªõng d·∫´n</div>
                    <div class="text-sm opacity-80">C√°ch ch∆°i game</div>
                    <div class="mt-2 w-full h-1 bg-white/30 rounded-full overflow-hidden">
                        <div class="h-full bg-white/60 rounded-full transform -translate-x-full group-hover:translate-x-0 transition-transform duration-700"></div>
                    </div>
                </button>
                
                <!-- N√∫t quiz -->
                <button onclick="startQuizDirect()" class="group bg-gradient-to-br from-purple-500 via-indigo-600 to-blue-700 hover:from-purple-600 hover:via-indigo-700 hover:to-blue-800 text-white font-bold py-6 px-8 rounded-2xl shadow-2xl transition-all duration-500 transform hover:scale-110 hover:rotate-1 border-2 border-white/20">
                    <div class="text-5xl mb-3 group-hover:animate-bounce">üß†</div>
                    <div class="text-xl mb-2">Quiz</div>
                    <div class="text-sm opacity-80">Ki·ªÉm tra ki·∫øn th·ª©c</div>
                    <div class="mt-2 w-full h-1 bg-white/30 rounded-full overflow-hidden">
                        <div class="h-full bg-white/60 rounded-full transform -translate-x-full group-hover:translate-x-0 transition-transform duration-700"></div>
                    </div>
                </button>
            </div>
            
            <!-- Menu ph·ª• -->
            <div class="mt-8 flex justify-center">
                <button onclick="showInfo()" class="text-white/70 hover:text-white text-sm underline transition-colors">
                    ‚ÑπÔ∏è Th√¥ng tin v·ªÅ d·ª± √°n
                </button>
            </div>
            
            <!-- Th·ªëng k√™ nhanh -->
            <div class="mt-12 grid grid-cols-2 md:grid-cols-4 gap-4 max-w-3xl mx-auto">
                <div class="bg-white/80 backdrop-blur-lg rounded-xl p-4 text-center shadow-lg">
                    <div class="text-2xl font-bold text-blue-600">8</div>
                    <div class="text-sm text-gray-600">C∆° quan</div>
                </div>
                <div class="bg-white/80 backdrop-blur-lg rounded-xl p-4 text-center shadow-lg">
                    <div class="text-2xl font-bold text-green-600">25+</div>
                    <div class="text-sm text-gray-600">Ch·∫•t ƒë·ªôc</div>
                </div>
                <div class="bg-white/80 backdrop-blur-lg rounded-xl p-4 text-center shadow-lg">
                    <div class="text-2xl font-bold text-purple-600">100%</div>
                    <div class="text-sm text-gray-600">T∆∞∆°ng t√°c</div>
                </div>
                <div class="bg-white/80 backdrop-blur-lg rounded-xl p-4 text-center shadow-lg">
                    <div class="text-2xl font-bold text-red-600">0</div>
                    <div class="text-sm text-gray-600">Thu·ªëc l√°</div>
                </div>
            </div>
        </div>
    </div>

    <!-- M√†n h√¨nh h∆∞·ªõng d·∫´n -->
    <div id="instructionScreen" class="hidden min-h-screen flex flex-col items-center justify-center p-6 relative overflow-hidden">
        <div class="bg-white/95 backdrop-blur-lg rounded-2xl shadow-xl p-8 max-w-3xl mx-auto border border-white/20 relative z-10">
            <!-- Header ƒë∆°n gi·∫£n -->
            <div class="text-center mb-8">
                <h2 class="text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent mb-4">
                    H∆∞·ªõng d·∫´n
                </h2>
                <p class="text-gray-600">ƒê∆°n gi·∫£n v√† d·ªÖ hi·ªÉu!</p>
            </div>
            
            <!-- N·ªôi dung ch√≠nh g·ªçn g√†ng -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                <!-- M·ª•c ti√™u -->
                <div class="bg-blue-50 p-6 rounded-xl border border-blue-200">
                    <div class="text-center mb-4">
                        <div class="text-4xl mb-2">üéØ</div>
                        <h3 class="font-bold text-blue-800 text-lg">M·ª•c ti√™u</h3>
                    </div>
                    <p class="text-gray-700 text-center">Kh√°m ph√° <span class="font-bold text-blue-600">8 c∆° quan</span> v√† t√¨m hi·ªÉu t√°c h·∫°i c·ªßa thu·ªëc l√°</p>
                </div>

                <!-- ƒêi·ªÅu khi·ªÉn -->
                <div class="bg-green-50 p-6 rounded-xl border border-green-200">
                    <div class="text-center mb-4">
                        <div class="text-4xl mb-2">üïπÔ∏è</div>
                        <h3 class="font-bold text-green-800 text-lg">ƒêi·ªÅu khi·ªÉn</h3>
                    </div>
                    <div class="space-y-2 text-center">
                        <div class="flex items-center justify-center space-x-2">
                            <span class="bg-white px-2 py-1 rounded text-sm">‚¨ÖÔ∏è‚û°Ô∏è‚¨ÜÔ∏è‚¨áÔ∏è</span>
                            <span class="text-gray-700 text-sm">Di chuy·ªÉn</span>
                        </div>
                        <div class="flex items-center justify-center space-x-2">
                            <span class="bg-white px-2 py-1 rounded text-sm font-bold">SPACE</span>
                            <span class="text-gray-700 text-sm">T∆∞∆°ng t√°c</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- C√°ch ch∆°i ƒë∆°n gi·∫£n -->
            <div class="bg-purple-50 rounded-xl p-6 mb-8 border border-purple-200">
                <div class="text-center">
                    <div class="text-3xl mb-2">‚ú®</div>
                    <h3 class="font-bold text-purple-800 text-lg mb-3">C√°ch ch∆°i</h3>
                    <div class="flex items-center justify-center space-x-2 text-sm">
                        <span class="bg-purple-200 text-purple-800 px-2 py-1 rounded">ƒê·∫øn g·∫ßn c∆° quan</span>
                        <span>‚Üí</span>
                        <span class="bg-pink-200 text-pink-800 px-2 py-1 rounded">Nh·∫•n SPACE</span>
                        <span>‚Üí</span>
                        <span class="bg-green-200 text-green-800 px-2 py-1 rounded">ƒê·ªçc th√¥ng tin</span>
                    </div>
                </div>
            </div>
            
            <!-- N√∫t h√†nh ƒë·ªông -->
            <div class="flex flex-col items-center gap-4">
                <button onclick="startGame()" class="bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white font-bold py-4 px-10 rounded-2xl shadow-2xl transition-all duration-300 transform hover:scale-110 text-xl">
                    üöÄ B·∫ÆT ƒê·∫¶U CH∆†I NGAY!
                </button>
                <button onclick="backToTitle()" class="bg-white hover:bg-gray-50 text-gray-700 font-semibold py-3 px-6 rounded-xl transition-all duration-300 border border-gray-300 shadow-md">
                    ‚Üê Quay l·∫°i menu
                </button>
            </div>
        </div>
    </div>

    <!-- Ph·∫ßn ch∆°i ch√≠nh -->
    <div id="gameScreen" class="hidden min-h-screen p-8">

        <!-- B·∫£n ƒë·ªì c∆° th·ªÉ -->
        <div class="max-w-5xl mx-auto">
            <div id="gameArea" class="relative bg-gradient-to-br from-blue-50 via-purple-50 to-green-50 rounded-3xl p-8 overflow-hidden shadow-2xl border-4 border-white game-area-animated" style="height: 480px;">
                <!-- Nh√¢n v·∫≠t ƒëi·ªÅu khi·ªÉn -->
                <div id="character" class="character absolute text-6xl cursor-pointer select-none drop-shadow-lg" style="left: 30px; top: 420px; transition: all 0.3s ease;">
                    ü¶∏
                </div>

                <!-- H√†ng 1 (Tr√™n) - 3 c∆° quan -->
                <!-- N√£o -->
                <div id="brain-organ" class="organ-interactive absolute cursor-pointer transition-all duration-500 text-center transform hover:scale-125" style="left: 150px; top: 20px; width: 140px; height: 120px;">
                    <div class="text-7xl mb-2 animate-pulse drop-shadow-lg">üß†</div>
                    <h3 class="text-sm font-bold text-purple-900 bg-white/80 rounded-lg px-2 py-1 shadow-md">N√£o</h3>
                    <p class="text-purple-700 text-xs font-medium bg-white/60 rounded px-1 mt-1">Trung t√¢m ƒëi·ªÅu khi·ªÉn</p>
                    <div class="interaction-hint bg-purple-800">Nh·∫•n SPACE ƒë·ªÉ t∆∞∆°ng t√°c</div>
                    <div class="organ-sparkle" style="top: 15%; left: 20%; animation-delay: 0s;"></div>
                    <div class="organ-sparkle" style="top: 25%; right: 15%; animation-delay: 0.7s;"></div>
                    <div class="organ-sparkle" style="bottom: 30%; left: 30%; animation-delay: 1.4s;"></div>
                </div>

                <!-- H·ªá mi·ªÖn d·ªãch -->
                <div id="immune-organ" class="organ-interactive absolute cursor-pointer transition-all duration-500 text-center transform hover:scale-125" style="left: 380px; top: 20px; width: 140px; height: 120px;">
                    <div class="text-7xl mb-2 animate-bounce drop-shadow-lg">üõ°Ô∏è</div>
                    <h3 class="text-sm font-bold text-yellow-900 bg-white/80 rounded-lg px-2 py-1 shadow-md">Mi·ªÖn d·ªãch</h3>
                    <p class="text-yellow-700 text-xs font-medium bg-white/60 rounded px-1 mt-1">L√° ch·∫Øn b·∫£o v·ªá</p>
                    <div class="interaction-hint bg-yellow-800">Nh·∫•n SPACE ƒë·ªÉ t∆∞∆°ng t√°c</div>
                    <div class="organ-sparkle" style="top: 20%; left: 25%; animation-delay: 0.3s;"></div>
                    <div class="organ-sparkle" style="top: 30%; right: 20%; animation-delay: 1s;"></div>
                    <div class="organ-sparkle" style="bottom: 35%; left: 35%; animation-delay: 1.7s;"></div>
                </div>

                <!-- Da -->
                <div id="skin-organ" class="organ-interactive absolute cursor-pointer transition-all duration-500 text-center transform hover:scale-125" style="left: 610px; top: 20px; width: 140px; height: 120px;">
                    <div class="text-7xl mb-2 animate-pulse drop-shadow-lg">üå∏</div>
                    <h3 class="text-sm font-bold text-pink-900 bg-white/80 rounded-lg px-2 py-1 shadow-md">Da</h3>
                    <p class="text-pink-700 text-xs font-medium bg-white/60 rounded px-1 mt-1">L·ªõp b·∫£o v·ªá</p>
                    <div class="interaction-hint bg-pink-800">Nh·∫•n SPACE ƒë·ªÉ t∆∞∆°ng t√°c</div>
                    <div class="organ-sparkle" style="top: 18%; left: 30%; animation-delay: 0.6s;"></div>
                    <div class="organ-sparkle" style="top: 35%; right: 25%; animation-delay: 1.3s;"></div>
                    <div class="organ-sparkle" style="bottom: 32%; left: 40%; animation-delay: 2s;"></div>
                </div>

                <!-- H√†ng 2 (Gi·ªØa) - 3 c∆° quan -->
                <!-- Tim -->
                <div id="heart-organ" class="organ-interactive absolute cursor-pointer transition-all duration-500 text-center transform hover:scale-125" style="left: 150px; top: 170px; width: 140px; height: 120px;">
                    <div class="text-7xl mb-2 animate-pulse drop-shadow-lg" style="animation-duration: 1s;">‚ù§Ô∏è</div>
                    <h3 class="text-sm font-bold text-red-900 bg-white/80 rounded-lg px-2 py-1 shadow-md">Tim</h3>
                    <p class="text-red-700 text-xs font-medium bg-white/60 rounded px-1 mt-1">Trung t√¢m tu·∫ßn ho√†n</p>
                    <div class="interaction-hint bg-red-800">Nh·∫•n SPACE ƒë·ªÉ t∆∞∆°ng t√°c</div>
                    <div class="organ-sparkle" style="top: 22%; left: 28%; animation-delay: 0.2s;"></div>
                    <div class="organ-sparkle" style="top: 40%; right: 22%; animation-delay: 0.9s;"></div>
                    <div class="organ-sparkle" style="bottom: 28%; left: 38%; animation-delay: 1.6s;"></div>
                </div>

                <!-- Ph·ªïi -->
                <div id="lungs-organ" class="organ-interactive absolute cursor-pointer transition-all duration-500 text-center transform hover:scale-125" style="left: 380px; top: 170px; width: 140px; height: 120px;">
                    <div class="text-7xl mb-2 animate-pulse drop-shadow-lg" style="animation-duration: 2s;">ü´Å</div>
                    <h3 class="text-sm font-bold text-blue-900 bg-white/80 rounded-lg px-2 py-1 shadow-md">Ph·ªïi</h3>
                    <p class="text-blue-700 text-xs font-medium bg-white/60 rounded px-1 mt-1">H·ªá h√¥ h·∫•p</p>
                    <div class="interaction-hint bg-blue-800">Nh·∫•n SPACE ƒë·ªÉ t∆∞∆°ng t√°c</div>
                    <div class="organ-sparkle" style="top: 25%; left: 32%; animation-delay: 0.5s;"></div>
                    <div class="organ-sparkle" style="top: 38%; right: 28%; animation-delay: 1.2s;"></div>
                    <div class="organ-sparkle" style="bottom: 30%; left: 42%; animation-delay: 1.9s;"></div>
                </div>

                <!-- D·∫° d√†y -->
                <div id="stomach-organ" class="organ-interactive absolute cursor-pointer transition-all duration-500 text-center transform hover:scale-125" style="left: 610px; top: 170px; width: 140px; height: 120px;">
                    <div class="text-7xl mb-2 animate-bounce drop-shadow-lg" style="animation-duration: 1.5s;">ü•ó</div>
                    <h3 class="text-sm font-bold text-orange-900 bg-white/80 rounded-lg px-2 py-1 shadow-md">D·∫° d√†y</h3>
                    <p class="text-orange-700 text-xs font-medium bg-white/60 rounded px-1 mt-1">Ti√™u h√≥a th·ª©c ƒÉn</p>
                    <div class="interaction-hint bg-orange-800">Nh·∫•n SPACE ƒë·ªÉ t∆∞∆°ng t√°c</div>
                    <div class="organ-sparkle" style="top: 28%; left: 26%; animation-delay: 0.8s;"></div>
                    <div class="organ-sparkle" style="top: 42%; right: 30%; animation-delay: 1.5s;"></div>
                    <div class="organ-sparkle" style="bottom: 34%; left: 36%; animation-delay: 2.2s;"></div>
                </div>

                <!-- H√†ng 3 (D∆∞·ªõi) - 2 c∆° quan ·ªü gi·ªØa -->
                <!-- Gan -->
                <div id="liver-organ" class="organ-interactive absolute cursor-pointer transition-all duration-500 text-center transform hover:scale-125" style="left: 265px; top: 320px; width: 140px; height: 120px;">
                    <div class="text-7xl mb-2 animate-pulse drop-shadow-lg" style="animation-duration: 1.8s;">üçÄ</div>
                    <h3 class="text-sm font-bold text-green-900 bg-white/80 rounded-lg px-2 py-1 shadow-md">Gan</h3>
                    <p class="text-green-700 text-xs font-medium bg-white/60 rounded px-1 mt-1">Nh√† m√°y x·ª≠ l√Ω</p>
                    <div class="interaction-hint bg-green-800">Nh·∫•n SPACE ƒë·ªÉ t∆∞∆°ng t√°c</div>
                    <div class="organ-sparkle" style="top: 24%; left: 34%; animation-delay: 0.4s;"></div>
                    <div class="organ-sparkle" style="top: 36%; right: 26%; animation-delay: 1.1s;"></div>
                    <div class="organ-sparkle" style="bottom: 36%; left: 44%; animation-delay: 1.8s;"></div>
                </div>

                <!-- Th·∫≠n -->
                <div id="kidney-organ" class="organ-interactive absolute cursor-pointer transition-all duration-500 text-center transform hover:scale-125" style="left: 495px; top: 320px; width: 140px; height: 120px;">
                    <div class="text-7xl mb-2 animate-bounce drop-shadow-lg" style="animation-duration: 2.2s;">üíß</div>
                    <h3 class="text-sm font-bold text-cyan-900 bg-white/80 rounded-lg px-2 py-1 shadow-md">Th·∫≠n</h3>
                    <p class="text-cyan-700 text-xs font-medium bg-white/60 rounded px-1 mt-1">B·ªô l·ªçc m√°u</p>
                    <div class="interaction-hint bg-cyan-800">Nh·∫•n SPACE ƒë·ªÉ t∆∞∆°ng t√°c</div>
                    <div class="organ-sparkle" style="top: 26%; left: 38%; animation-delay: 0.7s;"></div>
                    <div class="organ-sparkle" style="top: 44%; right: 32%; animation-delay: 1.4s;"></div>
                    <div class="organ-sparkle" style="bottom: 38%; left: 48%; animation-delay: 2.1s;"></div>
                </div>

                <!-- ƒê∆∞·ªùng vi·ªÅn trang tr√≠ -->
                <div class="absolute inset-4 border-2 border-dashed border-blue-200 rounded-2xl opacity-30 pointer-events-none"></div>
                
                <!-- Hi·ªáu ·ª©ng √°nh s√°ng -->
                <div class="absolute top-0 left-0 w-full h-full bg-gradient-to-br from-white/20 via-transparent to-transparent pointer-events-none rounded-3xl"></div>
            </div>

            <!-- Thanh ti·∫øn ƒë·ªô -->
            <div class="mt-8 bg-white/90 backdrop-blur-lg rounded-2xl p-6 shadow-2xl border border-white/20">
                <div class="flex justify-between items-center mb-4">
                    <span class="font-bold text-gray-800 text-lg flex items-center">
                        üéØ <span class="ml-2">Ti·∫øn ƒë·ªô kh√°m ph√°</span>
                    </span>
                    <span id="progressText" class="text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">0/8</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-4 overflow-hidden shadow-inner">
                    <div id="progressBar" class="bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 h-4 rounded-full transition-all duration-700 ease-out relative overflow-hidden" style="width: 0%">
                        <div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent animate-pulse"></div>
                    </div>
                </div>
                <div class="mt-2 text-center text-sm text-gray-600">
                    <span class="animate-pulse">‚ú® Kh√°m ph√° ƒë·ªÉ m·ªü kh√≥a ki·∫øn th·ª©c m·ªõi! ‚ú®</span>
                </div>
            </div>

            <!-- N√∫t ti·∫øp t·ª•c (·∫©n ban ƒë·∫ßu) -->
            <div id="continueButton" class="hidden text-center mt-8">
                <button onclick="completePart1()" class="bg-green-600 hover:bg-green-700 text-white font-bold py-4 px-8 rounded-xl shadow-lg transition-all duration-300 transform hover:scale-105">
                    üéâ Ho√†n th√†nh ph·∫ßn 1 ‚Üí Ti·∫øp t·ª•c
                </button>
            </div>
        </div>
        

    </div>

    <!-- Popup tr√≤ chuy·ªán d·ªÖ th∆∞∆°ng -->
    <div id="organPopup" class="hidden fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-2xl shadow-2xl max-w-lg w-full popup-enter border-2 border-blue-200">
            <!-- Header ƒë∆°n gi·∫£n -->
            <div class="bg-gradient-to-r from-blue-500 to-purple-500 p-4 rounded-t-2xl text-white">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-2">
                        <div class="text-2xl animate-bounce">ü¶∏</div>
                        <h2 class="text-lg font-bold">Kh√°m ph√° c∆° th·ªÉ</h2>
                    </div>
                    <button onclick="closeOrganPopup()" class="text-white hover:text-red-200 text-xl transition-colors">
                        ‚úï
                    </button>
                </div>
            </div>
            
            <!-- N·ªôi dung ch√≠nh g·ªçn -->
            <div id="organContent" class="p-6">
                <!-- N·ªôi dung s·∫Ω ƒë∆∞·ª£c th√™m b·∫±ng JavaScript -->
            </div>
            
            <!-- Footer ƒë∆°n gi·∫£n -->
            <div class="p-4 bg-gray-50 rounded-b-2xl border-t">
                <div class="flex items-center justify-between">
                    <div class="text-sm text-gray-500">
                        üí° Nh·∫•n Space ƒë·ªÉ ti·∫øp t·ª•c
                    </div>
                    <button id="dialogueButton" onclick="nextDialogue()" class="bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600 text-white font-semibold py-2 px-6 rounded-lg transition-all duration-300 transform hover:scale-105">
                        Ti·∫øp t·ª•c ‚Üí
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- M√†n h√¨nh k·∫øt th√∫c ph·∫ßn 1 -->
    <div id="part1Complete" class="hidden min-h-screen flex flex-col items-center justify-center p-8 relative">
        <div class="bg-white rounded-2xl shadow-2xl p-8 max-w-4xl mx-auto text-center">
            <div class="text-6xl mb-6">üéâ</div>
            <h2 class="text-3xl font-bold text-green-800 mb-4">Ch√∫c m·ª´ng!</h2>
            <p class="text-xl text-gray-700 mb-8">
                B·∫°n ƒë√£ kh√°m ph√° vai tr√≤ quan tr·ªçng c·ªßa c√°c c∆° quan s·ªëng c√≤n. 
                H√£y b·∫£o v·ªá ch√∫ng b·∫±ng c√°ch tr√°nh xa thu·ªëc l√°!
            </p>
            <div class="bg-green-50 p-6 rounded-xl mb-8">
                <h3 class="text-lg font-semibold text-green-800 mb-2">ƒêi·ªÉm s·ªë ph·∫ßn 1:</h3>
                <div class="text-3xl font-bold text-green-600" id="part1Score">100/100</div>
            </div>
            <button onclick="startPart2()" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 px-8 rounded-xl shadow-lg transition-all duration-300 transform hover:scale-105">
                üöÄ B·∫Øt ƒë·∫ßu ph·∫ßn 2
            </button>
        </div>
        

    </div>

    <!-- M√†n h√¨nh m·ªü ƒë·∫ßu ph·∫ßn 2 -->
    <div id="part2Intro" class="hidden min-h-screen flex flex-col items-center justify-center p-6 relative overflow-hidden">
        <!-- Background -->
        <div class="absolute inset-0 bg-gradient-to-br from-purple-600 via-blue-600 to-indigo-800 opacity-95"></div>
        <div class="absolute inset-0 bg-[url('data:image/svg+xml,%3Csvg width="40" height="40" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg"%3E%3Cg fill="none" fill-rule="evenodd"%3E%3Cg fill="%23ffffff" fill-opacity="0.1"%3E%3Cpath d="M20 20c0-5.5-4.5-10-10-10s-10 4.5-10 10 4.5 10 10 10 10-4.5 10-10z"/%3E%3C/g%3E%3C/g%3E%3C/svg%3E')] animate-pulse"></div>
        
        <div class="relative z-10 text-center max-w-3xl mx-auto">
            <!-- Header g·ªçn -->
            <div class="mb-8">
                <div class="flex items-center justify-center mb-4">
                    <div class="text-5xl animate-bounce mr-2">ü¶∏‚Äç‚ôÇÔ∏è</div>
                    <div class="text-3xl animate-pulse">‚öîÔ∏è</div>
                    <div class="text-5xl animate-bounce ml-2">ü¶†</div>
                </div>
                <h1 class="text-3xl font-bold bg-gradient-to-r from-yellow-300 via-orange-300 to-red-400 bg-clip-text text-transparent mb-2">
                    Nhi·ªám v·ª• b·∫£o v·ªá c∆° th·ªÉ!
                </h1>
                <p class="text-white/90">Ti√™u di·ªát c√°c ch·∫•t ƒë·ªôc h·∫°i t·ª´ thu·ªëc l√°</p>
            </div>
            
            <!-- Th√¥ng tin c∆° b·∫£n -->
            <div class="bg-white/10 backdrop-blur-lg rounded-xl p-4 mb-6 border border-white/20">
                <div class="grid grid-cols-3 gap-3 text-center text-sm">
                    <div class="bg-red-500/20 rounded-lg p-3 border border-red-400/30">
                        <div class="text-2xl mb-1">üéØ</div>
                        <div class="font-bold text-white">M·ª•c ti√™u</div>
                        <div class="text-red-200 text-xs">B·∫Øn h·∫° ch·∫•t ƒë·ªôc</div>
                    </div>
                    <div class="bg-blue-500/20 rounded-lg p-3 border border-blue-400/30">
                        <div class="text-2xl mb-1">üïπÔ∏è</div>
                        <div class="font-bold text-white">ƒêi·ªÅu khi·ªÉn</div>
                        <div class="text-blue-200 text-xs">‚¨ÖÔ∏è‚û°Ô∏è + SPACE</div>
                    </div>
                    <div class="bg-green-500/20 rounded-lg p-3 border border-green-400/30">
                        <div class="text-2xl mb-1">‚ù§Ô∏è</div>
                        <div class="font-bold text-white">S·ª©c kh·ªèe</div>
                        <div class="text-green-200 text-xs">3 c∆° quan</div>
                    </div>
                </div>
            </div>
            
            <!-- K·∫ª th√π g·ªçn -->
            <div class="bg-black/20 backdrop-blur-lg rounded-xl p-4 mb-8 border border-white/20">
                <h3 class="text-white font-bold mb-3 flex items-center justify-center">
                    <span class="text-xl mr-2">‚ö†Ô∏è</span>
                    K·∫ª th√π c·∫ßn ti√™u di·ªát
                </h3>
                <div class="grid grid-cols-3 gap-2 text-xs">
                    <div class="bg-purple-600/30 rounded-lg p-2 border border-purple-400/40">
                        <div class="text-lg mb-1">üß™</div>
                        <div class="font-semibold text-white text-xs">G√¢y ung th∆∞</div>
                    </div>
                    <div class="bg-yellow-600/30 rounded-lg p-2 border border-yellow-400/40">
                        <div class="text-lg mb-1">‚ö°</div>
                        <div class="font-semibold text-white text-xs">ƒê·ªôc th·∫ßn kinh</div>
                    </div>
                    <div class="bg-gray-600/30 rounded-lg p-2 border border-gray-400/40">
                        <div class="text-lg mb-1">üå´Ô∏è</div>
                        <div class="font-semibold text-white text-xs">Ph√° h·ªßy ph·ªïi</div>
                    </div>
                </div>
            </div>
            
            <!-- N√∫t t√™n l·ª≠a ·ªü gi·ªØa -->
            <div class="flex flex-col items-center gap-6">
                <button onclick="startPart2Game()" class="rocket-button relative bg-gradient-to-t from-red-600 via-orange-500 to-yellow-400 hover:from-red-700 hover:via-orange-600 hover:to-yellow-500 text-white font-bold py-10 px-16 rounded-full shadow-2xl transition-all duration-300 transform hover:scale-115 hover:-translate-y-3 border-4 border-white/30 group">
                    <!-- Th√¢n t√™n l·ª≠a -->
                    <div class="flex flex-col items-center">
                        <div class="text-6xl mb-3 group-hover:animate-bounce">üöÄ</div>
                        <div class="text-2xl font-black mb-1">B·∫ÆT ƒê·∫¶U</div>
                        <div class="text-lg opacity-90">NHI·ªÜM V·ª§</div>
                    </div>
                    
                    <!-- Hi·ªáu ·ª©ng l·ª≠a -->
                    <div class="absolute -bottom-6 left-1/2 transform -translate-x-1/2 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                        <div class="flex space-x-1">
                            <div class="w-3 h-8 bg-gradient-to-t from-red-500 to-orange-400 rounded-full animate-pulse"></div>
                            <div class="w-3 h-10 bg-gradient-to-t from-orange-500 to-yellow-400 rounded-full animate-pulse" style="animation-delay: 0.1s;"></div>
                            <div class="w-3 h-8 bg-gradient-to-t from-red-500 to-orange-400 rounded-full animate-pulse" style="animation-delay: 0.2s;"></div>
                        </div>
                    </div>
                    
                    <!-- Hi·ªáu ·ª©ng √°nh s√°ng -->
                    <div class="absolute inset-0 rounded-full bg-gradient-to-t from-transparent via-white/10 to-white/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                </button>
                
                <button onclick="backToTitle()" class="text-white/70 hover:text-white text-sm underline transition-colors">
                    ‚Üê Quay l·∫°i menu ch√≠nh
                </button>
            </div>
        </div>
    </div>

    <!-- M√†n h√¨nh ph·∫ßn 2 - Game b·∫Øn s√∫ng -->
    <div id="part2Screen" class="hidden min-h-screen p-4 bg-gradient-to-b from-purple-900 via-blue-900 to-black relative overflow-hidden">
        <!-- Background hi·ªáu ·ª©ng -->
        <div class="absolute inset-0 bg-[url('data:image/svg+xml,%3Csvg width="40" height="40" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg"%3E%3Cg fill="none" fill-rule="evenodd"%3E%3Cg fill="%23ffffff" fill-opacity="0.05"%3E%3Ccircle cx="20" cy="20" r="1"/%3E%3C/g%3E%3C/g%3E%3C/svg%3E')] animate-pulse"></div>
        
        <!-- Header game ƒë∆°n gi·∫£n -->
        <div class="relative z-10 mb-6">
            <div class="bg-black/50 backdrop-blur-lg rounded-2xl p-4 max-w-4xl mx-auto border border-white/20">
                <div class="flex flex-col md:flex-row justify-between items-center gap-4">
                    <!-- Ti√™u ƒë·ªÅ -->
                    <div class="text-center md:text-left">
                        <h2 class="text-2xl md:text-3xl font-bold bg-gradient-to-r from-yellow-400 to-red-500 bg-clip-text text-transparent">
                            ü¶∏‚Äç‚ôÇÔ∏è Si√™u nh√¢n b·∫£o v·ªá s·ª©c kh·ªèe
                        </h2>
                        <p class="text-white/80 text-sm">Ti√™u di·ªát c√°c ch·∫•t ƒë·ªôc h·∫°i!</p>
                    </div>
                    
                    <!-- Th·ªëng k√™ game -->
                    <div class="flex gap-4 text-center">
                        <div class="bg-red-500/20 rounded-lg p-3 border border-red-500/30">
                            <div class="text-red-400 text-xs mb-1">M√°u</div>
                            <div id="healthDisplay" class="text-white font-bold text-lg">‚ù§Ô∏èüß†ü´Å</div>
                        </div>
                        <div class="bg-yellow-500/20 rounded-lg p-3 border border-yellow-500/30">
                            <div class="text-yellow-400 text-xs mb-1">ƒêi·ªÉm</div>
                            <div id="scoreDisplay" class="text-white font-bold text-lg">0</div>
                        </div>
                        <div class="bg-blue-500/20 rounded-lg p-3 border border-blue-500/30">
                            <div class="text-blue-400 text-xs mb-1">Level</div>
                            <div id="levelDisplay" class="text-white font-bold text-lg">1</div>
                        </div>
                    </div>
                    
                    <!-- N√∫t ƒëi·ªÅu khi·ªÉn -->
                    <div class="flex gap-2">
                        <button id="pauseButton" onclick="togglePause()" class="bg-yellow-500 hover:bg-yellow-600 text-black font-bold py-2 px-4 rounded-lg transition-all duration-300">
                            ‚è∏Ô∏è T·∫°m d·ª´ng
                        </button>
                        <button onclick="backToStart()" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                            üè† Menu
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Khu v·ª±c ch∆°i game -->
        <div class="relative z-10 max-w-4xl mx-auto">
            <div id="gameCanvas" class="relative bg-gradient-to-b from-blue-900/30 to-purple-900/30 rounded-2xl overflow-hidden border-2 border-white/20 backdrop-blur-sm" style="height: 500px;">
                <!-- Nh√¢n v·∫≠t si√™u nh√¢n -->
                <div id="hero" class="absolute text-6xl transition-all duration-100 z-20" style="left: 50%; bottom: 20px; transform: translateX(-50%);">
                    ü¶∏‚Äç‚ôÇÔ∏è
                </div>
                
                <!-- Container cho ƒë·∫°n -->
                <div id="bulletsContainer" class="absolute inset-0 pointer-events-none z-15"></div>
                
                <!-- Container cho ch·∫•t ƒë·ªôc -->
                <div id="toxinsContainer" class="absolute inset-0 pointer-events-none z-10"></div>
                
                <!-- Container cho hi·ªáu ·ª©ng n·ªï -->
                <div id="explosionsContainer" class="absolute inset-0 pointer-events-none z-25"></div>
                
                <!-- H∆∞·ªõng d·∫´n ƒëi·ªÅu khi·ªÉn -->
                <div class="absolute top-4 left-4 bg-black/70 rounded-lg p-3 text-white text-sm">
                    <div class="font-bold mb-2 text-center">üéÆ ƒêi·ªÅu khi·ªÉn</div>
                    <div class="flex items-center gap-2 mb-1">
                        <span class="bg-white/20 px-2 py-1 rounded text-xs">‚¨ÖÔ∏è‚û°Ô∏è</span>
                        <span>Di chuy·ªÉn</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <span class="bg-white/20 px-2 py-1 rounded text-xs">SPACE</span>
                        <span>B·∫Øn üí•</span>
                    </div>
                </div>
                
                <!-- M·ª•c ti√™u game -->
                <div class="absolute top-4 right-4 bg-black/70 rounded-lg p-3 text-white text-sm text-center">
                    <div class="font-bold mb-2">üéØ M·ª•c ti√™u</div>
                    <div class="text-xs text-green-400 mb-1">‚úÖ Ti√™u di·ªát ch·∫•t ƒë·ªôc</div>
                    <div class="text-xs text-red-400">‚ùå Tr√°nh ch·∫°m ƒë·∫•t</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Popup ho√†n th√†nh ph·∫ßn 1 -->
    <div id="part1CompletePopup" class="hidden fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 z-50">
        <div class="bg-gradient-to-br from-green-900 to-blue-900 rounded-2xl shadow-2xl max-w-lg w-full popup-enter border-2 border-green-500/50">
            <div class="p-8 text-center">
                <div class="text-8xl mb-6 animate-bounce">üéâ</div>
                <h2 class="text-3xl font-bold text-white mb-4">Xu·∫•t s·∫Øc!</h2>
                <p class="text-green-200 mb-6 text-lg leading-relaxed">
                    B·∫°n ƒë√£ kh√°m ph√° th√†nh c√¥ng t·∫•t c·∫£ <span class="font-bold text-yellow-300">8 c∆° quan</span> quan tr·ªçng!
                    <br>Gi·ªù ƒë√¢y b·∫°n hi·ªÉu r√µ t√°c h·∫°i c·ªßa thu·ªëc l√°.
                </p>
                
                <div class="bg-black/30 rounded-xl p-6 mb-6">
                    <div class="text-yellow-400 font-bold text-xl mb-2">ƒêi·ªÉm s·ªë ph·∫ßn 1</div>
                    <div class="text-4xl font-bold text-white" id="part1PopupScore">100/100</div>
                    <div class="text-green-300 text-sm mt-2">Ho√†n th√†nh xu·∫•t s·∫Øc!</div>
                </div>
                
                <div class="bg-red-900/50 rounded-xl p-4 mb-6 border border-red-500/30">
                    <div class="text-2xl mb-2">‚ö†Ô∏è</div>
                    <p class="text-red-200 font-semibold">
                        Nh∆∞ng cu·ªôc chi·∫øn ch∆∞a k·∫øt th√∫c!<br>
                        C√°c ch·∫•t ƒë·ªôc h·∫°i ƒëang t·∫•n c√¥ng c∆° th·ªÉ...
                    </p>
                </div>
                
                <div class="flex flex-col items-center gap-4">
                    <button onclick="proceedToPart2()" class="bg-gradient-to-r from-red-600 via-orange-600 to-yellow-600 hover:from-red-700 hover:via-orange-700 hover:to-yellow-700 text-white font-bold py-5 px-10 rounded-2xl shadow-2xl transition-all duration-300 transform hover:scale-110 text-xl">
                        üöÄ TI·∫æP T·ª§C CHI·∫æN ƒê·∫§U!
                    </button>
                    <button onclick="closePart1Popup()" class="bg-gray-600 hover:bg-gray-700 text-white font-semibold py-2 px-6 rounded-lg transition-all duration-300">
                        ƒê·ªÉ sau
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Popup Game Over -->
    <div id="gameOverPopup" class="hidden fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 z-50">
        <div class="bg-gradient-to-br from-red-900 to-purple-900 rounded-2xl shadow-2xl max-w-md w-full popup-enter border-2 border-red-500/50">
            <div class="p-6 text-center">
                <div class="text-6xl mb-4">üíÄ</div>
                <h2 class="text-2xl font-bold text-white mb-2">Game Over!</h2>
                <p class="text-red-200 mb-4">C√°c ch·∫•t ƒë·ªôc ƒë√£ x√¢m nh·∫≠p c∆° th·ªÉ!</p>
                
                <div class="bg-black/30 rounded-lg p-4 mb-4">
                    <div class="text-yellow-400 font-bold">ƒêi·ªÉm s·ªë cu·ªëi: <span id="finalScore">0</span></div>
                    <div class="text-blue-400">Level ƒë·∫°t ƒë∆∞·ª£c: <span id="finalLevel">1</span></div>
                </div>
                
                <div class="flex gap-3 justify-center">
                    <button onclick="restartPart2()" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                        üîÑ Ch∆°i l·∫°i
                    </button>
                    <button onclick="backToStart()" class="bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                        üè† Menu ch√≠nh
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Popup Th·∫Øng level -->
    <div id="levelCompletePopup" class="hidden fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 z-50">
        <div class="bg-gradient-to-br from-green-900 to-blue-900 rounded-2xl shadow-2xl max-w-md w-full popup-enter border-2 border-green-500/50">
            <div class="p-6 text-center">
                <div class="text-6xl mb-4">üéâ</div>
                <h2 class="text-2xl font-bold text-white mb-2">Level ho√†n th√†nh!</h2>
                <p class="text-green-200 mb-4">B·∫°n ƒë√£ b·∫£o v·ªá th√†nh c√¥ng c∆° th·ªÉ!</p>
                
                <div class="bg-black/30 rounded-lg p-4 mb-4">
                    <div class="text-yellow-400 font-bold">ƒêi·ªÉm th∆∞·ªüng: +<span id="levelBonus">100</span></div>
                    <div class="text-blue-400">Level ti·∫øp theo: <span id="nextLevel">2</span></div>
                </div>
                
                <button onclick="nextLevel()" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg transition-all duration-300">
                    ‚û°Ô∏è Level ti·∫øp theo
                </button>
            </div>
        </div>
    </div>

    <!-- Popup ho√†n th√†nh ph·∫ßn 2 -->
    <div id="part2CompletePopup" class="hidden fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 z-50">
        <div class="bg-gradient-to-br from-green-900 to-blue-900 rounded-2xl shadow-2xl max-w-lg w-full popup-enter border-2 border-green-500/50">
            <div class="p-8 text-center">
                <div class="text-8xl mb-6 animate-bounce">üèÜ</div>
                <h2 class="text-3xl font-bold text-white mb-4">Chi·∫øn th·∫Øng!</h2>
                <p class="text-green-200 mb-6 text-lg leading-relaxed">
                    B·∫°n ƒë√£ ti√™u di·ªát th√†nh c√¥ng c√°c ch·∫•t ƒë·ªôc h·∫°i!<br>
                    C∆° th·ªÉ ƒë√£ ƒë∆∞·ª£c b·∫£o v·ªá an to√†n.
                </p>
                
                <div class="bg-black/30 rounded-xl p-6 mb-6">
                    <div class="text-yellow-400 font-bold text-xl mb-2">ƒêi·ªÉm s·ªë ph·∫ßn 2</div>
                    <div class="text-4xl font-bold text-white" id="part2PopupScore">0</div>
                    <div class="text-green-300 text-sm mt-2">Xu·∫•t s·∫Øc!</div>
                </div>
                
                <div class="bg-blue-900/50 rounded-xl p-4 mb-6 border border-blue-500/30">
                    <div class="text-2xl mb-2">üß†</div>
                    <p class="text-blue-200 font-semibold">
                        Gi·ªù ƒë√¢y h√£y ki·ªÉm tra ki·∫øn th·ª©c<br>
                        v·ªõi b√†i quiz t·ªïng k·∫øt!
                    </p>
                </div>
                
                <div class="flex flex-col items-center gap-4">
                    <button onclick="proceedToPart3()" class="bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 hover:from-blue-700 hover:via-purple-700 hover:to-pink-700 text-white font-bold py-5 px-10 rounded-2xl shadow-2xl transition-all duration-300 transform hover:scale-110 text-xl">
                        üß† L√ÄM B√ÄI QUIZ!
                    </button>
                    <button onclick="closePart2Popup()" class="bg-gray-600 hover:bg-gray-700 text-white font-semibold py-2 px-6 rounded-lg transition-all duration-300">
                        ƒê·ªÉ sau
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Popup chuy·ªÉn c·∫£nh t·ª´ ph·∫ßn 2 sang ph·∫ßn 3 -->
    <div id="transitionPopup" class="hidden fixed inset-0 bg-black/90 backdrop-blur-sm flex items-center justify-center p-4 z-50">
        <div class="bg-gradient-to-br from-purple-900 via-indigo-900 to-blue-900 rounded-2xl shadow-2xl max-w-2xl w-full popup-enter border-2 border-purple-500/50">
            <div class="p-8 text-center">
                <!-- Animation chuy·ªÉn c·∫£nh -->
                <div class="mb-6">
                    <div class="flex items-center justify-center space-x-4 mb-4">
                        <div class="text-6xl animate-pulse">ü¶∏‚Äç‚ôÇÔ∏è</div>
                        <div class="text-4xl animate-bounce">‚Üí</div>
                        <div class="text-6xl animate-pulse">üß†</div>
                    </div>
                    <div class="w-full bg-purple-800/30 rounded-full h-2 mb-4">
                        <div class="bg-gradient-to-r from-purple-400 to-blue-400 h-2 rounded-full animate-pulse" style="width: 67%;"></div>
                    </div>
                </div>
                
                <h2 class="text-3xl font-bold bg-gradient-to-r from-yellow-400 to-orange-400 bg-clip-text text-transparent mb-4">
                    Nhi·ªám v·ª• ho√†n th√†nh!
                </h2>
                
                <p class="text-purple-200 mb-6 text-lg leading-relaxed">
                    B·∫°n ƒë√£ b·∫£o v·ªá th√†nh c√¥ng c∆° th·ªÉ kh·ªèi c√°c ch·∫•t ƒë·ªôc h·∫°i t·ª´ thu·ªëc l√°!<br>
                    Gi·ªù ƒë√¢y, h√£y ki·ªÉm tra ki·∫øn th·ª©c ƒë√£ h·ªçc ƒë∆∞·ª£c.
                </p>
                
                <!-- Th·ªëng k√™ t·ªïng k·∫øt -->
                <div class="grid grid-cols-2 gap-4 mb-6">
                    <div class="bg-green-500/20 rounded-xl p-4 border border-green-400/30">
                        <div class="text-3xl mb-2">‚úÖ</div>
                        <div class="text-white font-bold text-lg">Ph·∫ßn 1</div>
                        <div class="text-green-200 text-sm">Kh√°m ph√° c∆° th·ªÉ</div>
                    </div>
                    <div class="bg-blue-500/20 rounded-xl p-4 border border-blue-400/30">
                        <div class="text-3xl mb-2">‚úÖ</div>
                        <div class="text-white font-bold text-lg">Ph·∫ßn 2</div>
                        <div class="text-blue-200 text-sm">Ti√™u di·ªát ch·∫•t ƒë·ªôc</div>
                    </div>
                </div>
                
                <!-- Ph·∫ßn 3 s·∫Øp t·ªõi -->
                <div class="bg-gradient-to-r from-purple-800/50 to-pink-800/50 rounded-xl p-6 mb-6 border border-purple-400/30">
                    <div class="text-4xl mb-3">üß†</div>
                    <h3 class="text-xl font-bold text-white mb-2">Ph·∫ßn 3: Quiz Ki·∫øn th·ª©c</h3>
                    <p class="text-purple-200 text-sm mb-3">
                        15 c√¢u h·ªèi v·ªÅ t√°c h·∫°i c·ªßa thu·ªëc l√° v√† thu·ªëc l√° ƒëi·ªán t·ª≠
                    </p>
                    <div class="flex items-center justify-center space-x-4 text-sm">
                        <div class="bg-yellow-500/20 px-3 py-1 rounded-full border border-yellow-400/30">
                            <span class="text-yellow-200">üèÜ ƒêi·ªÉm cao</span>
                        </div>
                        <div class="bg-green-500/20 px-3 py-1 rounded-full border border-green-400/30">
                            <span class="text-green-200">üìö H·ªçc h·ªèi</span>
                        </div>
                    </div>
                </div>
                
                <!-- N√∫t ti·∫øp t·ª•c -->
                <div class="flex flex-col items-center gap-4">
                    <button onclick="startQuizFromTransition()" class="bg-gradient-to-r from-purple-600 via-pink-600 to-red-600 hover:from-purple-700 hover:via-pink-700 hover:to-red-700 text-white font-bold py-5 px-10 rounded-2xl shadow-2xl transition-all duration-300 transform hover:scale-110 text-xl">
                        üöÄ B·∫ÆT ƒê·∫¶U QUIZ!
                    </button>
                    <button onclick="closeTransitionPopup()" class="text-purple-300 hover:text-white text-sm underline transition-colors">
                        ƒê·ªÉ sau
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- M√†n h√¨nh ph·∫ßn 3 - Quiz -->
    <div id="part3Screen" class="hidden min-h-screen p-6 bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-900 relative overflow-hidden">
        <!-- Background hi·ªáu ·ª©ng -->
        <div class="absolute inset-0 bg-[url('data:image/svg+xml,%3Csvg width="60" height="60" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg"%3E%3Cg fill="none" fill-rule="evenodd"%3E%3Cg fill="%23ffffff" fill-opacity="0.1"%3E%3Cpath d="M30 30c0-8.3-6.7-15-15-15s-15 6.7-15 15 6.7 15 15 15 15-6.7 15-15z"/%3E%3C/g%3E%3C/g%3E%3C/svg%3E')] animate-pulse"></div>
        
        <div class="relative z-10 max-w-4xl mx-auto">
            <!-- Header quiz -->
            <div class="text-center mb-8">
                <div class="text-6xl mb-4 animate-bounce">üß†</div>
                <h1 class="text-4xl md:text-5xl font-bold bg-gradient-to-r from-yellow-400 via-orange-400 to-red-500 bg-clip-text text-transparent mb-4">
                    Quiz Ki·∫øn Th·ª©c
                </h1>
                <p class="text-white/90 text-lg mb-6">Ki·ªÉm tra hi·ªÉu bi·∫øt v·ªÅ t√°c h·∫°i c·ªßa thu·ªëc l√°</p>
                
                <!-- Th·ªëng k√™ quiz -->
                <div class="bg-white/10 backdrop-blur-lg rounded-2xl p-4 border border-white/20 max-w-2xl mx-auto">
                    <div class="grid grid-cols-3 gap-4 text-center">
                        <div class="bg-blue-500/20 rounded-xl p-3 border border-blue-400/30">
                            <div class="text-2xl mb-1">üìä</div>
                            <div class="text-white font-bold text-lg" id="quizScore">0</div>
                            <div class="text-blue-200 text-sm">ƒêi·ªÉm s·ªë</div>
                        </div>
                        <div class="bg-green-500/20 rounded-xl p-3 border border-green-400/30">
                            <div class="text-2xl mb-1">‚úÖ</div>
                            <div class="text-white font-bold text-lg" id="correctAnswers">0</div>
                            <div class="text-green-200 text-sm">ƒê√∫ng</div>
                        </div>
                        <div class="bg-purple-500/20 rounded-xl p-3 border border-purple-400/30">
                            <div class="text-2xl mb-1">üìù</div>
                            <div class="text-white font-bold text-lg" id="questionProgress">1/15</div>
                            <div class="text-purple-200 text-sm">C√¢u h·ªèi</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Khu v·ª±c c√¢u h·ªèi -->
            <div id="quizContainer" class="bg-white/95 backdrop-blur-lg rounded-2xl shadow-2xl border border-white/20 overflow-hidden">
                <!-- Thanh ti·∫øn ƒë·ªô -->
                <div class="bg-gradient-to-r from-blue-500 to-purple-500 h-2">
                    <div id="quizProgressBar" class="bg-gradient-to-r from-yellow-400 to-green-500 h-full transition-all duration-500" style="width: 6.67%"></div>
                </div>
                
                <!-- N·ªôi dung c√¢u h·ªèi -->
                <div class="p-8">
                    <!-- S·ªë c√¢u h·ªèi -->
                    <div class="text-center mb-6">
                        <div class="inline-block bg-gradient-to-r from-blue-500 to-purple-500 text-white px-4 py-2 rounded-full font-bold">
                            C√¢u <span id="currentQuestionNumber">1</span>/15
                        </div>
                    </div>
                    
                    <!-- C√¢u h·ªèi -->
                    <div class="text-center mb-8">
                        <h2 id="questionText" class="text-2xl md:text-3xl font-bold text-gray-800 leading-relaxed">
                            <!-- C√¢u h·ªèi s·∫Ω ƒë∆∞·ª£c load b·∫±ng JavaScript -->
                        </h2>
                    </div>
                    
                    <!-- C√°c l·ª±a ch·ªçn -->
                    <div id="answersContainer" class="space-y-4 max-w-3xl mx-auto">
                        <!-- C√°c ƒë√°p √°n s·∫Ω ƒë∆∞·ª£c t·∫°o b·∫±ng JavaScript -->
                    </div>
                    
                    <!-- N√∫t ti·∫øp t·ª•c (·∫©n ban ƒë·∫ßu) -->
                    <div class="text-center mt-8">
                        <button id="nextQuestionBtn" onclick="nextQuestion()" class="hidden bg-gradient-to-r from-green-500 to-blue-500 hover:from-green-600 hover:to-blue-600 text-white font-bold py-3 px-8 rounded-xl shadow-lg transition-all duration-300 transform hover:scale-105">
                            C√¢u ti·∫øp theo ‚Üí
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- N√∫t tho√°t -->
            <div class="text-center mt-6">
                <button onclick="backToTitle()" class="text-white/70 hover:text-white text-sm underline transition-colors">
                    ‚Üê Quay l·∫°i menu ch√≠nh
                </button>
            </div>
        </div>
    </div>

    <!-- M√†n h√¨nh k·∫øt qu·∫£ quiz -->
    <div id="quizResultScreen" class="hidden min-h-screen flex flex-col items-center justify-center p-6 relative overflow-hidden">
        <!-- Background -->
        <div class="absolute inset-0 bg-gradient-to-br from-green-600 via-blue-600 to-purple-700 opacity-95"></div>
        <div class="absolute inset-0 bg-[url('data:image/svg+xml,%3Csvg width="40" height="40" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg"%3E%3Cg fill="none" fill-rule="evenodd"%3E%3Cg fill="%23ffffff" fill-opacity="0.1"%3E%3Ccircle cx="20" cy="20" r="3"/%3E%3C/g%3E%3C/g%3E%3C/svg%3E')] animate-pulse"></div>
        
        <div class="relative z-10 text-center max-w-4xl mx-auto">
            <!-- K·∫øt qu·∫£ -->
            <div class="bg-white/95 backdrop-blur-lg rounded-2xl shadow-2xl p-8 mb-8 border border-white/20">
                <div id="resultIcon" class="text-8xl mb-6">üèÜ</div>
                <h1 id="resultTitle" class="text-4xl font-bold text-gray-800 mb-4">Xu·∫•t s·∫Øc!</h1>
                <p id="resultMessage" class="text-xl text-gray-700 mb-6">
                    <!-- Th√¥ng ƒëi·ªáp s·∫Ω ƒë∆∞·ª£c t·∫°o b·∫±ng JavaScript -->
                </p>
                
                <!-- Th·ªëng k√™ chi ti·∫øt -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    <div class="bg-blue-50 rounded-xl p-6 border border-blue-200">
                        <div class="text-4xl mb-2">üìä</div>
                        <div class="text-3xl font-bold text-blue-600" id="finalScore">0</div>
                        <div class="text-blue-800 font-semibold">ƒêi·ªÉm t·ªïng</div>
                    </div>
                    <div class="bg-green-50 rounded-xl p-6 border border-green-200">
                        <div class="text-4xl mb-2">‚úÖ</div>
                        <div class="text-3xl font-bold text-green-600" id="finalCorrect">0/15</div>
                        <div class="text-green-800 font-semibold">C√¢u ƒë√∫ng</div>
                    </div>
                    <div class="bg-purple-50 rounded-xl p-6 border border-purple-200">
                        <div class="text-4xl mb-2">üéØ</div>
                        <div class="text-3xl font-bold text-purple-600" id="finalAccuracy">0%</div>
                        <div class="text-purple-800 font-semibold">ƒê·ªô ch√≠nh x√°c</div>
                    </div>
                </div>
                
                <!-- Th√¥ng ƒëi·ªáp cu·ªëi -->
                <div id="finalMessage" class="bg-gradient-to-r from-red-50 to-orange-50 rounded-xl p-6 border-2 border-red-200 mb-6">
                    <!-- Th√¥ng ƒëi·ªáp s·∫Ω ƒë∆∞·ª£c t·∫°o b·∫±ng JavaScript -->
                </div>
                
                <!-- N√∫t h√†nh ƒë·ªông -->
                <div class="flex flex-col sm:flex-row gap-4 justify-center">
                    <button onclick="restartQuiz()" class="bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white font-bold py-3 px-8 rounded-xl shadow-lg transition-all duration-300 transform hover:scale-105">
                        üîÑ L√†m l·∫°i quiz
                    </button>
                    <button onclick="backToTitle()" class="bg-gradient-to-r from-green-500 to-blue-500 hover:from-green-600 hover:to-blue-600 text-white font-bold py-3 px-8 rounded-xl shadow-lg transition-all duration-300 transform hover:scale-105">
                        üè† V·ªÅ menu ch√≠nh
                    </button>
                </div>
            </div>
            
            <!-- L·ªùi c·∫£m ∆°n -->
            <div class="bg-white/90 backdrop-blur-lg rounded-xl p-6 border border-white/20">
                <div class="text-3xl mb-3">üíö</div>
                <p class="text-gray-800 font-semibold text-lg">
                    C·∫£m ∆°n b·∫°n ƒë√£ quan t√¢m ƒë·∫øn s·ª©c kh·ªèe!<br>
                    H√£y chia s·∫ª ki·∫øn th·ª©c n√†y v·ªõi b·∫°n b√® v√† gia ƒë√¨nh.
                </p>
                <div class="mt-4 text-sm text-gray-600">
                    <p>üö≠ <strong>Nh·ªõ:</strong> Kh√¥ng c√≥ m·ª©c ƒë·ªô "an to√†n" n√†o khi s·ª≠ d·ª•ng thu·ªëc l√°!</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        let visitedOrgans = new Set();
        let totalScore = 0;
        let characterPosition = { x: 50, y: 500 };
        let nearOrgan = null;
        let isMoving = false;

        // V·ªã tr√≠ c√°c c∆° quan (c·∫≠p nh·∫≠t theo layout m·ªõi)
        const organPositions = {
            brain: { x: 150, y: 20, width: 140, height: 120 },
            immune: { x: 380, y: 20, width: 140, height: 120 },
            skin: { x: 610, y: 20, width: 140, height: 120 },
            heart: { x: 150, y: 170, width: 140, height: 120 },
            lungs: { x: 380, y: 170, width: 140, height: 120 },
            stomach: { x: 610, y: 170, width: 140, height: 120 },
            liver: { x: 265, y: 320, width: 140, height: 120 },
            kidney: { x: 495, y: 320, width: 140, height: 120 }
        };

        const organData = {
            heart: {
                title: "‚ù§Ô∏è Tim",
                dialogues: [
                    "Xin ch√†o! M√¨nh l√† Tim ‚Äì tr√°i tim c·ªßa b·∫°n.",
                    "M·ªói ng√†y, m√¨nh ƒë·∫≠p kho·∫£ng 100.000 l·∫ßn, b∆°m h∆°n 7.500 l√≠t m√°u ƒëi kh·∫Øp c∆° th·ªÉ ƒë·ªÉ cung c·∫•p oxy v√† dinh d∆∞·ª°ng cho m·ªçi t·∫ø b√†o.",
                    "N·∫øu b·∫°n h√∫t thu·ªëc, nicotine s·∫Ω l√†m tƒÉng nh·ªãp tim v√† huy·∫øt √°p, c√≤n carbon monoxide s·∫Ω chi·∫øm ch·ªó oxy trong m√°u, khi·∫øn m√¨nh ph·∫£i l√†m vi·ªác qu√° s·ª©c.",
                    "H·∫≠u qu·∫£ c√≥ th·ªÉ l√† x∆° v·ªØa ƒë·ªông m·∫°ch, nh·ªìi m√°u c∆° tim ho·∫∑c ƒë·ªôt qu·ªµ.",
                    "H√£y gi·ªØ m√¨nh kh·ªèe m·∫°nh b·∫±ng c√°ch tr√°nh xa thu·ªëc l√° v√† r√®n luy·ªán th·ªÉ ch·∫•t m·ªói ng√†y!"
                ]
            },
            brain: {
                title: "üß† N√£o",
                dialogues: [
                    "Xin ch√†o! M√¨nh l√† N√£o ‚Äì trung t√¢m ƒëi·ªÅu khi·ªÉn c∆° th·ªÉ.",
                    "M√¨nh c√≥ kho·∫£ng 86 t·ª∑ t·∫ø b√†o th·∫ßn kinh, x·ª≠ l√Ω th√¥ng tin li√™n t·ª•c ƒë·ªÉ b·∫°n h·ªçc t·∫≠p, s√°ng t·∫°o v√† ghi nh·ªõ.",
                    "Nicotine c√≥ trong thu·ªëc l√° v√† thu·ªëc l√° ƒëi·ªán t·ª≠ c√≥ th·ªÉ thay ƒë·ªïi c·∫•u tr√∫c n√£o, ƒë·∫∑c bi·ªát nguy hi·ªÉm ·ªü tu·ªïi thi·∫øu ni√™n v√¨ ·∫£nh h∆∞·ªüng ƒë·∫øn kh·∫£ nƒÉng h·ªçc t·∫≠p, tr√≠ nh·ªõ v√† ki·ªÉm so√°t c·∫£m x√∫c.",
                    "Khi b·ªã t·ªïn th∆∞∆°ng, b·∫°n s·∫Ω d·ªÖ lo √¢u, tr·∫ßm c·∫£m, m·∫•t t·∫≠p trung.",
                    "H√£y b·∫£o v·ªá m√¨nh b·∫±ng m√¥i tr∆∞·ªùng kh√¥ng kh√≥i thu·ªëc."
                ]
            },
            lungs: {
                title: "ü´Å Ph·ªïi",
                dialogues: [
                    "Xin ch√†o! M√¨nh l√† Ph·ªïi ‚Äì l√° ph·ªïi c·ªßa b·∫°n.",
                    "M·ªói ng√†y, m√¨nh h√≠t v√† th·ªü ra h∆°n 6.000 l√≠t kh√¥ng kh√≠ ƒë·ªÉ cung c·∫•p oxy v√† lo·∫°i b·ªè CO‚ÇÇ.",
                    "Kh√≥i thu·ªëc ch·ª©a tar (h·∫Øc √≠n) s·∫Ω b√°m ch·∫∑t v√†o m√¨nh, formaldehyde g√¢y ung th∆∞, v√† hydrogen cyanide ph√° h·ªßy l√¥ng mao l√†m gi·∫£m kh·∫£ nƒÉng t·ª± l√†m s·∫°ch.",
                    "H·∫≠u qu·∫£ l√† vi√™m ph·∫ø qu·∫£n m·∫°n, kh√≠ ph·∫ø th≈©ng v√† ung th∆∞ ph·ªïi.",
                    "H√£y ƒë·ªÉ m√¨nh h√≠t th·ªü kh√¥ng kh√≠ trong l√†nh nh√©!"
                ]
            },
            liver: {
                title: "ü©∏ Gan",
                dialogues: [
                    "Xin ch√†o! M√¨nh l√† Gan ‚Äì nh√† m√°y l·ªçc m√°u c·ªßa c∆° th·ªÉ.",
                    "M√¨nh chuy·ªÉn h√≥a dinh d∆∞·ª°ng, s·∫£n xu·∫•t protein v√† lo·∫°i b·ªè ƒë·ªôc t·ªë.",
                    "H√≥a ch·∫•t ƒë·ªôc trong thu·ªëc l√°, nh∆∞ arsenic v√† benzene, s·∫Ω l√†m m√¨nh b·ªã vi√™m, x∆° gan, th·∫≠m ch√≠ ung th∆∞ gan.",
                    "H√£y b·∫£o v·ªá m√¨nh b·∫±ng ch·∫ø ƒë·ªô ƒÉn l√†nh m·∫°nh, h·∫°n ch·∫ø ƒë·ªì u·ªëng c√≥ c·ªìn v√† tr√°nh xa kh√≥i thu·ªëc."
                ]
            },
            stomach: {
                title: "ü´É D·∫° d√†y",
                dialogues: [
                    "Ch√†o b·∫°n! M√¨nh l√† D·∫° d√†y ‚Äì n∆°i ti√™u h√≥a v√† nghi·ªÅn n√°t th·ª©c ƒÉn.",
                    "Kh√≥i thu·ªëc k√≠ch th√≠ch tƒÉng ti·∫øt acid d·ªãch v·ªã, g√¢y vi√™m lo√©t d·∫° d√†y ‚Äì t√° tr√†ng v√† c·∫£n tr·ªü h·∫•p thu dinh d∆∞·ª°ng.",
                    "Nicotine c√≤n l√†m gi·∫£m l∆∞u l∆∞·ª£ng m√°u ƒë·∫øn ni√™m m·∫°c d·∫° d√†y, khi·∫øn v·∫øt lo√©t l√¢u l√†nh.",
                    "H√£y ƒÉn u·ªëng ƒëi·ªÅu ƒë·ªô v√† tr√°nh xa thu·ªëc l√° ƒë·ªÉ m√¨nh l√†m vi·ªác hi·ªáu qu·∫£."
                ]
            },
            kidney: {
                title: "ü´ò Th·∫≠n",
                dialogues: [
                    "Xin ch√†o! M√¨nh l√† Th·∫≠n ‚Äì b·ªô l·ªçc m√°u v√† ƒëi·ªÅu h√≤a n∆∞·ªõc c·ªßa c∆° th·ªÉ.",
                    "Nicotine v√† c√°c kim lo·∫°i n·∫∑ng nh∆∞ cadmium t·ª´ kh√≥i thu·ªëc s·∫Ω l√†m h·ªèng c√°c ƒë∆°n v·ªã l·ªçc c·ªßa m√¨nh (nephron), d·∫´n ƒë·∫øn suy th·∫≠n.",
                    "M·ªôt khi suy gi·∫£m ch·ª©c nƒÉng, m√¨nh kh√¥ng th·ªÉ h·ªìi ph·ª•c ho√†n to√†n.",
                    "H√£y u·ªëng ƒë·ªß n∆∞·ªõc v√† tr√°nh c√°c ch·∫•t ƒë·ªôc ƒë·ªÉ b·∫£o v·ªá m√¨nh."
                ]
            },
            immune: {
                title: "üõ°Ô∏è H·ªá mi·ªÖn d·ªãch",
                dialogues: [
                    "Xin ch√†o! M√¨nh l√† H·ªá mi·ªÖn d·ªãch ‚Äì l√° ch·∫Øn c·ªßa c∆° th·ªÉ.",
                    "M√¨nh b·∫£o v·ªá b·∫°n kh·ªèi vi khu·∫©n, virus v√† t·∫ø b√†o b·∫•t th∆∞·ªùng.",
                    "Kh√≥i thu·ªëc l√†m m√¨nh y·∫øu ƒëi, khi·∫øn c∆° th·ªÉ d·ªÖ b·ªã nhi·ªÖm tr√πng v√† gi·∫£m kh·∫£ nƒÉng ch·ªëng ung th∆∞.",
                    "M·ªôt c∆° th·ªÉ kh√¥ng kh√≥i thu·ªëc s·∫Ω gi√∫p m√¨nh m·∫°nh m·∫Ω h∆°n ƒë·ªÉ b·∫£o v·ªá b·∫°n."
                ]
            },
            skin: {
                title: "üë© Da",
                dialogues: [
                    "Ch√†o b·∫°n! M√¨nh l√† Da ‚Äì l·ªõp b·∫£o v·ªá b√™n ngo√†i c·ªßa c∆° th·ªÉ.",
                    "Kh√≥i thu·ªëc l√†m gi·∫£m collagen v√† elastin, khi·∫øn m√¨nh nhanh l√£o h√≥a, xu·∫•t hi·ªán n·∫øp nhƒÉn v√† v·∫øt n√°m.",
                    "Nicotine c√≤n l√†m gi·∫£m l∆∞u l∆∞·ª£ng m√°u d∆∞·ªõi da, khi·∫øn da x·ªân m√†u.",
                    "H√£y y√™u th∆∞∆°ng m√¨nh b·∫±ng c√°ch s·ªëng l√†nh m·∫°nh v√† kh√¥ng h√∫t thu·ªëc."
                ]
            }
        };

        let currentDialogue = null;
        let currentDialogueIndex = 0;

        function showInstructions() {
            document.getElementById('titleScreen').classList.add('hidden');
            document.getElementById('instructionScreen').classList.remove('hidden');
        }

        function showGuide() {
            document.getElementById('titleScreen').classList.add('hidden');
            document.getElementById('instructionScreen').classList.remove('hidden');
        }

        function startGame() {
            document.getElementById('instructionScreen').classList.add('hidden');
            document.getElementById('gameScreen').classList.remove('hidden');
            initializeGame();
        }

        function backToTitle() {
            document.querySelectorAll('[id$="Screen"]').forEach(screen => {
                screen.classList.add('hidden');
            });
            document.getElementById('titleScreen').classList.remove('hidden');
        }

        function showInfo() {
            alert('üéÆ Game "B·∫£o v·ªá s·ª©c kh·ªèe - N√≥i kh√¥ng v·ªõi thu·ªëc l√°"\n\nüë®‚Äçüè´ T√°c gi·∫£: Th·∫ßy Th√°i Minh Nguy√™n\nüè´ Tr∆∞·ªùng THPT Yersin ƒê√† L·∫°t\n\nüéØ M·ª•c ti√™u: Gi√°o d·ª•c v·ªÅ t√°c h·∫°i c·ªßa thu·ªëc l√° th√¥ng qua game t∆∞∆°ng t√°c\n\nüí° Phi√™n b·∫£n: 1.0\nüìÖ NƒÉm: 2024');
        }

        function exitGame() {
            if (confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën tho√°t game?')) {
                alert('C·∫£m ∆°n b·∫°n ƒë√£ quan t√¢m ƒë·∫øn s·ª©c kh·ªèe! H√£y lu√¥n n√≥i kh√¥ng v·ªõi thu·ªëc l√°! üö≠');
            }
        }

        // H√†m di chuy·ªÉn nh√¢n v·∫≠t
        function moveCharacter(x, y) {
            const gameArea = document.getElementById('gameArea');
            const character = document.getElementById('character');
            const gameRect = gameArea.getBoundingClientRect();
            
            // Gi·ªõi h·∫°n di chuy·ªÉn trong game area
            const maxX = gameArea.offsetWidth - 60; // Tr·ª´ k√≠ch th∆∞·ªõc nh√¢n v·∫≠t
            const maxY = gameArea.offsetHeight - 60;
            
            characterPosition.x = Math.max(20, Math.min(x, maxX));
            characterPosition.y = Math.max(20, Math.min(y, maxY));
            
            // Ph√°t √¢m thanh di chuy·ªÉn
            AudioSystem.playMoveSound();
            
            // Th√™m hi·ªáu ·ª©ng di chuy·ªÉn
            character.classList.add('moving');
            character.style.left = characterPosition.x + 'px';
            character.style.top = characterPosition.y + 'px';
            
            // T·∫°o hi·ªáu ·ª©ng b·ª•i khi di chuy·ªÉn
            createMovementParticles(characterPosition.x + 30, characterPosition.y + 40);
            
            // X√≥a class moving sau khi ho√†n th√†nh
            setTimeout(() => {
                character.classList.remove('moving');
            }, 500);
            
            // Ki·ªÉm tra g·∫ßn c∆° quan n√†o
            checkNearOrgan();
        }
        
        // T·∫°o hi·ªáu ·ª©ng h·∫°t khi di chuy·ªÉn
        function createMovementParticles(x, y) {
            const gameArea = document.getElementById('gameArea');
            for (let i = 0; i < 3; i++) {
                const particle = document.createElement('div');
                particle.style.cssText = `
                    position: absolute;
                    left: ${x + (Math.random() - 0.5) * 20}px;
                    top: ${y + (Math.random() - 0.5) * 20}px;
                    width: 4px;
                    height: 4px;
                    background: radial-gradient(circle, rgba(59, 130, 246, 0.8), transparent);
                    border-radius: 50%;
                    pointer-events: none;
                    z-index: 5;
                    animation: particleFade 1s ease-out forwards;
                `;
                gameArea.appendChild(particle);
                
                setTimeout(() => {
                    if (particle.parentNode) {
                        particle.parentNode.removeChild(particle);
                    }
                }, 1000);
            }
        }

        // Ki·ªÉm tra nh√¢n v·∫≠t c√≥ g·∫ßn c∆° quan n√†o kh√¥ng
        function checkNearOrgan() {
            let currentNearOrgan = null;
            const interactionDistance = 80;
            
            for (const [organName, pos] of Object.entries(organPositions)) {
                const distance = Math.sqrt(
                    Math.pow(characterPosition.x - (pos.x + pos.width/2), 2) + 
                    Math.pow(characterPosition.y - (pos.y + pos.height/2), 2)
                );
                
                if (distance < interactionDistance) {
                    currentNearOrgan = organName;
                    break;
                }
            }
            
            // C·∫≠p nh·∫≠t hi·ªáu ·ª©ng
            if (currentNearOrgan !== nearOrgan) {
                // X√≥a hi·ªáu ·ª©ng c≈©
                if (nearOrgan) {
                    const oldOrgan = document.getElementById(nearOrgan + '-organ');
                    oldOrgan.classList.remove('near-character');
                    oldOrgan.querySelector('.interaction-hint').classList.remove('show');
                }
                
                // Th√™m hi·ªáu ·ª©ng m·ªõi
                if (currentNearOrgan && !visitedOrgans.has(currentNearOrgan)) {
                    const newOrgan = document.getElementById(currentNearOrgan + '-organ');
                    newOrgan.classList.add('near-character');
                    newOrgan.querySelector('.interaction-hint').classList.add('show');
                }
                
                nearOrgan = currentNearOrgan;
            }
        }

        // T∆∞∆°ng t√°c v·ªõi c∆° quan
        function interactWithOrgan() {
            if (nearOrgan && !visitedOrgans.has(nearOrgan)) {
                showOrganInfo(nearOrgan);
            }
        }

        function showOrganInfo(organType) {
            if (visitedOrgans.has(organType)) {
                return; // ƒê√£ thƒÉm r·ªìi
            }

            // Ph√°t √¢m thanh t∆∞∆°ng t√°c
            AudioSystem.playInteractSound();

            const data = organData[organType];
            currentDialogue = organType;
            currentDialogueIndex = 0;
            
            showDialogue();
            
            // ƒê√°nh d·∫•u ƒë√£ thƒÉm
            visitedOrgans.add(organType);
            updateProgress();
            
            // X√≥a hi·ªáu ·ª©ng g·∫ßn c∆° quan
            const organ = document.getElementById(organType + '-organ');
            organ.classList.remove('near-character');
            organ.querySelector('.interaction-hint').classList.remove('show');
            // Kh√¥ng l√†m m·ªù ngay, s·∫Ω bi·∫øn m·∫•t ho√†n to√†n sau khi ƒë√≥ng popup
        }

        function showDialogue() {
            if (!currentDialogue) return;
            
            const data = organData[currentDialogue];
            const currentText = data.dialogues[currentDialogueIndex];
            
            document.getElementById('organContent').innerHTML = `
                <div class="text-center">
                    <!-- Ti√™u ƒë·ªÅ v·ªõi icon -->
                    <div class="flex items-center justify-center mb-4">
                        <div class="text-3xl mr-2">${data.title.split(' ')[0]}</div>
                        <h3 class="text-xl font-bold text-gray-800">${data.title.split(' ')[1]}</h3>
                    </div>
                    
                    <!-- N·ªôi dung h·ªôi tho·∫°i ƒë∆°n gi·∫£n -->
                    <div class="bg-blue-50 rounded-xl p-4 mb-4">
                        <p class="text-gray-700 leading-relaxed">${currentText}</p>
                    </div>
                    
                    <!-- Thanh ti·∫øn ƒë·ªô nh·ªè g·ªçn -->
                    <div class="flex items-center justify-center space-x-2 text-sm text-gray-500">
                        <span>${currentDialogueIndex + 1}/${data.dialogues.length}</span>
                        <div class="w-20 bg-gray-200 rounded-full h-1">
                            <div class="bg-blue-500 h-1 rounded-full transition-all duration-300" style="width: ${((currentDialogueIndex + 1) / data.dialogues.length) * 100}%"></div>
                        </div>
                    </div>
                </div>
            `;
            
            // C·∫≠p nh·∫≠t n√∫t
            const buttonText = currentDialogueIndex < data.dialogues.length - 1 ? 'Ti·∫øp t·ª•c ‚Üí' : 'Ho√†n th√†nh ‚úì';
            document.getElementById('dialogueButton').textContent = buttonText;
            
            document.getElementById('organPopup').classList.remove('hidden');
        }

        function nextDialogue() {
            if (!currentDialogue) return;
            
            const data = organData[currentDialogue];
            
            if (currentDialogueIndex < data.dialogues.length - 1) {
                currentDialogueIndex++;
                showDialogue();
            } else {
                closeOrganPopup();
            }
        }

        function closeOrganPopup() {
            document.getElementById('organPopup').classList.add('hidden');
            
            // Ph√°t √¢m thanh ho√†n th√†nh c∆° quan
            AudioSystem.playOrganCompleteSound();
            
            // T·∫°o hi·ªáu ·ª©ng bi·∫øn m·∫•t cho c∆° quan v·ª´a n√≥i chuy·ªán
            if (currentDialogue) {
                const organElement = document.getElementById(currentDialogue + '-organ');
                if (organElement) {
                    // Hi·ªáu ·ª©ng bi·∫øn m·∫•t ƒë·∫πp m·∫Øt
                    organElement.style.animation = 'organDisappear 1.5s ease-out forwards';
                    
                    // T·∫°o hi·ªáu ·ª©ng √°nh s√°ng khi bi·∫øn m·∫•t
                    createOrganDisappearEffect(organElement);
                    
                    // Sau khi hi·ªáu ·ª©ng ho√†n th√†nh, ·∫©n ho√†n to√†n
                    setTimeout(() => {
                        organElement.style.visibility = 'hidden';
                        organElement.style.opacity = '0';
                    }, 1500);
                }
            }
            
            currentDialogue = null;
            currentDialogueIndex = 0;
        }

        // T·∫°o hi·ªáu ·ª©ng √°nh s√°ng khi c∆° quan bi·∫øn m·∫•t
        function createOrganDisappearEffect(organElement) {
            const rect = organElement.getBoundingClientRect();
            const gameArea = document.getElementById('gameArea');
            const gameRect = gameArea.getBoundingClientRect();
            
            // T√≠nh v·ªã tr√≠ t∆∞∆°ng ƒë·ªëi trong game area
            const x = rect.left - gameRect.left + rect.width / 2;
            const y = rect.top - gameRect.top + rect.height / 2;
            
            // T·∫°o nhi·ªÅu h·∫°t √°nh s√°ng bay ra
            for (let i = 0; i < 12; i++) {
                const particle = document.createElement('div');
                const angle = (i / 12) * Math.PI * 2;
                const distance = 80 + Math.random() * 40;
                const endX = x + Math.cos(angle) * distance;
                const endY = y + Math.sin(angle) * distance;
                
                particle.style.cssText = `
                    position: absolute;
                    left: ${x}px;
                    top: ${y}px;
                    width: 8px;
                    height: 8px;
                    background: radial-gradient(circle, #ffd700, #ff6b6b, #4ecdc4);
                    border-radius: 50%;
                    pointer-events: none;
                    z-index: 25;
                    box-shadow: 0 0 15px #ffd700;
                    animation: particleExplode 1.5s ease-out forwards;
                    --end-x: ${endX}px;
                    --end-y: ${endY}px;
                `;
                
                gameArea.appendChild(particle);
                
                setTimeout(() => {
                    if (particle.parentNode) {
                        particle.parentNode.removeChild(particle);
                    }
                }, 1500);
            }
            
            // T·∫°o v√≤ng s√°ng lan t·ªèa
            const ripple = document.createElement('div');
            ripple.style.cssText = `
                position: absolute;
                left: ${x - 20}px;
                top: ${y - 20}px;
                width: 40px;
                height: 40px;
                border: 3px solid #ffd700;
                border-radius: 50%;
                pointer-events: none;
                z-index: 24;
                animation: rippleExpand 1.5s ease-out forwards;
            `;
            
            gameArea.appendChild(ripple);
            
            setTimeout(() => {
                if (ripple.parentNode) {
                    ripple.parentNode.removeChild(ripple);
                }
            }, 1500);
        }

        // Event listeners
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('gameScreen').classList.contains('hidden')) return;
            
            const moveSpeed = 20;
            let newX = characterPosition.x;
            let newY = characterPosition.y;
            
            switch(e.key) {
                case 'ArrowLeft':
                    e.preventDefault(); // NgƒÉn cu·ªôn trang
                    newX -= moveSpeed;
                    break;
                case 'ArrowRight':
                    e.preventDefault(); // NgƒÉn cu·ªôn trang
                    newX += moveSpeed;
                    break;
                case 'ArrowUp':
                    e.preventDefault(); // NgƒÉn cu·ªôn trang
                    newY -= moveSpeed;
                    break;
                case 'ArrowDown':
                    e.preventDefault(); // NgƒÉn cu·ªôn trang
                    newY += moveSpeed;
                    break;
                case ' ':
                    e.preventDefault();
                    if (document.getElementById('organPopup').classList.contains('hidden')) {
                        interactWithOrgan();
                    } else {
                        nextDialogue();
                    }
                    return;
            }
            
            if (newX !== characterPosition.x || newY !== characterPosition.y) {
                moveCharacter(newX, newY);
            }
        });

        // Click ƒë·ªÉ di chuy·ªÉn
        document.getElementById('gameArea').addEventListener('click', function(e) {
            if (document.getElementById('gameScreen').classList.contains('hidden')) return;
            
            const rect = this.getBoundingClientRect();
            const x = e.clientX - rect.left - 40; // Tr·ª´ n·ª≠a k√≠ch th∆∞·ªõc nh√¢n v·∫≠t
            const y = e.clientY - rect.top - 40;
            
            moveCharacter(x, y);
        });

        // Click tr·ª±c ti·∫øp v√†o c∆° quan
        document.querySelectorAll('.organ-interactive').forEach(organ => {
            organ.addEventListener('click', function(e) {
                e.stopPropagation();
                const organType = this.id.replace('-organ', '');
                if (!visitedOrgans.has(organType)) {
                    // Di chuy·ªÉn nh√¢n v·∫≠t ƒë·∫øn g·∫ßn c∆° quan tr∆∞·ªõc
                    const pos = organPositions[organType];
                    moveCharacter(pos.x + pos.width/2 - 40, pos.y + pos.height + 20);
                    
                    // Sau ƒë√≥ t∆∞∆°ng t√°c
                    setTimeout(() => {
                        interactWithOrgan();
                    }, 300);
                }
            });
        });

        function updateProgress() {
            const progress = visitedOrgans.size;
            const total = 8;
            const percentage = (progress / total) * 100;
            
            document.getElementById('progressText').textContent = `${progress}/${total}`;
            document.getElementById('progressBar').style.width = `${percentage}%`;
            
            if (progress === total) {
                document.getElementById('continueButton').classList.remove('hidden');
                totalScore += 100; // ƒêi·ªÉm cho ph·∫ßn 1
                
                // Hi·ªÉn th·ªã popup t·ª± ƒë·ªông sau 2 gi√¢y
                setTimeout(() => {
                    showPart1CompletePopup();
                }, 2000);
            }
        }

        function showPart1CompletePopup() {
            // Ph√°t √¢m thanh ho√†n th√†nh ph·∫ßn 1
            AudioSystem.playPart1CompleteSound();
            
            document.getElementById('part1PopupScore').textContent = `${totalScore}/100`;
            document.getElementById('part1CompletePopup').classList.remove('hidden');
        }

        function proceedToPart2() {
            document.getElementById('part1CompletePopup').classList.add('hidden');
            document.getElementById('gameScreen').classList.add('hidden');
            document.getElementById('part2Intro').classList.remove('hidden');
        }

        function closePart1Popup() {
            document.getElementById('part1CompletePopup').classList.add('hidden');
        }

        function completePart1() {
            document.getElementById('gameScreen').classList.add('hidden');
            document.getElementById('part1Complete').classList.remove('hidden');
            document.getElementById('part1Score').textContent = `${totalScore}/100`;
        }

        function startPart2() {
            document.getElementById('part1Complete').classList.add('hidden');
            document.getElementById('part2Intro').classList.remove('hidden');
        }

        function startPart2Game() {
            document.getElementById('part2Intro').classList.add('hidden');
            document.getElementById('part2Screen').classList.remove('hidden');
            initializePart2();
        }

        // Bi·∫øn game ph·∫ßn 2
        let gameState = {
            isPlaying: false,
            isPaused: false,
            score: 0,
            level: 1,
            health: 3,
            maxHealth: 3,
            heroPosition: 50, // ph·∫ßn trƒÉm t·ª´ tr√°i
            bullets: [],
            toxins: [],
            gameSpeed: 1,
            spawnRate: 0.02,
            lastShot: 0
        };

        // C√°c ch·∫•t ƒë·ªôc h·∫°i v·ªõi th√¥ng tin chi ti·∫øt theo nh√≥m
        const toxinTypes = [
            // Nh√≥m ch·∫•t g√¢y ung th∆∞ üß™
            { 
                emoji: 'üß™', 
                name: 'Benzene', 
                color: 'text-purple-500', 
                points: 25,
                category: 'Ch·∫•t g√¢y ung th∆∞',
                info: 'Benzene g√¢y ung th∆∞ m√°u (b·∫°ch c·∫ßu) v√† t·ªïn th∆∞∆°ng t·ªßy x∆∞∆°ng. C√≥ trong thu·ªëc l√° th∆∞·ªùng v√† m·ªôt s·ªë thu·ªëc l√° ƒëi·ªán t·ª≠.'
            },
            { 
                emoji: '‚öóÔ∏è', 
                name: 'Formaldehyde', 
                color: 'text-purple-400', 
                points: 30,
                category: 'Ch·∫•t g√¢y ung th∆∞',
                info: 'Ch·∫•t b·∫£o qu·∫£n x√°c ch·∫øt! G√¢y ung th∆∞ m≈©i, h·ªçng v√† k√≠ch ·ª©ng ƒë∆∞·ªùng h√¥ h·∫•p. C√≥ trong c·∫£ thu·ªëc l√° th∆∞·ªùng v√† ƒëi·ªán t·ª≠.'
            },
            { 
                emoji: '‚ò¢Ô∏è', 
                name: 'Arsenic', 
                color: 'text-purple-600', 
                points: 35,
                category: 'Ch·∫•t g√¢y ung th∆∞',
                info: 'Ch·∫•t ƒë·ªôc chu·ªôt! G√¢y ung th∆∞ da, ph·ªïi, gan v√† b√†ng quang. T√≠ch t·ª• t·ª´ thu·ªëc l√° th∆∞·ªùng qua nhi·ªÅu nƒÉm.'
            },
            { 
                emoji: 'üè≠', 
                name: 'Cadmium', 
                color: 'text-purple-300', 
                points: 25,
                category: 'Ch·∫•t g√¢y ung th∆∞',
                info: 'Kim lo·∫°i n·∫∑ng ƒë·ªôc h·∫°i, g√¢y ung th∆∞ ph·ªïi, t·ªïn th∆∞∆°ng th·∫≠n v√† x∆∞∆°ng. C√≥ trong thu·ªëc l√° th∆∞·ªùng.'
            },
            
            // Nh√≥m ch·∫•t ƒë·ªôc th·∫ßn kinh ‚ö°
            { 
                emoji: '‚ö°', 
                name: 'Nicotine', 
                color: 'text-yellow-500', 
                points: 15,
                category: 'Ch·∫•t ƒë·ªôc th·∫ßn kinh',
                info: 'Nicotine g√¢y nghi·ªán m·∫°nh, tƒÉng nh·ªãp tim, huy·∫øt √°p v√† ·∫£nh h∆∞·ªüng n√£o b·ªô. C√≥ trong c·∫£ thu·ªëc l√° th∆∞·ªùng v√† ƒëi·ªán t·ª≠!'
            },
            { 
                emoji: 'üí®', 
                name: 'Carbon Monoxide', 
                color: 'text-yellow-400', 
                points: 20,
                category: 'Ch·∫•t ƒë·ªôc th·∫ßn kinh',
                info: 'CO thay th·∫ø oxy trong m√°u, g√¢y thi·∫øu oxy n√£o v√† tim, ƒëau ƒë·∫ßu, ch√≥ng m·∫∑t. Ch·ªâ c√≥ trong kh√≥i thu·ªëc l√° th∆∞·ªùng.'
            },
            
            // Nh√≥m ph√° h·ªßy ph·ªïi üå´Ô∏è
            { 
                emoji: 'üå´Ô∏è', 
                name: 'Tar (H·∫Øc √≠n)', 
                color: 'text-gray-500', 
                points: 20,
                category: 'Ph√° h·ªßy ph·ªïi',
                info: 'Tar b√°m ch·∫∑t v√†o ph·ªïi, g√¢y ung th∆∞ ph·ªïi v√† l√†m ƒëen ph·ªïi. Ch·ªâ c√≥ trong thu·ªëc l√° ƒë·ªët ch√°y.'
            },
            { 
                emoji: 'üß®', 
                name: 'Ammonia', 
                color: 'text-gray-400', 
                points: 15,
                category: 'Ph√° h·ªßy ph·ªïi',
                info: 'Ammonia k√≠ch ·ª©ng m·∫°nh ƒë∆∞·ªùng h√¥ h·∫•p, l√†m tƒÉng h·∫•p th·ª• nicotine. C√≥ trong thu·ªëc l√° th∆∞·ªùng.'
            },
            { 
                emoji: 'üíÄ', 
                name: 'Hydrogen Cyanide', 
                color: 'text-gray-600', 
                points: 40,
                category: 'Ph√° h·ªßy ph·ªïi',
                info: 'Ch·∫•t ƒë·ªôc c·ª±c m·∫°nh, ngƒÉn t·∫ø b√†o s·ª≠ d·ª•ng oxy, ph√° h·ªßy l√¥ng mao ph·ªïi. C√≥ trong kh√≥i thu·ªëc l√° th∆∞·ªùng.'
            },
            
            // Nh√≥m ph·ª• gia ƒë·ªôc h·∫°i ‚ò†Ô∏è
            { 
                emoji: '‚ò†Ô∏è', 
                name: 'Acetone', 
                color: 'text-red-500', 
                points: 15,
                category: 'Ph·ª• gia ƒë·ªôc h·∫°i',
                info: 'Acetone (dung m√¥i t·∫©y s∆°n m√≥ng tay) g√¢y k√≠ch ·ª©ng m·∫Øt, m≈©i, h·ªçng. C√≥ trong thu·ªëc l√° th∆∞·ªùng.'
            },
            { 
                emoji: 'ü¶†', 
                name: 'DDT', 
                color: 'text-red-400', 
                points: 30,
                category: 'Ph·ª• gia ƒë·ªôc h·∫°i',
                info: 'DDT (thu·ªëc tr·ª´ s√¢u b·ªã c·∫•m) g√¢y r·ªëi lo·∫°n n·ªôi ti·∫øt, ung th∆∞. C√≥ trong thu·ªëc l√° th∆∞·ªùng.'
            },
            { 
                emoji: '‚ò¢Ô∏è', 
                name: 'Polonium-210', 
                color: 'text-red-600', 
                points: 50,
                category: 'Ph·ª• gia ƒë·ªôc h·∫°i',
                info: 'Ch·∫•t ph√≥ng x·∫° c·ª±c ƒë·ªôc! G√¢y ung th∆∞ ph·ªïi v√† c√°c c∆° quan kh√°c. C√≥ trong thu·ªëc l√° th∆∞·ªùng.'
            },
            
            // Nh√≥m ch·∫•t ƒë·ªôc trong Vape üí®
            { 
                emoji: 'üí®', 
                name: 'Diacetyl', 
                color: 'text-blue-500', 
                points: 25,
                category: 'Ch·∫•t ƒë·ªôc trong Vape',
                info: 'Diacetyl g√¢y "b·ªánh ph·ªïi b·ªèng ng√¥" - x∆° h√≥a ph·ªïi kh√¥ng h·ªìi ph·ª•c. C√≥ trong h∆∞∆°ng li·ªáu thu·ªëc l√° ƒëi·ªán t·ª≠.'
            },
            { 
                emoji: 'üî©', 
                name: 'Kim lo·∫°i n·∫∑ng', 
                color: 'text-blue-400', 
                points: 20,
                category: 'Ch·∫•t ƒë·ªôc trong Vape',
                info: 'Ch√¨, niken, cr√¥m t·ª´ cu·ªôn d√¢y nung n√≥ng. G√¢y t·ªïn th∆∞∆°ng n√£o, th·∫≠n, gan. C√≥ trong thu·ªëc l√° ƒëi·ªán t·ª≠.'
            },
            { 
                emoji: 'üå°Ô∏è', 
                name: 'Formaldehyde t·ª´ PG/VG', 
                color: 'text-blue-600', 
                points: 30,
                category: 'Ch·∫•t ƒë·ªôc trong Vape',
                info: 'Khi PG/VG b·ªã nung n√≥ng qu√° m·ª©c t·∫°o ra formaldehyde g√¢y ung th∆∞. C√≥ trong thu·ªëc l√° ƒëi·ªán t·ª≠.'
            },
            
            // Nh√≥m h·∫°t si√™u nh·ªè üî¨
            { 
                emoji: 'üî¨', 
                name: 'Ultrafine Particles', 
                color: 'text-green-500', 
                points: 35,
                category: 'H·∫°t si√™u nh·ªè',
                info: 'H·∫°t si√™u nh·ªè (<0.1 micron) x√¢m nh·∫≠p s√¢u v√†o ph·ªïi v√† m√°u, g√¢y vi√™m v√† b·ªánh tim m·∫°ch. C√≥ trong c·∫£ hai lo·∫°i thu·ªëc l√°.'
            }
        ];

        function initializePart2() {
            // Reset game state
            gameState = {
                isPlaying: true,
                isPaused: false,
                score: 0,
                level: 1,
                health: 3,
                maxHealth: 3,
                heroPosition: 50,
                bullets: [],
                toxins: [],
                gameSpeed: 1,
                spawnRate: 0.008, // B·∫Øt ƒë·∫ßu ch·∫≠m h∆°n
                lastShot: 0,
                difficultyMultiplier: 1,
                toxinSpeed: 1,
                startTime: Date.now() // Th√™m th·ªùi gian b·∫Øt ƒë·∫ßu
            };
            
            // B·∫Øt ƒë·∫ßu √¢m thanh n·ªÅn game
            AudioSystem.playGameAmbient();
            
            updateGameDisplay();
            startGameLoop();
            
            // Focus ƒë·ªÉ nh·∫≠n keyboard input
            document.getElementById('gameCanvas').focus();
        }

        function updateGameDisplay() {
            document.getElementById('scoreDisplay').textContent = gameState.score;
            document.getElementById('levelDisplay').textContent = gameState.level;
            
            // C·∫≠p nh·∫≠t m√°u v·ªõi icon c∆° quan
            const healthIcons = ['‚ù§Ô∏è', 'üß†', 'ü´Å']; // Tim, N√£o, Ph·ªïi
            let healthDisplay = '';
            for (let i = 0; i < gameState.maxHealth; i++) {
                if (i < gameState.health) {
                    healthDisplay += healthIcons[i];
                } else {
                    healthDisplay += 'üíÄ'; // C∆° quan b·ªã t·ªïn th∆∞∆°ng
                }
            }
            document.getElementById('healthDisplay').textContent = healthDisplay;
            
            // C·∫≠p nh·∫≠t v·ªã tr√≠ hero
            const hero = document.getElementById('hero');
            hero.style.left = gameState.heroPosition + '%';
        }

        function startGameLoop() {
            if (!gameState.isPlaying || gameState.isPaused) return;
            
            // TƒÉng ƒë·ªô kh√≥ theo th·ªùi gian (m·ªói 5 gi√¢y thay v√¨ 10 gi√¢y)
            const gameTime = Date.now() - (gameState.startTime || Date.now());
            gameState.difficultyMultiplier = 1 + Math.floor(gameTime / 5000) * 0.4; // TƒÉng 40% m·ªói 5 gi√¢y
            
            // TƒÉng spawn rate m·∫°nh h∆°n theo level v√† th·ªùi gian
            const baseSpawnRate = gameState.spawnRate + (gameState.level - 1) * 0.008; // TƒÉng t·ª´ 0.003 l√™n 0.008
            const timeBonus = gameState.difficultyMultiplier * 0.006; // TƒÉng t·ª´ 0.002 l√™n 0.006
            const currentSpawnRate = baseSpawnRate + timeBonus;
            
            // Spawn ch·∫•t ƒë·ªôc v·ªõi t·∫ßn su·∫•t tƒÉng m·∫°nh
            if (Math.random() < currentSpawnRate) {
                spawnToxin();
            }
            
            // Spawn nhi·ªÅu ch·∫•t ƒë·ªôc c√πng l√∫c ·ªü level th·∫•p h∆°n v√† nhi·ªÅu h∆°n
            if (gameState.level >= 2 && Math.random() < 0.008) { // B·∫Øt ƒë·∫ßu t·ª´ level 2
                spawnToxin();
            }
            if (gameState.level >= 3 && Math.random() < 0.012) { // Level 3 spawn nhi·ªÅu h∆°n
                spawnToxin();
                if (Math.random() < 0.5) spawnToxin(); // 50% c∆° h·ªôi spawn th√™m 1 n·ªØa
            }
            if (gameState.level >= 4 && Math.random() < 0.015) {
                spawnToxin();
                spawnToxin(); // Ch·∫Øc ch·∫Øn spawn 2
            }
            if (gameState.level >= 5 && Math.random() < 0.018) {
                spawnToxin();
                spawnToxin();
                if (Math.random() < 0.7) spawnToxin(); // 70% c∆° h·ªôi spawn th√™m 1
            }
            if (gameState.level >= 6 && Math.random() < 0.025) {
                // Level 6+ c√≥ th·ªÉ spawn 3-4 ch·∫•t ƒë·ªôc c√πng l√∫c
                spawnToxin();
                spawnToxin();
                spawnToxin();
                if (Math.random() < 0.6) spawnToxin(); // 60% c∆° h·ªôi spawn th√™m 1
            }
            
            // Spawn ƒë·∫∑c bi·ªát: m·ªói 15 gi√¢y spawn m·ªôt ƒë·ª£t ch·∫•t ƒë·ªôc l·ªõn
            if (Math.floor(gameTime / 15000) > Math.floor((gameTime - 16) / 15000)) {
                for (let i = 0; i < gameState.level + 2; i++) {
                    setTimeout(() => spawnToxin(), i * 200); // Spawn c√°ch nhau 200ms
                }
            }
            
            // Di chuy·ªÉn ƒë·∫°n
            moveBullets();
            
            // Di chuy·ªÉn ch·∫•t ƒë·ªôc
            moveToxins();
            
            // Ki·ªÉm tra va ch·∫°m
            checkCollisions();
            
            // Ki·ªÉm tra ƒëi·ªÅu ki·ªán th·∫Øng/thua
            checkGameConditions();
            
            // Ti·∫øp t·ª•c game loop
            setTimeout(startGameLoop, 16); // ~60 FPS
        }

        function spawnToxin() {
            const toxinType = toxinTypes[Math.floor(Math.random() * toxinTypes.length)];
            const gameCanvas = document.getElementById('gameCanvas');
            const canvasWidth = gameCanvas.offsetWidth;
            
            // T·ªëc ƒë·ªô tƒÉng m·∫°nh h∆°n theo level v√† th·ªùi gian
            const baseSpeed = 1.2 + (gameState.level - 1) * 0.6; // TƒÉng t·ª´ 0.8 l√™n 1.2, t·ª´ 0.3 l√™n 0.6 m·ªói level
            const timeSpeedBonus = gameState.difficultyMultiplier * 0.8; // TƒÉng t·ª´ 0.6 l√™n 0.8
            const randomSpeed = Math.random() * 1.2 * gameState.difficultyMultiplier; // TƒÉng t·ª´ 0.6 l√™n 1.2
            const finalSpeed = baseSpeed + timeSpeedBonus + randomSpeed;
            
            const toxin = {
                id: Date.now() + Math.random(),
                x: Math.random() * (canvasWidth - 60) + 30,
                y: -50,
                type: toxinType,
                speed: finalSpeed
            };
            
            gameState.toxins.push(toxin);
            
            // T·∫°o element DOM v·ªõi hi·ªáu ·ª©ng t√πy theo level
            const toxinElement = document.createElement('div');
            toxinElement.id = 'toxin-' + toxin.id;
            toxinElement.className = `absolute text-4xl transition-all duration-100 ${toxin.type.color}`;
            toxinElement.style.left = toxin.x + 'px';
            toxinElement.style.top = toxin.y + 'px';
            toxinElement.style.filter = 'drop-shadow(0 4px 8px rgba(0, 0, 0, 0.4))';
            toxinElement.style.zIndex = '15';
            toxinElement.textContent = toxin.type.emoji;
            
            // Hi·ªáu ·ª©ng ƒë·∫∑c bi·ªát cho level cao
            if (gameState.level >= 3) {
                toxinElement.style.animation = 'toxinGlow 1s ease-in-out infinite alternate';
            }
            if (gameState.level >= 5) {
                toxinElement.style.transform = 'scale(1.1)';
                toxinElement.style.filter += ' brightness(1.2)';
            }
            
            document.getElementById('toxinsContainer').appendChild(toxinElement);
        }

        function shootBullet() {
            const now = Date.now();
            if (now - gameState.lastShot < 80) return; // TƒÉng t·ªëc ƒë·ªô b·∫Øn nh∆∞ Chicken Invaders
            
            gameState.lastShot = now;
            
            // Ph√°t √¢m thanh b·∫Øn ƒë·∫°n
            AudioSystem.playShootSound();
            
            // L·∫•y v·ªã tr√≠ ch√≠nh x√°c c·ªßa hero
            const gameCanvas = document.getElementById('gameCanvas');
            const canvasWidth = gameCanvas.offsetWidth;
            const canvasHeight = gameCanvas.offsetHeight;
            
            // T√≠nh v·ªã tr√≠ pixel t·ª´ ph·∫ßn trƒÉm c·ªßa hero
            const heroPixelX = (gameState.heroPosition / 100) * canvasWidth;
            const heroPixelY = canvasHeight - 80; // Hero ·ªü g·∫ßn ƒë√°y m√†n h√¨nh
            
            // B·∫Øn 3 vi√™n ƒë·∫°n c√πng l√∫c nh∆∞ Chicken Invaders
            const bulletOffsets = [-15, 0, 15]; // Tr√°i, gi·ªØa, ph·∫£i
            
            bulletOffsets.forEach((offset, index) => {
                const bullet = {
                    id: Date.now() + Math.random() + index,
                    x: heroPixelX + offset, // V·ªã tr√≠ X t·ª´ hero v·ªõi offset
                    y: heroPixelY, // B·∫Øt ƒë·∫ßu t·ª´ v·ªã tr√≠ hero
                    speed: 18 + Math.random() * 4, // T·ªëc ƒë·ªô ƒë·∫°n bay l√™n tr√™n v·ªõi bi·∫øn thi√™n
                    angle: offset * 0.1 // G√≥c b·∫Øn nh·∫π cho ƒë·∫°n tr√°i/ph·∫£i
                };
                
                gameState.bullets.push(bullet);
                
                // T·∫°o element DOM v·ªõi hi·ªáu ·ª©ng laser ƒë·∫πp nh∆∞ Chicken Invaders
                const bulletElement = document.createElement('div');
                bulletElement.id = 'bullet-' + bullet.id;
                bulletElement.className = 'absolute transition-all duration-50';
                bulletElement.style.left = (bullet.x - 2) + 'px'; // CƒÉn gi·ªØa ƒë·∫°n
                bulletElement.style.top = bullet.y + 'px';
                bulletElement.style.width = '4px';
                bulletElement.style.height = '20px';
                
                // M√†u s·∫Øc kh√°c nhau cho t·ª´ng vi√™n ƒë·∫°n
                const colors = [
                    'linear-gradient(to top, #ff4444, #ffaa44, #ffff44)', // ƒê·∫°n tr√°i - ƒë·ªè v√†ng
                    'linear-gradient(to top, #4444ff, #44aaff, #44ffff)', // ƒê·∫°n gi·ªØa - xanh d∆∞∆°ng
                    'linear-gradient(to top, #44ff44, #aaff44, #ffff44)'  // ƒê·∫°n ph·∫£i - xanh l√°
                ];
                
                bulletElement.style.background = colors[index];
                bulletElement.style.borderRadius = '2px';
                bulletElement.style.boxShadow = `0 0 10px ${colors[index].includes('ff4444') ? '#ff4444' : colors[index].includes('4444ff') ? '#4444ff' : '#44ff44'}, 0 0 20px ${colors[index].includes('ff4444') ? '#ff4444' : colors[index].includes('4444ff') ? '#4444ff' : '#44ff44'}`;
                bulletElement.style.filter = 'brightness(1.5)';
                bulletElement.style.animation = 'chickenInvadersBullet 0.1s ease-in-out infinite alternate';
                bulletElement.style.zIndex = '20';
                
                // Hi·ªáu ·ª©ng ƒëu√¥i ƒë·∫°n
                const trail = document.createElement('div');
                trail.className = 'absolute';
                trail.style.width = '2px';
                trail.style.height = '10px';
                trail.style.background = 'linear-gradient(to top, transparent, rgba(255,255,255,0.6))';
                trail.style.top = '20px';
                trail.style.left = '1px';
                trail.style.borderRadius = '1px';
                bulletElement.appendChild(trail);
                
                document.getElementById('bulletsContainer').appendChild(bulletElement);
            });
        }

        function moveBullets() {
            gameState.bullets = gameState.bullets.filter(bullet => {
                bullet.y -= bullet.speed; // ƒê·∫°n bay l√™n tr√™n
                bullet.x += bullet.angle * bullet.speed; // Di chuy·ªÉn theo g√≥c (cho ƒë·∫°n tr√°i/ph·∫£i)
                
                const bulletElement = document.getElementById('bullet-' + bullet.id);
                if (bulletElement) {
                    bulletElement.style.top = bullet.y + 'px';
                    bulletElement.style.left = (bullet.x - 2) + 'px';
                    
                    // X√≥a ƒë·∫°n khi ra kh·ªèi m√†n h√¨nh (l√™n tr√™n ho·∫∑c ra ngo√†i)
                    if (bullet.y < -30 || bullet.x < -20 || bullet.x > document.getElementById('gameCanvas').offsetWidth + 20) {
                        bulletElement.remove();
                        return false;
                    }
                }
                
                return true;
            });
        }

        function moveToxins() {
            gameState.toxins = gameState.toxins.filter(toxin => {
                toxin.y += toxin.speed;
                
                const toxinElement = document.getElementById('toxin-' + toxin.id);
                if (toxinElement) {
                    toxinElement.style.top = toxin.y + 'px';
                    
                    // X√≥a ch·∫•t ƒë·ªôc khi ra kh·ªèi m√†n h√¨nh (kh√¥ng g√¢y s√°t th∆∞∆°ng)
                    if (toxin.y > 550) {
                        toxinElement.remove();
                        return false;
                    }
                }
                
                return true;
            });
        }

        function checkCollisions() {
            // Ki·ªÉm tra va ch·∫°m ƒë·∫°n v·ªõi ch·∫•t ƒë·ªôc
            gameState.bullets.forEach(bullet => {
                gameState.toxins.forEach(toxin => {
                    const bulletElement = document.getElementById('bullet-' + bullet.id);
                    const toxinElement = document.getElementById('toxin-' + toxin.id);
                    
                    if (bulletElement && toxinElement) {
                        // Ki·ªÉm tra va ch·∫°m ch√≠nh x√°c b·∫±ng pixel
                        const distance = Math.sqrt(
                            Math.pow(bullet.x - (toxin.x + 25), 2) + 
                            Math.pow(bullet.y - (toxin.y + 25), 2)
                        );
                        
                        if (distance < 35) { // Kho·∫£ng c√°ch va ch·∫°m
                            // Va ch·∫°m!
                            createExplosion(toxin.x, toxin.y);
                            
                            // Hi·ªÉn th·ªã popup th√¥ng tin ch·∫•t ƒë·ªôc
                            showToxinInfo(toxin.type);
                            
                            // C·ªông ƒëi·ªÉm
                            gameState.score += toxin.type.points;
                            
                            // X√≥a ƒë·∫°n v√† ch·∫•t ƒë·ªôc
                            bulletElement.remove();
                            toxinElement.remove();
                            
                            // X√≥a kh·ªèi m·∫£ng
                            gameState.bullets = gameState.bullets.filter(b => b.id !== bullet.id);
                            gameState.toxins = gameState.toxins.filter(t => t.id !== toxin.id);
                            
                            updateGameDisplay();
                        }
                    }
                });
            });
            
            // Ki·ªÉm tra va ch·∫°m ch·∫•t ƒë·ªôc v·ªõi nh√¢n v·∫≠t
            const heroElement = document.getElementById('hero');
            const gameCanvas = document.getElementById('gameCanvas');
            const canvasRect = gameCanvas.getBoundingClientRect();
            const heroRect = heroElement.getBoundingClientRect();
            const heroX = heroRect.left - canvasRect.left + heroRect.width / 2;
            const heroY = heroRect.top - canvasRect.top + heroRect.height / 2;
            
            gameState.toxins.forEach(toxin => {
                const toxinElement = document.getElementById('toxin-' + toxin.id);
                if (toxinElement) {
                    const distance = Math.sqrt(
                        Math.pow(heroX - (toxin.x + 25), 2) + 
                        Math.pow(heroY - (toxin.y + 25), 2)
                    );
                    
                    if (distance < 40) { // Nh√¢n v·∫≠t b·ªã tr√∫ng
                        // T·∫°o hi·ªáu ·ª©ng b·ªã tr√∫ng
                        createHitEffect(heroX, heroY);
                        
                        // X√≥a ch·∫•t ƒë·ªôc
                        toxinElement.remove();
                        gameState.toxins = gameState.toxins.filter(t => t.id !== toxin.id);
                        
                        // M·∫•t m√°u
                        takeDamage();
                    }
                }
            });
        }

        function createExplosion(x, y) {
            // Ph√°t √¢m thanh n·ªï
            AudioSystem.playExplosionSound();
            
            const explosion = document.createElement('div');
            explosion.className = 'absolute text-4xl pointer-events-none';
            explosion.style.left = x + 'px';
            explosion.style.top = y + 'px';
            explosion.textContent = 'üí•';
            explosion.style.animation = 'explosionFade 0.5s ease-out forwards';
            explosion.style.zIndex = '30';
            
            document.getElementById('explosionsContainer').appendChild(explosion);
            
            setTimeout(() => {
                explosion.remove();
            }, 500);
        }

        function createHitEffect(x, y) {
            // Ph√°t √¢m thanh b·ªã tr√∫ng
            AudioSystem.playHitSound();
            
            const hitEffect = document.createElement('div');
            hitEffect.className = 'absolute text-5xl pointer-events-none';
            hitEffect.style.left = (x - 25) + 'px';
            hitEffect.style.top = (y - 25) + 'px';
            hitEffect.textContent = 'üíî';
            hitEffect.style.animation = 'hitEffectFade 0.8s ease-out forwards';
            hitEffect.style.zIndex = '35';
            
            document.getElementById('explosionsContainer').appendChild(hitEffect);
            
            // Hi·ªáu ·ª©ng rung nh√¢n v·∫≠t
            const heroElement = document.getElementById('hero');
            heroElement.style.animation = 'heroShake 0.5s ease-in-out';
            
            setTimeout(() => {
                hitEffect.remove();
                heroElement.style.animation = '';
            }, 800);
        }

        function showToxinInfo(toxinType) {
            // T·∫°o popup th√¥ng tin 3 gi√¢y v·ªõi thi·∫øt k·∫ø ƒë·∫πp h∆°n
            const popup = document.createElement('div');
            popup.className = 'fixed top-4 right-4 bg-gradient-to-br from-red-900 via-orange-900 to-yellow-900 text-white p-5 rounded-2xl shadow-2xl border-2 border-red-400/60 max-w-sm z-50 transform translate-x-full backdrop-blur-lg';
            popup.style.animation = 'slideInRight 0.4s cubic-bezier(0.34, 1.56, 0.64, 1) forwards, slideOutRight 0.4s ease-in 2.6s forwards';
            
            // M√†u n·ªÅn theo nh√≥m ch·∫•t ƒë·ªôc
            let bgGradient = 'from-red-900 via-orange-900 to-yellow-900';
            let borderColor = 'border-red-400/60';
            
            switch(toxinType.category) {
                case 'Ch·∫•t g√¢y ung th∆∞':
                    bgGradient = 'from-purple-900 via-purple-800 to-purple-700';
                    borderColor = 'border-purple-400/60';
                    break;
                case 'Ch·∫•t ƒë·ªôc th·∫ßn kinh':
                    bgGradient = 'from-yellow-900 via-yellow-800 to-orange-800';
                    borderColor = 'border-yellow-400/60';
                    break;
                case 'Ph√° h·ªßy ph·ªïi':
                    bgGradient = 'from-gray-900 via-gray-800 to-gray-700';
                    borderColor = 'border-gray-400/60';
                    break;
                case 'Ph·ª• gia ƒë·ªôc h·∫°i':
                    bgGradient = 'from-red-900 via-red-800 to-red-700';
                    borderColor = 'border-red-400/60';
                    break;
                case 'Ch·∫•t ƒë·ªôc trong Vape':
                    bgGradient = 'from-blue-900 via-blue-800 to-blue-700';
                    borderColor = 'border-blue-400/60';
                    break;
                case 'H·∫°t si√™u nh·ªè':
                    bgGradient = 'from-green-900 via-green-800 to-green-700';
                    borderColor = 'border-green-400/60';
                    break;
            }
            
            popup.className = popup.className.replace('from-red-900 via-orange-900 to-yellow-900', bgGradient);
            popup.className = popup.className.replace('border-red-400/60', borderColor);
            
            popup.innerHTML = `
                <div class="flex items-start space-x-3">
                    <div class="text-4xl animate-pulse">${toxinType.emoji}</div>
                    <div class="flex-1">
                        <div class="flex items-center justify-between mb-2">
                            <h4 class="font-bold text-lg text-white">${toxinType.name}</h4>
                            <div class="text-sm text-yellow-300 font-bold">+${toxinType.points} ƒëi·ªÉm</div>
                        </div>
                        <div class="text-xs text-gray-300 mb-2 font-semibold">${toxinType.category}</div>
                        <p class="text-sm text-gray-100 leading-tight">${toxinType.info}</p>
                        
                        <!-- Thanh th·ªùi gian -->
                        <div class="mt-3 w-full bg-black/30 rounded-full h-1">
                            <div class="bg-gradient-to-r from-yellow-400 to-red-500 h-1 rounded-full animate-countdown" style="animation-duration: 3s;"></div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(popup);
            
            // T·ª± ƒë·ªông x√≥a sau 3 gi√¢y
            setTimeout(() => {
                if (popup.parentNode) {
                    popup.parentNode.removeChild(popup);
                }
            }, 3000);
        }

        function takeDamage() {
            gameState.health--;
            
            // Hi·ªáu ·ª©ng m·∫•t m√°u v·ªõi animation
            const healthDisplay = document.getElementById('healthDisplay');
            healthDisplay.style.animation = 'healthLoss 0.5s ease-in-out';
            
            setTimeout(() => {
                healthDisplay.style.animation = '';
            }, 500);
            
            updateGameDisplay();
            
            if (gameState.health <= 0) {
                gameOver();
            }
        }

        function checkGameConditions() {
            // Ki·ªÉm tra l√™n level (m·ªói 300 ƒëi·ªÉm thay v√¨ 500 ƒë·ªÉ l√™n level nhanh h∆°n)
            const newLevel = Math.floor(gameState.score / 300) + 1;
            if (newLevel > gameState.level) {
                levelUp(newLevel);
            }
        }

        function levelUp(newLevel) {
            gameState.level = newLevel;
            
            // Ph√°t √¢m thanh l√™n level
            AudioSystem.playLevelUpSound();
            
            // TƒÉng ƒë·ªô kh√≥ m·∫°nh h∆°n m·ªói level
            gameState.gameSpeed += 0.4; // TƒÉng t·ª´ 0.2 l√™n 0.4
            gameState.spawnRate += 0.008; // TƒÉng t·ª´ 0.003 l√™n 0.008
            
            // Bonus ƒëi·ªÉm tƒÉng theo level
            const levelBonus = 100 + (newLevel - 1) * 50;
            
            // Hi·ªÉn th·ªã popup level complete v·ªõi th√¥ng tin chi ti·∫øt
            document.getElementById('levelBonus').textContent = levelBonus;
            document.getElementById('nextLevel').textContent = newLevel;
            
            // Th√™m th√¥ng tin v·ªÅ ƒë·ªô kh√≥ m·ªõi
            const popup = document.getElementById('levelCompletePopup');
            const existingInfo = popup.querySelector('.difficulty-info');
            if (existingInfo) existingInfo.remove();
            
            const difficultyInfo = document.createElement('div');
            difficultyInfo.className = 'difficulty-info mt-4 p-3 bg-red-500/20 rounded-lg border border-red-400/30';
            
            let difficultyText = '';
            if (newLevel === 2) difficultyText = '‚ö° Ch·∫•t ƒë·ªôc r∆°i nhanh h∆°n! C√≥ th·ªÉ xu·∫•t hi·ªán 2 c√πng l√∫c!';
            else if (newLevel === 3) difficultyText = '‚ú® Ch·∫•t ƒë·ªôc ph√°t s√°ng! C√≥ th·ªÉ xu·∫•t hi·ªán 3 c√πng l√∫c!';
            else if (newLevel === 4) difficultyText = 'üåä Ch·∫Øc ch·∫Øn xu·∫•t hi·ªán 2 ch·∫•t ƒë·ªôc m·ªói l·∫ßn!';
            else if (newLevel === 5) difficultyText = 'üî• Ch·∫•t ƒë·ªôc l·ªõn h∆°n! C√≥ th·ªÉ xu·∫•t hi·ªán 3 c√πng l√∫c!';
            else if (newLevel === 6) difficultyText = 'üíÄ C√≥ th·ªÉ xu·∫•t hi·ªán 4 ch·∫•t ƒë·ªôc c√πng l√∫c!';
            else if (newLevel >= 7) difficultyText = 'üå™Ô∏è B√£o ch·∫•t ƒë·ªôc! T·ªëc ƒë·ªô c·ª±c nhanh!';
            
            difficultyInfo.innerHTML = `
                <div class="text-red-200 font-semibold text-sm">${difficultyText}</div>
            `;
            
            popup.querySelector('.p-6').appendChild(difficultyInfo);
            popup.classList.remove('hidden');
            
            gameState.isPaused = true;
        }

        function nextLevel() {
            document.getElementById('levelCompletePopup').classList.add('hidden');
            gameState.score += 100; // Bonus
            gameState.isPaused = false;
            updateGameDisplay();
            startGameLoop();
        }

        function gameOver() {
            gameState.isPlaying = false;
            
            // Ki·ªÉm tra n·∫øu ƒë·∫°t ƒëi·ªÉm cao (>= 2000) th√¨ chuy·ªÉn sang ph·∫ßn 3
            if (gameState.score >= 2000) {
                // Ph√°t √¢m thanh chi·∫øn th·∫Øng ph·∫ßn 2
                AudioSystem.playPart1CompleteSound(); // S·ª≠ d·ª•ng √¢m thanh chi·∫øn th·∫Øng
                
                // Hi·ªÉn th·ªã popup ho√†n th√†nh ph·∫ßn 2
                document.getElementById('part2PopupScore').textContent = gameState.score;
                document.getElementById('part2CompletePopup').classList.remove('hidden');
            } else {
                // Ph√°t √¢m thanh game over
                AudioSystem.playGameOverSound();
                
                // Thua game - hi·ªÉn th·ªã popup chuy·ªÉn c·∫£nh
                setTimeout(() => {
                    showTransitionPopup();
                }, 1500); // Delay 1.5 gi√¢y ƒë·ªÉ ng∆∞·ªùi ch∆°i th·∫•y k·∫øt qu·∫£
                
                // V·∫´n hi·ªÉn th·ªã popup game over ng·∫Øn
                document.getElementById('finalScore').textContent = gameState.score;
                document.getElementById('finalLevel').textContent = gameState.level;
                document.getElementById('gameOverPopup').classList.remove('hidden');
                
                // T·ª± ƒë·ªông ƒë√≥ng popup sau 1.5 gi√¢y
                setTimeout(() => {
                    document.getElementById('gameOverPopup').classList.add('hidden');
                }, 1500);
            }
            
            // D·ªçn d·∫πp
            document.getElementById('bulletsContainer').innerHTML = '';
            document.getElementById('toxinsContainer').innerHTML = '';
            document.getElementById('explosionsContainer').innerHTML = '';
        }

        function showTransitionPopup() {
            document.getElementById('transitionPopup').classList.remove('hidden');
        }

        function startQuizFromTransition() {
            document.getElementById('transitionPopup').classList.add('hidden');
            document.getElementById('part2Screen').classList.add('hidden');
            document.getElementById('part3Screen').classList.remove('hidden');
            initializeQuiz();
        }

        function closeTransitionPopup() {
            document.getElementById('transitionPopup').classList.add('hidden');
        }

        function restartPart2() {
            document.getElementById('gameOverPopup').classList.add('hidden');
            initializePart2();
        }

        function togglePause() {
            gameState.isPaused = !gameState.isPaused;
            const button = document.getElementById('pauseButton');
            
            if (gameState.isPaused) {
                button.textContent = '‚ñ∂Ô∏è Ti·∫øp t·ª•c';
            } else {
                button.textContent = '‚è∏Ô∏è T·∫°m d·ª´ng';
                startGameLoop();
            }
        }

        // Event listeners cho ph·∫ßn 2
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('part2Screen').classList.contains('hidden')) return;
            if (!gameState.isPlaying || gameState.isPaused) return;
            
            const gameCanvas = document.getElementById('gameCanvas');
            const canvasWidth = gameCanvas.offsetWidth;
            const heroWidth = 60; // K√≠ch th∆∞·ªõc nh√¢n v·∫≠t
            
            switch(e.key) {
                case 'ArrowLeft':
                    e.preventDefault();
                    gameState.heroPosition = Math.max(2, gameState.heroPosition - 4);
                    updateGameDisplay();
                    break;
                case 'ArrowRight':
                    e.preventDefault();
                    gameState.heroPosition = Math.min(98, gameState.heroPosition + 4);
                    updateGameDisplay();
                    break;
                case ' ':
                    e.preventDefault();
                    shootBullet();
                    break;
            }
        });

        // CSS cho hi·ªáu ·ª©ng n·ªï v√† popup
        const explosionCSS = `
            @keyframes explosionFade {
                0% { 
                    opacity: 1; 
                    transform: scale(1) rotate(0deg); 
                }
                50% {
                    opacity: 1;
                    transform: scale(1.5) rotate(180deg);
                }
                100% { 
                    opacity: 0; 
                    transform: scale(2.5) rotate(360deg); 
                }
            }
            
            @keyframes laserPulse {
                0% { 
                    box-shadow: 0 0 10px #00ff80, 0 0 20px #00ff80, 0 0 30px #00ff80;
                    filter: brightness(1.5);
                }
                100% { 
                    box-shadow: 0 0 15px #0080ff, 0 0 30px #0080ff, 0 0 45px #0080ff;
                    filter: brightness(2);
                }
            }
            
            @keyframes chickenInvadersBullet {
                0% { 
                    transform: scale(1) rotate(0deg);
                    filter: brightness(1.5) saturate(1.2);
                }
                100% { 
                    transform: scale(1.1) rotate(2deg);
                    filter: brightness(2) saturate(1.5);
                }
            }
            
            @keyframes slideInRight {
                0% { 
                    transform: translateX(100%) scale(0.8);
                    opacity: 0;
                }
                100% { 
                    transform: translateX(0) scale(1);
                    opacity: 1;
                }
            }
            
            @keyframes slideOutRight {
                0% { 
                    transform: translateX(0) scale(1);
                    opacity: 1;
                }
                100% { 
                    transform: translateX(100%) scale(0.8);
                    opacity: 0;
                }
            }
            
            @keyframes countdown {
                0% { 
                    width: 100%;
                }
                100% { 
                    width: 0%;
                }
            }
            
            @keyframes hitEffectFade {
                0% { 
                    opacity: 1; 
                    transform: scale(1) rotate(0deg); 
                    filter: brightness(2);
                }
                50% {
                    opacity: 1;
                    transform: scale(1.8) rotate(180deg);
                    filter: brightness(3);
                }
                100% { 
                    opacity: 0; 
                    transform: scale(2.5) rotate(360deg); 
                    filter: brightness(1);
                }
            }
            
            @keyframes heroShake {
                0%, 100% { transform: translateX(0); }
                10% { transform: translateX(-5px) rotate(-2deg); }
                20% { transform: translateX(5px) rotate(2deg); }
                30% { transform: translateX(-5px) rotate(-2deg); }
                40% { transform: translateX(5px) rotate(2deg); }
                50% { transform: translateX(-3px) rotate(-1deg); }
                60% { transform: translateX(3px) rotate(1deg); }
                70% { transform: translateX(-3px) rotate(-1deg); }
                80% { transform: translateX(3px) rotate(1deg); }
                90% { transform: translateX(-1px); }
            }
            
            @keyframes healthLoss {
                0% { 
                    transform: scale(1);
                    filter: brightness(1);
                }
                25% { 
                    transform: scale(1.3);
                    filter: brightness(2) hue-rotate(0deg);
                }
                50% { 
                    transform: scale(1.1);
                    filter: brightness(1.5) hue-rotate(180deg);
                }
                75% { 
                    transform: scale(1.2);
                    filter: brightness(1.8) hue-rotate(360deg);
                }
                100% { 
                    transform: scale(1);
                    filter: brightness(1);
                }
            }
            
            .animate-countdown {
                animation: countdown 3s linear forwards;
            }
            
            @keyframes scoreIncrease {
                0% { 
                    transform: scale(1);
                    color: inherit;
                }
                50% { 
                    transform: scale(1.3);
                    color: #10b981;
                    text-shadow: 0 0 10px #10b981;
                }
                100% { 
                    transform: scale(1);
                    color: inherit;
                }
            }
            
            @keyframes organDisappear {
                0% { 
                    opacity: 1;
                    transform: scale(1) rotate(0deg);
                    filter: brightness(1) blur(0px);
                }
                30% {
                    opacity: 0.8;
                    transform: scale(1.2) rotate(10deg);
                    filter: brightness(2) blur(0px);
                    box-shadow: 0 0 30px #ffd700, 0 0 60px #ffd700;
                }
                60% {
                    opacity: 0.5;
                    transform: scale(1.5) rotate(180deg);
                    filter: brightness(3) blur(2px);
                    box-shadow: 0 0 50px #ff6b6b, 0 0 100px #4ecdc4;
                }
                100% { 
                    opacity: 0;
                    transform: scale(2) rotate(360deg);
                    filter: brightness(5) blur(10px);
                    box-shadow: 0 0 80px transparent;
                }
            }
            
            @keyframes particleExplode {
                0% {
                    opacity: 1;
                    transform: translate(0, 0) scale(1);
                    box-shadow: 0 0 15px #ffd700;
                }
                50% {
                    opacity: 1;
                    transform: translate(calc(var(--end-x) - var(--start-x, 0px)), calc(var(--end-y) - var(--start-y, 0px))) scale(1.5);
                    box-shadow: 0 0 25px #ff6b6b;
                }
                100% {
                    opacity: 0;
                    transform: translate(calc(var(--end-x) - var(--start-x, 0px)), calc(var(--end-y) - var(--start-y, 0px))) scale(0.5);
                    box-shadow: 0 0 5px transparent;
                }
            }
            
            @keyframes rippleExpand {
                0% {
                    opacity: 1;
                    transform: scale(1);
                    border-width: 3px;
                }
                50% {
                    opacity: 0.7;
                    transform: scale(3);
                    border-width: 2px;
                }
                100% {
                    opacity: 0;
                    transform: scale(6);
                    border-width: 1px;
                }
            }
            
            @keyframes toxinGlow {
                0% {
                    filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.4)) brightness(1);
                    transform: scale(1);
                }
                100% {
                    filter: drop-shadow(0 0 15px #ff6b6b) drop-shadow(0 0 25px #ff6b6b) brightness(1.3);
                    transform: scale(1.05);
                }
            }
        `;
        
        // Th√™m CSS v√†o head
        const style = document.createElement('style');
        style.textContent = explosionCSS;
        document.head.appendChild(style);

        function backToStart() {
            document.querySelectorAll('[id$="Screen"]').forEach(screen => {
                screen.classList.add('hidden');
            });
            document.getElementById('titleScreen').classList.remove('hidden');
        }

        // H√†m cho ph·∫ßn 2
        function proceedToPart3() {
            document.getElementById('part2CompletePopup').classList.add('hidden');
            document.getElementById('part2Screen').classList.add('hidden');
            document.getElementById('part3Screen').classList.remove('hidden');
            initializeQuiz();
        }

        function closePart2Popup() {
            document.getElementById('part2CompletePopup').classList.add('hidden');
        }

        // Bi·∫øn quiz
        let quizState = {
            currentQuestion: 0,
            score: 0,
            correctAnswers: 0,
            selectedAnswer: null,
            isAnswered: false
        };

        // C√¢u h·ªèi quiz v·ªõi ki·∫øn th·ª©c t·ª´ game
        const quizQuestions = [
            {
                question: "Thu·ªëc l√° th∆∞·ªùng ch·ª©a bao nhi√™u ch·∫•t h√≥a h·ªçc ƒë·ªôc h·∫°i?",
                answers: ["Kho·∫£ng 100 ch·∫•t", "Kho·∫£ng 500 ch·∫•t", "H∆°n 7.000 ch·∫•t", "Kho·∫£ng 50 ch·∫•t"],
                correct: 2,
                explanation: "Thu·ªëc l√° ch·ª©a h∆°n 7.000 ch·∫•t h√≥a h·ªçc, trong ƒë√≥ c√≥ √≠t nh·∫•t 250 ch·∫•t ƒë·ªôc h·∫°i v√† 70 ch·∫•t g√¢y ung th∆∞."
            },
            {
                question: "Ch·∫•t n√†o trong thu·ªëc l√° ƒë∆∞·ª£c g·ªçi l√† 'ch·∫•t b·∫£o qu·∫£n x√°c ch·∫øt'?",
                answers: ["Nicotine", "Formaldehyde", "Tar", "Ammonia"],
                correct: 1,
                explanation: "Formaldehyde l√† ch·∫•t b·∫£o qu·∫£n x√°c ch·∫øt, g√¢y ung th∆∞ m≈©i, h·ªçng v√† k√≠ch ·ª©ng ƒë∆∞·ªùng h√¥ h·∫•p."
            },
            {
                question: "Nicotine ·∫£nh h∆∞·ªüng ƒë·∫øn n√£o b·ªô nh∆∞ th·∫ø n√†o?",
                answers: ["Ch·ªâ g√¢y nghi·ªán nh·∫π", "Thay ƒë·ªïi c·∫•u tr√∫c n√£o v√† g√¢y nghi·ªán m·∫°nh", "Kh√¥ng ·∫£nh h∆∞·ªüng g√¨", "Ch·ªâ ·∫£nh h∆∞·ªüng ·ªü ng∆∞·ªùi l·ªõn"],
                correct: 1,
                explanation: "Nicotine thay ƒë·ªïi c·∫•u tr√∫c n√£o, ƒë·∫∑c bi·ªát nguy hi·ªÉm ·ªü tu·ªïi thi·∫øu ni√™n, ·∫£nh h∆∞·ªüng ƒë·∫øn h·ªçc t·∫≠p, tr√≠ nh·ªõ v√† ki·ªÉm so√°t c·∫£m x√∫c."
            },
            {
                question: "Thu·ªëc l√° ƒëi·ªán t·ª≠ (vape) c√≥ an to√†n h∆°n thu·ªëc l√° th∆∞·ªùng kh√¥ng?",
                answers: ["C√≥, ho√†n to√†n an to√†n", "C√≥, an to√†n h∆°n 95%", "Kh√¥ng, v·∫´n c√≥ nhi·ªÅu ch·∫•t ƒë·ªôc", "Ch·ªâ an to√†n cho ng∆∞·ªùi tr·∫ª"],
                correct: 2,
                explanation: "Thu·ªëc l√° ƒëi·ªán t·ª≠ v·∫´n ch·ª©a nicotine, kim lo·∫°i n·∫∑ng, diacetyl v√† c√°c ch·∫•t ƒë·ªôc kh√°c. Kh√¥ng c√≥ m·ª©c ƒë·ªô 'an to√†n' n√†o!"
            },
            {
                question: "Ch·∫•t n√†o g√¢y ra 'b·ªánh ph·ªïi b·ªèng ng√¥' trong thu·ªëc l√° ƒëi·ªán t·ª≠?",
                answers: ["Nicotine", "Diacetyl", "PG/VG", "H∆∞∆°ng li·ªáu"],
                correct: 1,
                explanation: "Diacetyl trong h∆∞∆°ng li·ªáu thu·ªëc l√° ƒëi·ªán t·ª≠ g√¢y 'b·ªánh ph·ªïi b·ªèng ng√¥' - x∆° h√≥a ph·ªïi kh√¥ng h·ªìi ph·ª•c."
            },
            {
                question: "Tim ƒë·∫≠p bao nhi√™u l·∫ßn m·ªói ng√†y?",
                answers: ["50.000 l·∫ßn", "75.000 l·∫ßn", "100.000 l·∫ßn", "150.000 l·∫ßn"],
                correct: 2,
                explanation: "Tim ƒë·∫≠p kho·∫£ng 100.000 l·∫ßn m·ªói ng√†y, b∆°m h∆°n 7.500 l√≠t m√°u ƒë·ªÉ cung c·∫•p oxy cho c∆° th·ªÉ."
            },
            {
                question: "Ch·∫•t n√†o trong thu·ªëc l√° ƒë∆∞·ª£c g·ªçi l√† 'ch·∫•t ƒë·ªôc chu·ªôt'?",
                answers: ["Benzene", "Arsenic", "Cadmium", "DDT"],
                correct: 1,
                explanation: "Arsenic l√† ch·∫•t ƒë·ªôc chu·ªôt, g√¢y ung th∆∞ da, ph·ªïi, gan v√† b√†ng quang khi t√≠ch t·ª• t·ª´ thu·ªëc l√°."
            },
            {
                question: "Ph·ªïi h√≠t th·ªü bao nhi√™u l√≠t kh√¥ng kh√≠ m·ªói ng√†y?",
                answers: ["3.000 l√≠t", "6.000 l√≠t", "9.000 l√≠t", "12.000 l√≠t"],
                correct: 1,
                explanation: "Ph·ªïi h√≠t v√† th·ªü ra h∆°n 6.000 l√≠t kh√¥ng kh√≠ m·ªói ng√†y ƒë·ªÉ cung c·∫•p oxy v√† lo·∫°i b·ªè CO‚ÇÇ."
            },
            {
                question: "Ch·∫•t ph√≥ng x·∫° n√†o c√≥ trong thu·ªëc l√°?",
                answers: ["Uranium", "Polonium-210", "Radium", "Cesium"],
                correct: 1,
                explanation: "Polonium-210 l√† ch·∫•t ph√≥ng x·∫° c·ª±c ƒë·ªôc trong thu·ªëc l√°, g√¢y ung th∆∞ ph·ªïi v√† c√°c c∆° quan kh√°c."
            },
            {
                question: "Kh√≥i thu·ªëc l√° th·ª• ƒë·ªông c√≥ nguy hi·ªÉm kh√¥ng?",
                answers: ["Kh√¥ng nguy hi·ªÉm", "Ch·ªâ nguy hi·ªÉm cho tr·∫ª em", "R·∫•t nguy hi·ªÉm cho m·ªçi ng∆∞·ªùi", "Ch·ªâ g√¢y kh√≥ ch·ªãu"],
                correct: 2,
                explanation: "Kh√≥i thu·ªëc l√° th·ª• ƒë·ªông ch·ª©a c√πng c√°c ch·∫•t ƒë·ªôc, g√¢y ung th∆∞ ph·ªïi, b·ªánh tim v√† nhi·ªÅu v·∫•n ƒë·ªÅ s·ª©c kh·ªèe kh√°c."
            },
            {
                question: "H·∫°t si√™u nh·ªè (ultrafine particles) trong kh√≥i thu·ªëc c√≥ k√≠ch th∆∞·ªõc nh∆∞ th·∫ø n√†o?",
                answers: ["< 0.1 micron", "< 1 micron", "< 10 micron", "< 100 micron"],
                correct: 0,
                explanation: "H·∫°t si√™u nh·ªè (<0.1 micron) x√¢m nh·∫≠p s√¢u v√†o ph·ªïi v√† m√°u, g√¢y vi√™m v√† b·ªánh tim m·∫°ch."
            },
            {
                question: "Gan c√≥ th·ªÉ h·ªìi ph·ª•c sau khi b·ªè thu·ªëc l√° kh√¥ng?",
                answers: ["Kh√¥ng th·ªÉ h·ªìi ph·ª•c", "H·ªìi ph·ª•c m·ªôt ph·∫ßn", "H·ªìi ph·ª•c ho√†n to√†n", "Ch·ªâ h·ªìi ph·ª•c ·ªü ng∆∞·ªùi tr·∫ª"],
                correct: 1,
                explanation: "Gan c√≥ th·ªÉ h·ªìi ph·ª•c m·ªôt ph·∫ßn sau khi b·ªè thu·ªëc l√°, nh∆∞ng t·ªïn th∆∞∆°ng n·∫∑ng c√≥ th·ªÉ kh√¥ng h·ªìi ph·ª•c ho√†n to√†n."
            },
            {
                question: "Tu·ªïi n√†o d·ªÖ b·ªã ·∫£nh h∆∞·ªüng n√£o b·ªô nh·∫•t b·ªüi nicotine?",
                answers: ["D∆∞·ªõi 10 tu·ªïi", "10-18 tu·ªïi", "18-25 tu·ªïi", "Tr√™n 25 tu·ªïi"],
                correct: 2,
                explanation: "N√£o b·ªô ph√°t tri·ªÉn ƒë·∫øn 25 tu·ªïi, n√™n tu·ªïi 18-25 v·∫´n r·∫•t d·ªÖ b·ªã ·∫£nh h∆∞·ªüng b·ªüi nicotine."
            },
            {
                question: "C√°ch t·ªët nh·∫•t ƒë·ªÉ b·∫£o v·ªá s·ª©c kh·ªèe kh·ªèi t√°c h·∫°i c·ªßa thu·ªëc l√° l√† g√¨?",
                answers: ["H√∫t √≠t h∆°n", "Chuy·ªÉn sang thu·ªëc l√° ƒëi·ªán t·ª≠", "Kh√¥ng bao gi·ªù b·∫Øt ƒë·∫ßu h√∫t", "H√∫t thu·ªëc l√° nh·∫π"],
                correct: 2,
                explanation: "C√°ch t·ªët nh·∫•t l√† kh√¥ng bao gi·ªù b·∫Øt ƒë·∫ßu h√∫t thu·ªëc l√°. Kh√¥ng c√≥ m·ª©c ƒë·ªô 'an to√†n' n√†o khi s·ª≠ d·ª•ng thu·ªëc l√°!"
            },
            {
                question: "Th√¥ng ƒëi·ªáp quan tr·ªçng nh·∫•t v·ªÅ thu·ªëc l√° l√† g√¨?",
                answers: ["Thu·ªëc l√° ch·ªâ h·∫°i ph·ªïi", "Thu·ªëc l√° ƒëi·ªán t·ª≠ an to√†n", "Kh√¥ng c√≥ m·ª©c ƒë·ªô an to√†n n√†o", "Ch·ªâ ng∆∞·ªùi l·ªõn m·ªõi b·ªã ·∫£nh h∆∞·ªüng"],
                correct: 2,
                explanation: "KH√îNG C√ì M·ª®C ƒê·ªò 'AN TO√ÄN' N√ÄO khi s·ª≠ d·ª•ng thu·ªëc l√° hay thu·ªëc l√° ƒëi·ªán t·ª≠. H√£y b·∫£o v·ªá s·ª©c kh·ªèe b·∫±ng c√°ch tr√°nh xa ho√†n to√†n!"
            }
        ];

        function initializeQuiz() {
            quizState = {
                currentQuestion: 0,
                score: 0,
                correctAnswers: 0,
                selectedAnswer: null,
                isAnswered: false
            };
            
            updateQuizDisplay();
            showQuestion();
        }

        function updateQuizDisplay() {
            document.getElementById('quizScore').textContent = quizState.score;
            document.getElementById('correctAnswers').textContent = quizState.correctAnswers;
            document.getElementById('questionProgress').textContent = `${quizState.currentQuestion + 1}/15`;
            document.getElementById('currentQuestionNumber').textContent = quizState.currentQuestion + 1;
            
            const progress = ((quizState.currentQuestion + 1) / 15) * 100;
            document.getElementById('quizProgressBar').style.width = progress + '%';
        }

        function showQuestion() {
            const question = quizQuestions[quizState.currentQuestion];
            document.getElementById('questionText').textContent = question.question;
            
            const container = document.getElementById('answersContainer');
            container.innerHTML = '';
            
            question.answers.forEach((answer, index) => {
                const button = document.createElement('button');
                button.className = 'w-full p-4 text-left bg-white hover:bg-blue-50 border-2 border-gray-200 hover:border-blue-300 rounded-xl transition-all duration-300 transform hover:scale-105 hover:shadow-lg';
                button.innerHTML = `
                    <div class="flex items-center space-x-3">
                        <div class="w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center font-bold text-blue-600">
                            ${String.fromCharCode(65 + index)}
                        </div>
                        <span class="text-gray-800 font-medium">${answer}</span>
                    </div>
                `;
                button.onclick = () => selectAnswer(index, button);
                container.appendChild(button);
            });
            
            document.getElementById('nextQuestionBtn').classList.add('hidden');
            quizState.isAnswered = false;
        }

        function selectAnswer(answerIndex, buttonElement) {
            if (quizState.isAnswered) return;
            
            quizState.selectedAnswer = answerIndex;
            quizState.isAnswered = true;
            
            const question = quizQuestions[quizState.currentQuestion];
            const isCorrect = answerIndex === question.correct;
            
            // Ph√°t √¢m thanh t∆∞∆°ng ·ª©ng
            if (isCorrect) {
                AudioSystem.playCorrectAnswerSound();
            } else {
                AudioSystem.playWrongAnswerSound();
            }
            
            // Hi·ªÉn th·ªã k·∫øt qu·∫£
            const buttons = document.querySelectorAll('#answersContainer button');
            buttons.forEach((btn, index) => {
                btn.disabled = true;
                if (index === question.correct) {
                    btn.className = btn.className.replace('bg-white hover:bg-blue-50 border-gray-200 hover:border-blue-300', 'bg-green-100 border-green-500');
                    btn.innerHTML = btn.innerHTML.replace('bg-blue-100', 'bg-green-500').replace('text-blue-600', 'text-white') + ' <span class="ml-2 text-green-600 font-bold">‚úì ƒê√∫ng</span>';
                } else if (index === answerIndex && !isCorrect) {
                    btn.className = btn.className.replace('bg-white hover:bg-blue-50 border-gray-200 hover:border-blue-300', 'bg-red-100 border-red-500');
                    btn.innerHTML = btn.innerHTML.replace('bg-blue-100', 'bg-red-500').replace('text-blue-600', 'text-white') + ' <span class="ml-2 text-red-600 font-bold">‚úó Sai</span>';
                }
            });
            
            // Hi·ªÉn th·ªã gi·∫£i th√≠ch
            const explanation = document.createElement('div');
            explanation.className = 'mt-6 p-4 bg-blue-50 border border-blue-200 rounded-xl';
            explanation.innerHTML = `
                <div class="flex items-start space-x-3">
                    <div class="text-2xl">${isCorrect ? '‚úÖ' : 'üí°'}</div>
                    <div>
                        <h4 class="font-bold text-blue-800 mb-2">${isCorrect ? 'Ch√≠nh x√°c!' : 'Gi·∫£i th√≠ch:'}</h4>
                        <p class="text-blue-700">${question.explanation}</p>
                    </div>
                </div>
            `;
            document.getElementById('answersContainer').appendChild(explanation);
            
            // C·∫≠p nh·∫≠t ƒëi·ªÉm
            if (isCorrect) {
                quizState.correctAnswers++;
                quizState.score += 100;
                
                // Hi·ªáu ·ª©ng ƒëi·ªÉm s·ªë
                const scoreElement = document.getElementById('quizScore');
                scoreElement.style.animation = 'scoreIncrease 0.5s ease-out';
                setTimeout(() => {
                    scoreElement.style.animation = '';
                }, 500);
            }
            
            updateQuizDisplay();
            
            // Hi·ªÉn th·ªã n√∫t ti·∫øp t·ª•c
            const nextBtn = document.getElementById('nextQuestionBtn');
            if (quizState.currentQuestion < quizQuestions.length - 1) {
                nextBtn.textContent = 'C√¢u ti·∫øp theo ‚Üí';
                nextBtn.onclick = nextQuestion;
            } else {
                nextBtn.textContent = 'Xem k·∫øt qu·∫£ üèÜ';
                nextBtn.onclick = showQuizResult;
            }
            nextBtn.classList.remove('hidden');
        }

        function nextQuestion() {
            quizState.currentQuestion++;
            showQuestion();
            updateQuizDisplay();
        }

        function showQuizResult() {
            document.getElementById('part3Screen').classList.add('hidden');
            document.getElementById('quizResultScreen').classList.remove('hidden');
            
            // Ph√°t √¢m thanh ho√†n th√†nh quiz
            AudioSystem.playQuizCompleteSound();
            
            const accuracy = Math.round((quizState.correctAnswers / quizQuestions.length) * 100);
            
            // C·∫≠p nh·∫≠t th·ªëng k√™
            document.getElementById('finalScore').textContent = quizState.score;
            document.getElementById('finalCorrect').textContent = `${quizState.correctAnswers}/${quizQuestions.length}`;
            document.getElementById('finalAccuracy').textContent = accuracy + '%';
            
            // X√°c ƒë·ªãnh k·∫øt qu·∫£ v√† th√¥ng ƒëi·ªáp
            let resultIcon, resultTitle, resultMessage, finalMessage;
            
            if (accuracy >= 90) {
                resultIcon = 'üèÜ';
                resultTitle = 'Xu·∫•t s·∫Øc!';
                resultMessage = 'B·∫°n ƒë√£ n·∫Øm v·ªØng ki·∫øn th·ª©c v·ªÅ t√°c h·∫°i c·ªßa thu·ªëc l√°!';
                finalMessage = `
                    <div class="text-center">
                        <div class="text-4xl mb-3">üåü</div>
                        <h3 class="text-xl font-bold text-green-800 mb-3">B·∫°n l√† ƒê·∫°i s·ª© S·ª©c kh·ªèe!</h3>
                        <p class="text-gray-700 mb-4">
                            V·ªõi ki·∫øn th·ª©c v·ªØng v√†ng n√†y, b·∫°n c√≥ th·ªÉ gi√∫p b·∫°n b√® v√† gia ƒë√¨nh hi·ªÉu r√µ t√°c h·∫°i c·ªßa thu·ªëc l√°.
                            H√£y chia s·∫ª th√¥ng ƒëi·ªáp: <strong>"Kh√¥ng c√≥ m·ª©c ƒë·ªô an to√†n n√†o khi s·ª≠ d·ª•ng thu·ªëc l√°!"</strong>
                        </p>
                        <div class="bg-green-100 rounded-lg p-3">
                            <p class="text-green-800 font-semibold">üíö H√£y ti·∫øp t·ª•c s·ªëng kh·ªèe m·∫°nh v√† truy·ªÅn c·∫£m h·ª©ng cho ng∆∞·ªùi kh√°c!</p>
                        </div>
                    </div>
                `;
            } else if (accuracy >= 70) {
                resultIcon = 'üëç';
                resultTitle = 'T·ªët l·∫Øm!';
                resultMessage = 'B·∫°n ƒë√£ hi·ªÉu ƒë∆∞·ª£c nhi·ªÅu ki·∫øn th·ª©c quan tr·ªçng v·ªÅ thu·ªëc l√°.';
                finalMessage = `
                    <div class="text-center">
                        <div class="text-4xl mb-3">üìö</div>
                        <h3 class="text-xl font-bold text-blue-800 mb-3">Ti·∫øp t·ª•c h·ªçc h·ªèi!</h3>
                        <p class="text-gray-700 mb-4">
                            B·∫°n ƒë√£ n·∫Øm ƒë∆∞·ª£c nh·ªØng ki·∫øn th·ª©c c∆° b·∫£n. H√£y nh·ªõ: thu·ªëc l√° v√† thu·ªëc l√° ƒëi·ªán t·ª≠ ƒë·ªÅu c√≥ h·∫°i cho s·ª©c kh·ªèe.
                            <strong>Kh√¥ng c√≥ m·ª©c ƒë·ªô "an to√†n" n√†o!</strong>
                        </p>
                        <div class="bg-blue-100 rounded-lg p-3">
                            <p class="text-blue-800 font-semibold">üéØ H√£y chia s·∫ª ki·∫øn th·ª©c n√†y v·ªõi nh·ªØng ng∆∞·ªùi b·∫°n quan t√¢m!</p>
                        </div>
                    </div>
                `;
            } else {
                resultIcon = 'üí™';
                resultTitle = 'C·∫ßn c·ªë g·∫Øng th√™m!';
                resultMessage = 'H√£y xem l·∫°i c√°c ki·∫øn th·ª©c v·ªÅ t√°c h·∫°i c·ªßa thu·ªëc l√°.';
                finalMessage = `
                    <div class="text-center">
                        <div class="text-4xl mb-3">üîÑ</div>
                        <h3 class="text-xl font-bold text-orange-800 mb-3">ƒê·ª´ng b·ªè cu·ªôc!</h3>
                        <p class="text-gray-700 mb-4">
                            Ki·∫øn th·ª©c v·ªÅ t√°c h·∫°i c·ªßa thu·ªëc l√° r·∫•t quan tr·ªçng cho s·ª©c kh·ªèe. H√£y ch∆°i l·∫°i game v√† l√†m l·∫°i quiz ƒë·ªÉ hi·ªÉu r√µ h∆°n.
                            ƒêi·ªÅu quan tr·ªçng nh·∫•t: <strong>Tr√°nh xa thu·ªëc l√° v√† thu·ªëc l√° ƒëi·ªán t·ª≠!</strong>
                        </p>
                        <div class="bg-orange-100 rounded-lg p-3">
                            <p class="text-orange-800 font-semibold">üö≠ Nh·ªõ: Kh√¥ng c√≥ thu·ªëc l√° n√†o "√≠t h·∫°i" hay "an to√†n"!</p>
                        </div>
                    </div>
                `;
            }
            
            document.getElementById('resultIcon').textContent = resultIcon;
            document.getElementById('resultTitle').textContent = resultTitle;
            document.getElementById('resultMessage').textContent = resultMessage;
            document.getElementById('finalMessage').innerHTML = finalMessage;
        }

        function restartQuiz() {
            document.getElementById('quizResultScreen').classList.add('hidden');
            document.getElementById('part3Screen').classList.remove('hidden');
            initializeQuiz();
        }

        function startQuizDirect() {
            document.getElementById('titleScreen').classList.add('hidden');
            document.getElementById('part3Screen').classList.remove('hidden');
            initializeQuiz();
        }

        // H·ªá th·ªëng √¢m thanh game
        const AudioSystem = {
            // T·∫°o √¢m thanh b·∫±ng Web Audio API
            audioContext: null,
            masterVolume: 0.3,
            
            // Kh·ªüi t·∫°o audio context
            init() {
                try {
                    this.audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    console.log('üéµ H·ªá th·ªëng √¢m thanh ƒë√£ s·∫µn s√†ng!');
                } catch (e) {
                    console.log('‚ö†Ô∏è Tr√¨nh duy·ªát kh√¥ng h·ªó tr·ª£ Web Audio API');
                }
            },
            
            // T·∫°o √¢m thanh v·ªõi t·∫ßn s·ªë v√† th·ªùi gian
            createTone(frequency, duration, type = 'sine', volume = 0.3) {
                if (!this.audioContext) return;
                
                const oscillator = this.audioContext.createOscillator();
                const gainNode = this.audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(this.audioContext.destination);
                
                oscillator.frequency.setValueAtTime(frequency, this.audioContext.currentTime);
                oscillator.type = type;
                
                gainNode.gain.setValueAtTime(0, this.audioContext.currentTime);
                gainNode.gain.linearRampToValueAtTime(volume * this.masterVolume, this.audioContext.currentTime + 0.01);
                gainNode.gain.exponentialRampToValueAtTime(0.001, this.audioContext.currentTime + duration);
                
                oscillator.start(this.audioContext.currentTime);
                oscillator.stop(this.audioContext.currentTime + duration);
            },
            
            // T·∫°o √¢m thanh ph·ª©c t·∫°p v·ªõi nhi·ªÅu t·∫ßn s·ªë
            createChord(frequencies, duration, type = 'sine', volume = 0.2) {
                frequencies.forEach(freq => {
                    this.createTone(freq, duration, type, volume);
                });
            },
            
            // T·∫°o ti·∫øng ·ªìn tr·∫Øng
            createNoise(duration, volume = 0.1) {
                if (!this.audioContext) return;
                
                const bufferSize = this.audioContext.sampleRate * duration;
                const buffer = this.audioContext.createBuffer(1, bufferSize, this.audioContext.sampleRate);
                const data = buffer.getChannelData(0);
                
                for (let i = 0; i < bufferSize; i++) {
                    data[i] = Math.random() * 2 - 1;
                }
                
                const source = this.audioContext.createBufferSource();
                const gainNode = this.audioContext.createGain();
                
                source.buffer = buffer;
                source.connect(gainNode);
                gainNode.connect(this.audioContext.destination);
                
                gainNode.gain.setValueAtTime(volume * this.masterVolume, this.audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.001, this.audioContext.currentTime + duration);
                
                source.start();
            },
            
            // √Çm thanh di chuy·ªÉn
            playMoveSound() {
                this.createTone(200, 0.1, 'square', 0.1);
            },
            
            // √Çm thanh t∆∞∆°ng t√°c v·ªõi c∆° quan
            playInteractSound() {
                this.createChord([523, 659, 784], 0.3, 'sine', 0.2); // C-E-G chord
            },
            
            // √Çm thanh ho√†n th√†nh c∆° quan
            playOrganCompleteSound() {
                // Giai ƒëi·ªáu th·∫Øng l·ª£i
                setTimeout(() => this.createTone(523, 0.2, 'sine', 0.3), 0);    // C
                setTimeout(() => this.createTone(659, 0.2, 'sine', 0.3), 100);  // E
                setTimeout(() => this.createTone(784, 0.2, 'sine', 0.3), 200);  // G
                setTimeout(() => this.createTone(1047, 0.4, 'sine', 0.4), 300); // C octave
            },
            
            // √Çm thanh ho√†n th√†nh ph·∫ßn 1
            playPart1CompleteSound() {
                // Fanfare chi·∫øn th·∫Øng
                const melody = [523, 659, 784, 1047, 1319]; // C-E-G-C-E
                melody.forEach((freq, index) => {
                    setTimeout(() => this.createTone(freq, 0.5, 'triangle', 0.4), index * 150);
                });
            },
            
            // √Çm thanh b·∫Øn ƒë·∫°n
            playShootSound() {
                this.createTone(800, 0.1, 'square', 0.2);
                setTimeout(() => this.createTone(1200, 0.05, 'square', 0.15), 50);
            },
            
            // √Çm thanh n·ªï
            playExplosionSound() {
                this.createNoise(0.3, 0.3);
                this.createTone(100, 0.2, 'sawtooth', 0.4);
            },
            
            // √Çm thanh b·ªã tr√∫ng
            playHitSound() {
                this.createTone(150, 0.5, 'sawtooth', 0.4);
                setTimeout(() => this.createTone(100, 0.3, 'square', 0.3), 200);
            },
            
            // √Çm thanh l√™n level
            playLevelUpSound() {
                const ascendingNotes = [262, 330, 392, 523, 659]; // C-E-G-C-E
                ascendingNotes.forEach((freq, index) => {
                    setTimeout(() => this.createTone(freq, 0.3, 'triangle', 0.3), index * 100);
                });
            },
            
            // √Çm thanh game over
            playGameOverSound() {
                const descendingNotes = [523, 466, 415, 349, 294]; // Descending sad melody
                descendingNotes.forEach((freq, index) => {
                    setTimeout(() => this.createTone(freq, 0.6, 'triangle', 0.3), index * 200);
                });
            },
            
            // √Çm thanh quiz ƒë√∫ng
            playCorrectAnswerSound() {
                this.createChord([523, 659, 784], 0.4, 'sine', 0.3); // Happy chord
            },
            
            // √Çm thanh quiz sai
            playWrongAnswerSound() {
                this.createTone(200, 0.6, 'sawtooth', 0.3);
            },
            
            // √Çm thanh ho√†n th√†nh quiz
            playQuizCompleteSound() {
                // Victory fanfare
                const victoryMelody = [523, 523, 523, 415, 466, 523, 466, 523];
                victoryMelody.forEach((freq, index) => {
                    setTimeout(() => this.createTone(freq, 0.2, 'triangle', 0.3), index * 150);
                });
            },
            
            // √Çm thanh n·ªÅn menu (ambient)
            playMenuAmbient() {
                if (!this.audioContext) return;
                
                const playAmbientTone = () => {
                    const frequencies = [130.81, 164.81, 196.00]; // C3-E3-G3
                    const randomFreq = frequencies[Math.floor(Math.random() * frequencies.length)];
                    this.createTone(randomFreq, 2, 'sine', 0.05);
                };
                
                // Ph√°t √¢m thanh ambient m·ªói 3-8 gi√¢y
                const scheduleNext = () => {
                    const delay = 3000 + Math.random() * 5000;
                    setTimeout(() => {
                        playAmbientTone();
                        scheduleNext();
                    }, delay);
                };
                
                scheduleNext();
            },
            
            // √Çm thanh n·ªÅn game (rhythmic)
            playGameAmbient() {
                if (!this.audioContext) return;
                
                const playRhythm = () => {
                    // Bass drum
                    this.createTone(60, 0.1, 'sine', 0.1);
                    // Hi-hat
                    setTimeout(() => this.createNoise(0.05, 0.03), 250);
                    setTimeout(() => this.createNoise(0.05, 0.03), 500);
                    setTimeout(() => this.createNoise(0.05, 0.03), 750);
                };
                
                // L·∫∑p l·∫°i m·ªói gi√¢y
                setInterval(playRhythm, 1000);
            },
            
            // √Çm thanh c·∫£nh b√°o (khi ch·∫•t ƒë·ªôc g·∫ßn ch·∫°m ƒë·∫•t)
            playWarningSound() {
                this.createTone(800, 0.1, 'square', 0.2);
                setTimeout(() => this.createTone(600, 0.1, 'square', 0.2), 100);
            },
            
            // √Çm thanh power-up (khi ti√™u di·ªát nhi·ªÅu ch·∫•t ƒë·ªôc li√™n ti·∫øp)
            playPowerUpSound() {
                const powerUpNotes = [262, 330, 392, 523, 659, 784, 1047];
                powerUpNotes.forEach((freq, index) => {
                    setTimeout(() => this.createTone(freq, 0.1, 'square', 0.2), index * 50);
                });
            },
            
            // √Çm thanh click button
            playClickSound() {
                this.createTone(1000, 0.1, 'square', 0.1);
            },
            
            // √Çm thanh hover button
            playHoverSound() {
                this.createTone(800, 0.05, 'sine', 0.05);
            }
        };
        
        // Kh·ªüi t·∫°o √¢m thanh khi trang load
        function initializeAudio() {
            AudioSystem.init();
            
            // B·∫Øt ƒë·∫ßu ambient menu
            setTimeout(() => {
                AudioSystem.playMenuAmbient();
            }, 1000);
        }

        // Kh·ªüi t·∫°o game khi b·∫Øt ƒë·∫ßu ph·∫ßn 1
        function initializeGame() {
            // Reset tr·∫°ng th√°i
            visitedOrgans.clear();
            nearOrgan = null;
            characterPosition = { x: 30, y: 420 };
            
            // ƒê·∫∑t l·∫°i v·ªã tr√≠ nh√¢n v·∫≠t
            const character = document.getElementById('character');
            character.style.left = characterPosition.x + 'px';
            character.style.top = characterPosition.y + 'px';
            
            // Reset c√°c c∆° quan
            document.querySelectorAll('.organ-interactive').forEach(organ => {
                organ.classList.remove('near-character');
                organ.style.opacity = '1';
                organ.style.visibility = 'visible';
                organ.style.animation = '';
                organ.querySelector('.interaction-hint').classList.remove('show');
            });
            
            // Reset thanh ti·∫øn ƒë·ªô
            updateProgress();
            
            // Focus v√†o game area ƒë·ªÉ nh·∫≠n keyboard input
            document.getElementById('gameArea').focus();
        }

        // H√†m kh·ªüi t·∫°o game ƒë√£ ƒë∆∞·ª£c g·ªçi trong startGame()

        // Click v√†o popup ƒë·ªÉ ti·∫øp t·ª•c h·ªôi tho·∫°i
        document.getElementById('organPopup').addEventListener('click', function(e) {
            if (e.target === this) {
                nextDialogue();
            }
        });

        // Th√™m √¢m thanh cho t·∫•t c·∫£ c√°c n√∫t
        function addButtonSounds() {
            // Th√™m √¢m thanh click cho t·∫•t c·∫£ c√°c button
            document.addEventListener('click', function(e) {
                if (e.target.tagName === 'BUTTON' || e.target.closest('button')) {
                    AudioSystem.playClickSound();
                }
            });
            
            // Th√™m √¢m thanh hover cho c√°c button
            document.addEventListener('mouseover', function(e) {
                if (e.target.tagName === 'BUTTON' || e.target.closest('button')) {
                    AudioSystem.playHoverSound();
                }
            });
        }
        
        // Kh·ªüi t·∫°o khi trang load
        window.addEventListener('load', () => {
            initializeAudio();
            addButtonSounds();
        });
        
        // Kh·ªüi t·∫°o audio context khi user t∆∞∆°ng t√°c l·∫ßn ƒë·∫ßu
        document.addEventListener('click', function initAudioOnFirstClick() {
            if (!AudioSystem.audioContext) {
                AudioSystem.init();
            }
            document.removeEventListener('click', initAudioOnFirstClick);
        }, { once: true });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96d97b2e96a8e6a6',t:'MTc1NDkzMzY0MC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
