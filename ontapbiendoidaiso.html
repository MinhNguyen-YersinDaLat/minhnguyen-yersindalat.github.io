<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Game D·∫°y H·ªçc: Bi·∫øn ƒë·ªïi ƒë·∫°i s·ªë</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Hi·ªáu ·ª©ng nh·∫π nh√†ng cho th√¥ng b√°o ƒë√∫ng/sai */
    .pulse-once { animation: pulse-once 500ms ease-out 1; }
    @keyframes pulse-once {
      0% { transform: scale(1); }
      50% { transform: scale(1.03); }
      100% { transform: scale(1); }
    }
    /* Confetti ƒë∆°n gi·∫£n b·∫±ng emoji */
    .confetti {
      position: fixed; inset: 0; pointer-events: none; overflow: hidden; z-index: 50;
    }
    .confetti span {
      position: absolute; top: -10%; font-size: 20px; animation: fall 1.8s linear forwards;
    }
    @keyframes fall {
      to { transform: translateY(120vh) rotate(360deg); opacity: 0.9; }
    }
    /* Badge h∆∞·ªõng d·∫´n nh·ªè */
    .tip-badge { background: rgba(255,255,255,0.12); border: 1px solid rgba(255,255,255,0.15); }
  </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-indigo-900 via-violet-800 to-fuchsia-700 text-white">
  <div class="confetti hidden" id="confetti"></div>

  <!-- N√∫t n·ªïi To√†n m√†n h√¨nh -->
  <button id="fabFullscreen" title="To√†n m√†n h√¨nh"
          class="fixed bottom-5 right-5 z-40 rounded-full bg-slate-800/80 hover:bg-slate-700 shadow-lg ring-1 ring-white/10 px-4 py-3 flex items-center gap-2">
    <span class="text-xl">‚õ∂</span>
    <span class="hidden sm:inline">To√†n m√†n h√¨nh</span>
  </button>

  <main class="max-w-6xl mx-auto px-4 py-6 md:py-10">
    <!-- Header -->
    <header class="mb-6 md:mb-8">
      <div class="flex flex-col md:flex-row md:items-end md:justify-between gap-4">
        <div>
          <h1 class="text-3xl md:text-4xl font-bold tracking-tight">Bi·∫øn ƒë·ªïi ƒë·∫°i s·ªë ‚Äì Game luy·ªán t·∫≠p</h1>
          <p class="text-white/80 mt-1">R√∫t ‚Äì Ph√¢n ‚Äì T√≠ch ‚Äì Quy ‚Ä¢ Hi·ªÉn th·ªã 1 c√¢u/l·∫ßn ‚Ä¢ Ch·ªØ to d·ªÖ nh√¨n</p>
        </div>
        <!-- ƒêi·ªÉm & H·∫πn gi·ªù -->
        <div class="flex items-center gap-3">
          <div class="rounded-xl backdrop-blur bg-white/10 px-4 py-3 flex items-center gap-2">
            <span class="text-yellow-300">‚≠ê</span>
            <span class="text-sm text-white/80">ƒêi·ªÉm</span>
            <span class="text-2xl font-semibold" id="score">0</span>
          </div>
          <div class="rounded-xl backdrop-blur bg-white/10 px-4 py-3 flex items-center gap-2">
            <span class="text-sm text-white/80">‚è±</span>
            <span class="text-2xl font-mono tabular-nums" id="timer">00:00</span>
          </div>
        </div>
      </div>

      <!-- Thanh ƒëi·ªÅu h∆∞·ªõng b∆∞·ªõc -->
      <nav class="mt-4">
        <ul class="grid grid-cols-2 md:grid-cols-4 gap-3">
          <li><button data-section="warmup" class="tab-btn w-full rounded-xl bg-white/10 hover:bg-white/15 transition p-3 text-center ring-1 ring-white/10 font-medium">1. Kh·ªüi ƒë·ªông</button></li>
          <li><button data-section="learn" class="tab-btn w-full rounded-xl bg-white/10 hover:bg-white/15 transition p-3 text-center ring-1 ring-white/10 font-medium">2. H√¨nh th√†nh</button></li>
          <li><button data-section="practice" class="tab-btn w-full rounded-xl bg-white/10 hover:bg-white/15 transition p-3 text-center ring-1 ring-white/10 font-medium">3. Luy·ªán t·∫≠p</button></li>
          <li><button data-section="summary" class="tab-btn w-full rounded-xl bg-white/10 hover:bg-white/15 transition p-3 text-center ring-1 ring-white/10 font-medium">4. T·ªïng k·∫øt</button></li>
        </ul>
      </nav>

      <!-- ƒêi·ªÅu khi·ªÉn th·ªùi l∆∞·ª£ng theo ho·∫°t ƒë·ªông -->
      <div class="mt-4 flex flex-wrap items-center gap-2">
        <span class="text-sm text-white/80">Ch·ªçn th·ªùi l∆∞·ª£ng:</span>
        <div class="flex gap-2">
          <button data-min="5" class="time-btn rounded-full bg-white/10 hover:bg-white/15 px-3 py-1.5 text-sm ring-1 ring-white/10">Kh·ªüi ƒë·ªông ‚Äì 5'</button>
          <button data-min="20" class="time-btn rounded-full bg-white/10 hover:bg-white/15 px-3 py-1.5 text-sm ring-1 ring-white/10">H√¨nh th√†nh ‚Äì 20'</button>
          <button data-min="15" class="time-btn rounded-full bg-white/10 hover:bg-white/15 px-3 py-1.5 text-sm ring-1 ring-white/10">Luy·ªán t·∫≠p ‚Äì 15'</button>
          <button data-min="5" class="time-btn rounded-full bg-white/10 hover:bg-white/15 px-3 py-1.5 text-sm ring-1 ring-white/10">T·ªïng k·∫øt ‚Äì 5'</button>
        </div>
        <div class="ml-auto flex flex-wrap gap-2">
          <button id="startTimer" class="rounded-lg bg-emerald-500 hover:bg-emerald-600 px-3 py-1.5 text-sm font-medium">B·∫Øt ƒë·∫ßu</button>
          <button id="pauseTimer" class="rounded-lg bg-amber-500 hover:bg-amber-600 px-3 py-1.5 text-sm font-medium">T·∫°m d·ª´ng</button>
          <button id="resetTimer" class="rounded-lg bg-rose-500 hover:bg-rose-600 px-3 py-1.5 text-sm font-medium">ƒê·∫∑t l·∫°i</button>
          <button id="toggleFullscreen" class="rounded-lg bg-slate-700 hover:bg-slate-600 px-3 py-1.5 text-sm font-medium" title="B·∫≠t/t·∫Øt to√†n m√†n h√¨nh">To√†n m√†n h√¨nh</button>
        </div>
      </div>
    </header>

    <!-- N·ªôi dung -->
    <section id="warmup" class="section">
      <div class="rounded-2xl p-5 md:p-6 bg-white/10 ring-1 ring-white/10 backdrop-blur">
        <div class="flex items-start justify-between gap-4">
          <div>
            <h2 class="text-2xl font-semibold">Kh·ªüi ƒë·ªông ‚Äì 3 c√¢u h·ªèi tr·∫Øc nghi·ªám nhanh</h2>
            <p class="text-white/80 mt-1">Gi∆° b·∫£ng t∆∞·ªüng t∆∞·ª£ng ho·∫∑c tr·∫£ l·ªùi ngay tr√™n m√†n h√¨nh nh√©!</p>
          </div>
          <span class="tip-badge rounded-lg px-3 py-1 text-xs">M·∫πo: Ch·ªâ c·ªông/tr·ª´ s·ªë h·∫°ng ƒë·ªìng d·∫°ng</span>
        </div>

        <div id="warmupBox" class="mt-5">
          <!-- C√¢u h·ªèi s·∫Ω ƒë∆∞·ª£c sinh ƒë·ªông -->
        </div>
      </div>
    </section>

    <section id="learn" class="section hidden">
      <div class="mb-4 flex flex-wrap items-center gap-3 justify-between">
        <div class="flex items-center gap-2">
          <span class="inline-flex items-center justify-center h-8 w-8 rounded-full bg-white/10 ring-1 ring-white/10 text-lg">üìò</span>
          <span class="text-white/90 font-medium">Ph·∫ßn 2 ‚Äì Ch·∫ø ƒë·ªô 1 c√¢u h·ªèi</span>
        </div>
        <div class="flex items-center gap-2">
          <button id="learnPrev" class="rounded-lg bg-white/10 hover:bg-white/15 ring-1 ring-white/10 px-3 py-1.5">‚Üê Tr∆∞·ªõc</button>
          <span id="learnCounter" class="rounded-lg bg-white/10 ring-1 ring-white/10 px-3 py-1.5 text-sm">1/10</span>
          <button id="learnNext" class="rounded-lg bg-white/10 hover:bg-white/15 ring-1 ring-white/10 px-3 py-1.5">Ti·∫øp ‚Üí</button>
        </div>
      </div>
      <div class="rounded-2xl p-5 md:p-6 bg-white/10 ring-1 ring-white/10 backdrop-blur">
        <div id="learnBox"></div>
      </div>
    </section>

    <section id="practice" class="section hidden">
      <div class="mb-4 flex flex-wrap items-center gap-3 justify-between">
        <div class="flex items-center gap-2">
          <span class="inline-flex items-center justify-center h-8 w-8 rounded-full bg-white/10 ring-1 ring-white/10 text-lg">üéØ</span>
          <span class="text-white/90 font-medium">Ph·∫ßn 3 ‚Äì Ch·∫ø ƒë·ªô 1 c√¢u h·ªèi</span>
        </div>
        <div class="flex items-center gap-2">
          <button id="prevQ" class="rounded-lg bg-white/10 hover:bg-white/15 ring-1 ring-white/10 px-3 py-1.5">‚Üê Tr∆∞·ªõc</button>
          <span id="practiceCounter" class="rounded-lg bg-white/10 ring-1 ring-white/10 px-3 py-1.5 text-sm">1/10</span>
          <button id="nextQ" class="rounded-lg bg-white/10 hover:bg-white/15 ring-1 ring-white/10 px-3 py-1.5">Ti·∫øp ‚Üí</button>
        </div>
      </div>
      <div class="grid grid-cols-1 gap-5">
        <div class="rounded-2xl p-5 bg-white/10 ring-1 ring-white/10 backdrop-blur">
          <div id="practiceBox"></div>
        </div>
      </div>
    </section>

    <section id="summary" class="section hidden">
      <div class="rounded-2xl p-5 md:p-6 bg-white/10 ring-1 ring-white/10 backdrop-blur">
        <h3 class="text-2xl font-semibold">T·ªïng k·∫øt</h3>
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-5 mt-4">
          <div class="space-y-2">
            <p class="text-white/90 font-medium">Ki·∫øn th·ª©c c·ªët l√µi:</p>
            <ul class="list-disc list-inside space-y-1 text-white/90">
              <li>Ch·ªâ c·ªông/tr·ª´ s·ªë h·∫°ng ƒë·ªìng d·∫°ng.</li>
              <li>Nh√¢n ph√¢n ph·ªëi l√† c∆° s·ªü ƒë·ªÉ nh√¢n ƒëa th·ª©c.</li>
              <li>Ph√¢n t√≠ch nh√¢n t·ª≠ gi√∫p r√∫t g·ªçn nhanh v√† gi·∫£i ph∆∞∆°ng tr√¨nh.</li>
              <li>Quy ƒë·ªìng & r√∫t g·ªçn ph√¢n th·ª©c l√† b·∫Øt bu·ªôc tr∆∞·ªõc khi c·ªông/tr·ª´.</li>
            </ul>
            <div class="mt-3 rounded-xl bg-emerald-500/15 ring-1 ring-emerald-400/30 p-4">
              <div class="text-emerald-200 text-sm">M·∫πo nh·ªõ nhanh</div>
              <div class="text-emerald-100 text-lg font-semibold mt-1">R√∫t ‚Äì Ph√¢n ‚Äì T√≠ch ‚Äì Quy</div>
            </div>
            <button id="printSummary" class="mt-3 rounded-lg bg-indigo-500 hover:bg-indigo-600 px-4 py-2 font-medium">In phi·∫øu t·ªïng k·∫øt</button>
          </div>
          <div>
            <p class="text-white/90 font-medium mb-2">S∆° ƒë·ªì t∆∞ duy</p>
            <!-- Mindmap b·∫±ng SVG -->
            <div class="relative h-80 rounded-xl bg-white/10 ring-1 ring-white/10 overflow-hidden">
              <svg viewBox="0 0 600 360" class="w-full h-full">
                <!-- Lines -->
                <line x1="300" y1="180" x2="110" y2="90" stroke="rgba(255,255,255,0.3)" stroke-width="2"/>
                <line x1="300" y1="180" x2="490" y2="90" stroke="rgba(255,255,255,0.3)" stroke-width="2"/>
                <line x1="300" y1="180" x2="110" y2="270" stroke="rgba(255,255,255,0.3)" stroke-width="2"/>
                <line x1="300" y1="180" x2="490" y2="270" stroke="rgba(255,255,255,0.3)" stroke-width="2"/>
                <!-- Nodes -->
                <g class="node" data-tip="Ch·ªâ c·ªông/tr·ª´ ƒë·ªìng d·∫°ng">
                  <circle cx="300" cy="180" r="48" fill="rgba(99,102,241,0.3)" stroke="rgba(255,255,255,0.5)" stroke-width="2"/>
                  <text x="300" y="182" text-anchor="middle" dominant-baseline="middle" fill="white" font-size="16" font-weight="bold">C·ªët l√µi</text>
                </g>
                <g class="node" data-tip="Gom nh√≥m v√† r√∫t g·ªçn" transform="translate(110,90)">
                  <rect x="-60" y="-22" rx="12" ry="12" width="120" height="44" fill="rgba(34,197,94,0.25)" stroke="rgba(255,255,255,0.5)"/>
                  <text x="0" y="4" text-anchor="middle" fill="white" font-size="14">R√∫t g·ªçn</text>
                </g>
                <g class="node" data-tip="a(b¬±c)=ab¬±ac" transform="translate(490,90)">
                  <rect x="-72" y="-22" rx="12" ry="12" width="144" height="44" fill="rgba(168,85,247,0.25)" stroke="rgba(255,255,255,0.5)"/>
                  <text x="0" y="4" text-anchor="middle" fill="white" font-size="14">Ph√¢n ph·ªëi</text>
                </g>
                <g class="node" data-tip="ƒê·∫∑t chung/h·∫±ng ƒë·∫≥ng th·ª©c/nh√≥m" transform="translate(110,270)">
                  <rect x="-86" y="-22" rx="12" ry="12" width="172" height="44" fill="rgba(236,72,153,0.25)" stroke="rgba(255,255,255,0.5)"/>
                  <text x="0" y="4" text-anchor="middle" fill="white" font-size="14">Ph√¢n t√≠ch nh√¢n t·ª≠</text>
                </g>
                <g class="node" data-tip="BCNN l√†m m·∫´u chung" transform="translate(490,270)">
                  <rect x="-102" y="-22" rx="12" ry="12" width="204" height="44" fill="rgba(34,197,94,0.25)" stroke="rgba(255,255,255,0.5)"/>
                  <text x="0" y="4" text-anchor="middle" fill="white" font-size="14">Quy ƒë·ªìng & r√∫t g·ªçn</text>
                </g>
              </svg>
              <div id="mindTip" class="absolute left-2 bottom-2 text-xs text-white/90 bg-black/30 px-2 py-1 rounded">
                Ch·∫°m v√†o n√∫t b·∫•t k·ª≥ ƒë·ªÉ xem g·ª£i √Ω nhanh
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Footer nh·ªè -->
    <footer class="mt-6 text-center text-white/70 text-sm">
      T·∫•t c·∫£ c√¢u nh·∫Øc ƒë√£ ƒë∆∞·ª£c l√†m t∆∞∆°ng t√°c ƒë·∫ßy ƒë·ªß. Kh√¥ng c√≥ √¢m thanh trong Canva Code (t√≠nh nƒÉng n√†y ch∆∞a h·ªó tr·ª£).
    </footer>
  </main>

  <script>
    // Tr·∫°ng th√°i
    const state = {
      score: 0,
      section: 'warmup',
      timer: { total: 0, left: 0, id: null, running: false },
      warmup: { index: 0, answered: false }
    };

    // C√¥ng c·ª• nh·ªè
    const $ = (s, p=document) => p.querySelector(s);
    const $$ = (s, p=document) => Array.from(p.querySelectorAll(s));
    const byId = id => document.getElementById(id);
    const setText = (el, txt) => (el.textContent = txt);
    const norm = s => (s||'').toLowerCase().replace(/\s+/g,'').replace(/¬∑/g,'*').replace(/‚Äì/g,'-').replace(/‚Äî/g,'-');

    function addScore(n=10) {
      state.score += n;
      setText(byId('score'), state.score);
      confetti();
    }
    function showMsg(id, ok, msgOK='ƒê√∫ng r·ªìi! üéâ', msgNO='Th·ª≠ l·∫°i nh√©!') {
      const el = byId(id);
      el.className = 'mt-2 text-sm ' + (ok ? 'text-emerald-200' : 'text-rose-200');
      el.textContent = ok ? msgOK : msgNO;
      el.parentElement?.classList?.add('pulse-once');
      setTimeout(()=>el.parentElement?.classList?.remove('pulse-once'), 500);
    }
    function confetti() {
      const box = byId('confetti');
      box.classList.remove('hidden');
      // t·∫°o 18 m·∫£nh emoji
      const icons = ['üéâ','‚ú®','üü£','üü°','üî∑','üí´','‚≠ê','üî∂','üü¢'];
      for (let i=0;i<18;i++){
        const s = document.createElement('span');
        s.style.left = Math.random()*100 + '%';
        s.style.animationDelay = (Math.random()*0.3)+'s';
        s.style.transform = `translateY(0) rotate(${Math.random()*180}deg)`;
        s.textContent = icons[Math.floor(Math.random()*icons.length)];
        box.appendChild(s);
        setTimeout(()=>s.remove(), 1800);
      }
      setTimeout(()=>box.classList.add('hidden'), 1900);
    }

    // ƒêi·ªÅu h∆∞·ªõng
    function setSection(id) {
      state.section = id;
      $$('.section').forEach(s => s.classList.add('hidden'));
      byId(id).classList.remove('hidden');
      // Active tab
      $$('.tab-btn').forEach(b => {
        if (b.dataset.section === id) {
          b.classList.add('ring-2','ring-white/40','bg-white/15');
        } else {
          b.classList.remove('ring-2','ring-white/40','bg-white/15');
        }
      });
    }
    $$('.tab-btn').forEach(btn => btn.addEventListener('click', ()=>setSection(btn.dataset.section)));
    setSection('warmup');

    // H·∫πn gi·ªù
    function formatTime(sec){
      const m = Math.floor(sec/60).toString().padStart(2,'0');
      const s = Math.floor(sec%60).toString().padStart(2,'0');
      return m+':'+s;
    }

    // To√†n m√†n h√¨nh
    const fsBtn = document.addEventListener('DOMContentLoaded', ()=>{
      const btn = document.getElementById('toggleFullscreen');
      const fab = document.getElementById('fabFullscreen');
      const isFull = () => !!(document.fullscreenElement || document.webkitFullscreenElement);
      const enter = () => {
        const el = document.documentElement;
        if (el.requestFullscreen) el.requestFullscreen();
        else if (el.webkitRequestFullscreen) el.webkitRequestFullscreen();
      };
      const exit = () => {
        if (document.exitFullscreen) document.exitFullscreen();
        else if (document.webkitExitFullscreen) document.webkitExitFullscreen();
      };
      const update = () => {
        if (btn) btn.textContent = isFull() ? 'Tho√°t to√†n m√†n' : 'To√†n m√†n h√¨nh';
        if (fab) fab.querySelector('span.hidden')?.classList?.toggle('sm:inline', !isFull());
      };
      const toggle = ()=>{ isFull() ? exit() : enter(); };
      if (btn) btn.addEventListener('click', toggle);
      if (fab) fab.addEventListener('click', toggle);
      document.addEventListener('fullscreenchange', update);
      document.addEventListener('webkitfullscreenchange', update);
      update();
    });
    function updateTimerDisplay() {
      setText(byId('timer'), formatTime(state.timer.left));
    }
    $$('.time-btn').forEach(b=>{
      b.addEventListener('click', ()=>{
        const min = parseInt(b.dataset.min,10);
        state.timer.total = min*60;
        state.timer.left = state.timer.total;
        updateTimerDisplay();
        showToast('ƒê·∫∑t th·ªùi l∆∞·ª£ng ' + min + ' ph√∫t.');
      });
    });
    byId('startTimer').addEventListener('click', ()=>{
      if (!state.timer.left) {
        state.timer.left = state.timer.total || 300; // m·∫∑c ƒë·ªãnh 5'
      }
      if (state.timer.running) return;
      state.timer.running = true;
      state.timer.id = setInterval(()=>{
        state.timer.left = Math.max(0, state.timer.left-1);
        updateTimerDisplay();
        if (state.timer.left <= 0) {
          clearInterval(state.timer.id);
          state.timer.running = false;
          showToast('H·∫øt gi·ªù! Tuy·ªát v·ªùi, chuy·ªÉn ph·∫ßn ti·∫øp theo nh√©.');
        }
      }, 1000);
    });
    byId('pauseTimer').addEventListener('click', ()=>{
      if (state.timer.id) clearInterval(state.timer.id);
      state.timer.running = false;
      showToast('ƒê√£ t·∫°m d·ª´ng h·∫πn gi·ªù.');
    });
    byId('resetTimer').addEventListener('click', ()=>{
      if (state.timer.id) clearInterval(state.timer.id);
      state.timer.running = false;
      state.timer.left = state.timer.total || 0;
      updateTimerDisplay();
      showToast('ƒê√£ ƒë·∫∑t l·∫°i th·ªùi gian.');
    });

    // Toast ƒë∆°n gi·∫£n
    function showToast(msg) {
      const t = document.createElement('div');
      t.className = 'fixed bottom-4 left-1/2 -translate-x-1/2 bg-black/60 text-white px-4 py-2 rounded-lg ring-1 ring-white/10';
      t.textContent = msg;
      document.body.appendChild(t);
      setTimeout(()=>t.remove(), 1800);
    }

    // KH·ªûI ƒê·ªòNG
    const warmupQs = [
      {
        q: '2x + 5x = ?',
        choices: ['5x', '7x', '7'],
        correct: 1,
        explain: 'C·ªông h·ªá s·ªë v√¨ ƒë·ªìng d·∫°ng: 2 + 5 = 7 ‚Üí 7x.'
      },
      {
        q: '3(a + 2) = ?',
        choices: ['3a + 2', '3a + 6', 'a + 5'],
        correct: 1,
        explain: 'Ph√¢n ph·ªëi: 3¬∑a + 3¬∑2 = 3a + 6.'
      },
      {
        q: '1/2 + 1/3 = ?',
        choices: ['2/5', '5/6', '1/6'],
        correct: 1,
        explain: 'Quy ƒë·ªìng m·∫´u 6: 3/6 + 2/6 = 5/6.'
      }
    ];
    function renderWarmup() {
      const box = byId('warmupBox');
      const i = state.warmup.index;
      if (i >= warmupQs.length) {
        box.innerHTML = `
          <div class="rounded-xl bg-emerald-500/20 ring-1 ring-emerald-400/30 p-4">
            <div class="font-semibold text-emerald-100">Ho√†n th√†nh kh·ªüi ƒë·ªông! ‚ú®</div>
            <p class="text-emerald-100/90 mt-1">ƒêi·ªÉm th∆∞·ªüng ƒë√£ c·ªông. S·∫µn s√†ng v√†o ph·∫ßn H√¨nh th√†nh ki·∫øn th·ª©c.</p>
            <div class="mt-3 flex gap-2">
              <button class="rounded-lg bg-indigo-500 hover:bg-indigo-600 px-4 py-2 font-medium" onclick="setSection('learn')">Sang ph·∫ßn 2</button>
              <button class="rounded-lg bg-white/10 hover:bg-white/15 ring-1 ring-white/10 px-4 py-2" onclick="restartWarmup()">L√†m l·∫°i</button>
            </div>
          </div>`;
        return;
      }
      const q = warmupQs[i];
      box.innerHTML = `
        <div class="flex items-center justify-between">
          <div class="text-sm text-white/80">C√¢u ${i+1} / ${warmupQs.length}</div>
          <div class="text-xs text-white/70">Ch·ªß ƒë·ªÅ: Bi·∫øn ƒë·ªïi ƒë·∫°i s·ªë n·ªÅn t·∫£ng</div>
        </div>
        <div class="mt-3 rounded-xl bg-white/10 ring-1 ring-white/10 p-4">
          <div class="text-3xl md:text-4xl font-bold leading-snug">${q.q}</div>
          <div class="mt-3 grid grid-cols-1 sm:grid-cols-3 gap-2">
            ${q.choices.map((c,idx)=>`
              <button data-idx="${idx}" class="warm-choice rounded-lg bg-white/10 hover:bg-white/15 ring-1 ring-white/10 px-4 py-2 text-left">${c}</button>
            `).join('')}
          </div>
          <div id="warmMsg" class="mt-3 text-sm"></div>
          <div class="mt-3 flex gap-2">
            <button id="nextWarm" class="rounded-lg bg-fuchsia-500 hover:bg-fuchsia-600 px-4 py-2 font-medium disabled:opacity-50" disabled>Ti·∫øp theo</button>
            <button id="explainWarm" class="rounded-lg bg-white/10 hover:bg-white/15 ring-1 ring-white/10 px-4 py-2">Gi·∫£i th√≠ch</button>
          </div>
        </div>`;
      $$('.warm-choice', box).forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const idx = parseInt(btn.dataset.idx,10);
          const correct = idx === q.correct;
          $$('.warm-choice', box).forEach(b=>b.disabled = true);
          byId('nextWarm').disabled = false;
          if (correct) {
            btn.classList.add('bg-emerald-500/30');
            showMsg('warmMsg', true, 'Ch√≠nh x√°c! +10 ƒëi·ªÉm üéØ');
            addScore(10);
          } else {
            btn.classList.add('bg-rose-500/30');
            showMsg('warmMsg', false, 'Ch∆∞a ƒë√∫ng, th·ª≠ xem g·ª£i √Ω nh√©.');
          }
        });
      });
      byId('nextWarm').addEventListener('click', ()=>{
        state.warmup.index++;
        renderWarmup();
      });
      byId('explainWarm').addEventListener('click', ()=>{
        showToast(q.explain);
      });
    }
    function restartWarmup() {
      state.warmup.index = 0;
      renderWarmup();
    }
    renderWarmup();

    // Ph·∫ßn 2: Ng√¢n h√†ng 10 c√¢u h·ªçc ki·∫øn th·ª©c (m·ªói l·∫ßn 1 c√¢u)
    const learnQuestions = [
      {q:'X√°c ƒë·ªãnh s·ªë h·∫°ng ƒë·ªìng d·∫°ng v·ªõi 3x?', type:'choice', choices:['5x','2y','x^2','-x'], answer:0, tip:'ƒê·ªìng d·∫°ng: c√πng bi·∫øn v√† s·ªë m≈©.'},
      {q:'R√∫t g·ªçn: 3x + 5y ‚àí x + 2y = ?', type:'input', answer:['2x+7y','7y+2x'], tip:'Gom x v·ªõi x, y v·ªõi y.'},
      {q:'3(a+2) = ?', type:'input', answer:['3a+6'], tip:'Ph√¢n ph·ªëi v√†o ngo·∫∑c.'},
      {q:'‚àí2(5y ‚àí 3) = ?', type:'input', answer:['-10y+6'], tip:'Nh√¢n -2 v√†o m·ªói h·∫°ng t·ª≠.'},
      {q:'(x+2)(y+3) = ?', type:'input', answer:['xy+3x+2y+6'], tip:'Ph√¢n ph·ªëi hai l·∫ßn.'},
      {q:'Ph√¢n t√≠ch: 5x + 10 = ?', type:'input', answer:['5(x+2)','5*(x+2)'], tip:'ƒê·∫∑t nh√¢n t·ª≠ chung 5.'},
      {q:'Ph√¢n t√≠ch: x^2 ‚àí 9 = ?', type:'input', answer:['(x-3)(x+3)','(x+3)(x-3)'], tip:'Hi·ªáu hai b√¨nh ph∆∞∆°ng.'},
      {q:'Ph√¢n t√≠ch: x^2 + 6x + 9 = ?', type:'input', answer:['(x+3)^2','(x+3)*(x+3)'], tip:'B√¨nh ph∆∞∆°ng ho√†n ch·ªânh.'},
      {q:'1/x + 1/y = ?', type:'input', answer:['(x+y)/xy'], tip:'M·∫´u chung xy.'},
      {q:'2/x ‚àí 3/y = ?', type:'input', answer:['(2y-3x)/xy'], tip:'M·∫´u chung xy.'}
    ];

    function renderLearnQuestion(i=0){
      const box = byId('learnBox');
      const total = learnQuestions.length;
      const item = learnQuestions[i];
      byId('learnCounter').textContent = (i+1)+'/'+total;
      if (!item) { box.innerHTML = '<div class="text-white/90">H·∫øt c√¢u h·ªèi!</div>'; return; }
      if (item.type === 'choice') {
        box.innerHTML = `
          <div class="text-3xl md:text-4xl font-extrabold mb-3 leading-snug">${item.q}</div>
          <div class="grid grid-cols-1 sm:grid-cols-2 gap-2">
            ${item.choices.map((c,idx)=>`<button class=\"learn-choice rounded-lg bg-white/10 hover:bg-white/15 ring-1 ring-white/10 px-4 py-3 text-left\" data-idx=\"${idx}\">${c}</button>`).join('')}
          </div>
          <div id="learnMsg" class="mt-3 text-base"></div>
          <div class="mt-3 flex gap-2">
            <button id="learnTip" class="rounded-lg bg-white/10 hover:bg-white/15 ring-1 ring-white/10 px-4 py-2">G·ª£i √Ω</button>
          </div>`;
        $$('.learn-choice', box).forEach(btn=>{
          btn.addEventListener('click', ()=>{
            const ok = parseInt(btn.dataset.idx,10) === (item.answer);
            if (ok) { addScore(8); showMsg('learnMsg', true, 'ƒê√∫ng r·ªìi!'); }
            else { showMsg('learnMsg', false, 'Ch∆∞a ƒë√∫ng, th·ª≠ l·∫°i nh√©.'); }
          });
        });
      } else {
        box.innerHTML = `
          <div class="text-3xl md:text-4xl font-extrabold mb-3 leading-snug">${item.q}</div>
          <div class="flex gap-2">
            <input id="learnInput" class="w-full rounded-lg bg-white/10 ring-1 ring-white/10 px-4 py-3 text-xl md:text-2xl placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-indigo-400" placeholder="Nh·∫≠p ƒë√°p √°n" />
            <button id="learnCheck" class="rounded-lg bg-emerald-500 hover:bg-emerald-600 px-5 py-3 text-base font-medium">Ki·ªÉm tra</button>
            <button id="learnShow" class="rounded-lg bg-sky-500 hover:bg-sky-600 px-4 py-3 text-base">ƒê√°p √°n</button>
          </div>
          <div id="learnMsg" class="mt-2 text-base"></div>
          <div class="mt-2"><button id="learnTip" class="rounded-lg bg-white/10 hover:bg-white/15 ring-1 ring-white/10 px-3 py-1.5 text-sm">G·ª£i √Ω</button></div>`;
        byId('learnCheck').addEventListener('click', ()=>{
          const ok = (item.answer||[]).some(a=> norm(a) === norm(byId('learnInput').value));
          if (ok) { addScore(8); showMsg('learnMsg', true, 'Tuy·ªát!'); }
          else { showMsg('learnMsg', false, 'Th·ª≠ l·∫°i n√†o.'); }
        });
        byId('learnShow').addEventListener('click', ()=> showToast('ƒê√°p √°n: '+ (Array.isArray(item.answer)? item.answer[0] : item.answer)));
      }
      const tipBtn = byId('learnTip');
      if (tipBtn) tipBtn.addEventListener('click', ()=> showToast(item.tip||'H√£y ph√¢n t√≠ch t·ª´ng b∆∞·ªõc.'));
    }

    let learnIndex = 0;
    document.addEventListener('DOMContentLoaded', ()=>{
      renderLearnQuestion(learnIndex);
      const lp = byId('learnPrev'); const ln = byId('learnNext');
      if (lp) lp.addEventListener('click', ()=>{ learnIndex = (learnIndex-1+learnQuestions.length)%learnQuestions.length; renderLearnQuestion(learnIndex); });
      if (ln) ln.addEventListener('click', ()=>{ learnIndex = (learnIndex+1)%learnQuestions.length; renderLearnQuestion(learnIndex); });
    });

    // N√∫t ki·ªÉm tra chung cho c√°c b√†i nh·∫≠p ƒë√°p √°n
    function checkInput(inputId, msgId, answers) {
      const val = norm(byId(inputId).value);
      const ok = answers.some(ans => norm(ans) === val);
      showMsg(msgId, ok);
      if (ok) addScore(8);
    }
    $$('.check-btn').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const inputId = btn.dataset.check;
        const msgId = inputId + 'Msg';
        const answers = JSON.parse(btn.dataset.answers||'[]');
        checkInput(inputId, msgId, answers);
      });
    });
    $$('.hint').forEach(b=>{
      b.addEventListener('click', ()=> showToast(b.dataset.hint || 'H√£y th·ª≠ ph√¢n t√≠ch t·ª´ng b∆∞·ªõc.'));
    });
    $$('.show').forEach(b=>{
      b.addEventListener('click', ()=>{
        const ans = b.dataset.solution || '';
        showToast('ƒê√°p √°n: ' + ans);
      });
    });

    // Ph·∫ßn 3: Ng√¢n h√†ng 10 c√¢u luy·ªán t·∫≠p (m·ªói l·∫ßn 1 c√¢u)
    const practiceQuestions = [
      {q:'R√∫t g·ªçn: 2a + 3b ‚àí 4a + b = ?', answer:['-2a+4b','4b-2a'], tip:'Gom a v·ªõi a, b v·ªõi b.'},
      {q:'Ph√¢n ph·ªëi: ‚àí2(3x ‚àí 4) = ?', answer:['-6x+8'], tip:'Nh√¢n -2 v√†o m·ªói h·∫°ng t·ª≠.'},
      {q:'Ph√¢n t√≠ch: x^2 ‚àí 16 = ?', answer:['(x-4)(x+4)','(x+4)(x-4)'], tip:'Hi·ªáu hai b√¨nh ph∆∞∆°ng.'},
      {q:'Quy ƒë·ªìng: 3/a + 5/(2a) = ?', answer:['11/(2a)'], tip:'M·∫´u chung 2a.'},
      {q:'(x^2 ‚àí 4)/(x + 2) + 3(x ‚àí 1) = ?', answer:['4x-5','-5+4x'], tip:'R√∫t g·ªçn x^2-4 = (x-2)(x+2).'},
      {q:'2/x ‚àí x/(x^2 ‚àí 4) = ?', answer:['(x-4)/(x(x-2))'], tip:'M·∫´u chung x(x-2)(x+2).'},
      {q:'3(x‚àí2) = ?', answer:['3x-6'], tip:'Nh√¢n 3 v√†o t·ª´ng h·∫°ng t·ª≠.'},
      {q:'(x+1)^2 = ?', answer:['x^2+2x+1'], tip:'B√¨nh ph∆∞∆°ng m·ªôt t·ªïng.'},
      {q:'R√∫t g·ªçn: 4a^2 + 3a ‚àí 2a^2 ‚àí 5a = ?', answer:['2a^2-2a','-2a+2a^2'], tip:'Gom h·∫°ng t·ª≠ ƒë·ªìng d·∫°ng.'},
      {q:'1/2 + 1/3 = ?', answer:['5/6'], tip:'M·∫´u chung 6.'}
    ];

    function renderPracticeQuestion(i=0){
      const box = byId('practiceBox');
      const total = practiceQuestions.length;
      const item = practiceQuestions[i];
      byId('practiceCounter').textContent = (i+1)+'/'+total;
      if (!item) { box.innerHTML = '<div class="text-white/90">H·∫øt c√¢u h·ªèi!</div>'; return; }
      box.innerHTML = `
        <div class="text-3xl md:text-4xl font-extrabold leading-snug mb-3">${item.q}</div>
        <div class="flex gap-2">
          <input id="practiceInput" class="w-full rounded-lg bg-white/10 ring-1 ring-white/10 px-4 py-3 text-xl md:text-2xl placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-indigo-400" placeholder="Nh·∫≠p ƒë√°p √°n" />
          <button id="practiceCheck" class="rounded-lg bg-emerald-500 hover:bg-emerald-600 px-5 py-3 text-base font-medium">Ki·ªÉm tra</button>
          <button id="practiceShow" class="rounded-lg bg-sky-500 hover:bg-sky-600 px-4 py-3 text-base">ƒê√°p √°n</button>
        </div>
        <div id="practiceMsg" class="mt-2 text-base"></div>
        <div class="mt-2"><button id="practiceTip" class="rounded-lg bg-white/10 hover:bg-white/15 ring-1 ring-white/10 px-3 py-1.5 text-sm">G·ª£i √Ω</button></div>`;
      byId('practiceCheck').addEventListener('click', ()=>{
        const ok = (item.answer||[]).some(a=> norm(a) === norm(byId('practiceInput').value));
        if (ok) { addScore(10); showMsg('practiceMsg', true, 'Ch√≠nh x√°c!'); }
        else { showMsg('practiceMsg', false, 'Ch∆∞a ƒë√∫ng, th·ª≠ l·∫°i nh√©.'); }
      });
      byId('practiceShow').addEventListener('click', ()=> showToast('ƒê√°p √°n: '+ (Array.isArray(item.answer)? item.answer[0] : item.answer)));
      byId('practiceTip').addEventListener('click', ()=> showToast(item.tip||'H√£y ph√¢n t√≠ch t·ª´ng b∆∞·ªõc.'));
    }

    let practiceIndex = 0;
    document.addEventListener('DOMContentLoaded', ()=>{
      renderPracticeQuestion(practiceIndex);
      const n = byId('nextQ'); const p = byId('prevQ');
      if (n) n.addEventListener('click', ()=>{ practiceIndex = (practiceIndex+1)%practiceQuestions.length; renderPracticeQuestion(practiceIndex); });
      if (p) p.addEventListener('click', ()=>{ practiceIndex = (practiceIndex-1+practiceQuestions.length)%practiceQuestions.length; renderPracticeQuestion(practiceIndex); });
    });

    // In t·ªïng k·∫øt
    byId('printSummary').addEventListener('click', ()=> window.print());

    // Tooltip ƒë∆°n gi·∫£n cho mindmap
    $$('.node').forEach(n=>{
      n.style.cursor = 'pointer';
      n.addEventListener('click', ()=>{
        const tip = n.getAttribute('data-tip') || 'G·ª£i √Ω';
        byId('mindTip').textContent = tip;
        addScore(2);
      });
    });

    // T·ª± ƒë·ªông ƒë√°nh d·∫•u tab ƒë·∫ßu
    setSection('warmup');
  </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96d1388376118149',t:'MTc1NDg0NzAyMi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
