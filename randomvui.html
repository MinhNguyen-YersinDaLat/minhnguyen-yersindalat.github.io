<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Random Chá»n Há»c Sinh - Tháº§y NguyÃªn</title>
<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #f0f8ff;
    margin: 0; padding: 20px;
    text-align: center;
    overflow-x: hidden;
  }
  h1 {
    color: #d63384;
  }
  #container {
    position: relative;
    width: 100%;
    max-width: 960px;
    margin: 20px auto 40px;
    height: 600px;
    border: 3px solid #d63384;
    border-radius: 15px;
    background: white;
    overflow: hidden;
  }
  .student {
    position: absolute;
    width: 50px;
    height: 50px;
    font-size: 40px;
    line-height: 50px;
    cursor: default;
    user-select: none;
    transition: all 0.5s ease;
    border-radius: 50%;
    background: #ffb6c1;
    box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    color: #880e4f;
    font-weight: 700;
    text-transform: uppercase;
  }
  .name {
    font-size: 11px;
    font-weight: 700;
    margin-top: 2px;
    user-select: none;
  }
  .dimmed {
    opacity: 0.3;
    transform: scale(0.7);
    filter: grayscale(70%);
  }
  .selected {
    border: 3px solid #d63384;
    box-shadow: 0 0 15px 4px #d63384;
  }
  .winner {
    animation: dizzySpin 2s linear infinite;
    z-index: 9999 !important;
    position: fixed !important;
    left: 50% !important;
    top: 50% !important;
    transform: translate(-50%, -50%) scale(4) rotate(0deg);
    transition: all 0.5s ease;
    background: #ff69b4 !important;
    color: white !important;
    font-size: 160px !important;
    width: 160px !important;
    height: 160px !important;
    line-height: 160px !important;
    border-radius: 50% !important;
    box-shadow: 0 0 40px 8px #ff1493 !important;
    flex-direction: column !important;
    user-select: none;
  }
  @keyframes dizzySpin {
    from { transform: translate(-50%, -50%) scale(4) rotate(0deg);}
    to { transform: translate(-50%, -50%) scale(4) rotate(360deg);}
  }
  button {
    background: #d63384;
    border: none;
    color: white;
    padding: 14px 30px;
    font-size: 18px;
    margin: 10px 6px;
    border-radius: 25px;
    cursor: pointer;
    box-shadow: 0 3px 10px rgba(214,51,132,0.7);
    transition: background-color 0.3s ease;
  }
  button:hover {
    background-color: #a30052;
  }
  #result {
    font-size: 22px;
    margin-top: 15px;
    min-height: 36px;
    color: #d63384;
    font-weight: 700;
  }
  #history {
    max-width: 960px;
    margin: 0 auto;
    text-align: left;
    color: #555;
  }
  #history h2 {
    color: #d63384;
  }
  #historyList {
    list-style: none;
    padding-left: 0;
    font-size: 16px;
  }
  #historyList li {
    padding: 4px 0;
    border-bottom: 1px solid #eee;
  }
</style>
</head>
<body>

<h1>ğŸ² Chá»n ngáº«u nhiÃªn há»c sinh vui nhá»™n ğŸ‰</h1>

<div id="container"></div>

<div>
  <button id="btnRandom">ğŸš€ Chá»n Ngáº«u NhiÃªn</button>
  <button id="btnContinue" style="display:none;">ğŸ”„ Tiáº¿p tá»¥c</button>
</div>

<div id="result"></div>

<section id="history">
  <h2>Lá»‹ch sá»­ káº¿t quáº£</h2>
  <ul id="historyList"></ul>
</section>

<script>
  // 50 icon dá»… thÆ°Æ¡ng lÃ m con váº­t Ä‘áº¡i diá»‡n
  const animalIcons = [
    'ğŸ¶','ğŸ±','ğŸ­','ğŸ¹','ğŸ°','ğŸ¦Š','ğŸ»','ğŸ¼','ğŸ¨','ğŸ¯',
    'ğŸ¦','ğŸ®','ğŸ·','ğŸ¸','ğŸµ','ğŸ”','ğŸ§','ğŸ¦','ğŸ¤','ğŸ£',
    'ğŸ¦†','ğŸ¦…','ğŸ¦‰','ğŸ¦‡','ğŸº','ğŸ—','ğŸ´','ğŸ¦„','ğŸ','ğŸ›',
    'ğŸ¦‹','ğŸŒ','ğŸ','ğŸœ','ğŸ•·ï¸','ğŸ¦‚','ğŸ¢','ğŸ','ğŸ¦','ğŸ™',
    'ğŸ¦€','ğŸ ','ğŸ¬','ğŸ³','ğŸ‹','ğŸ¦ˆ','ğŸŠ','ğŸ…','ğŸ†','ğŸ¦“'
  ];

  // Danh sÃ¡ch 50 há»c sinh (vÃ­ dá»¥ tÃªn gá»‘c)
  let students = [
    "Nguyá»…n VÄƒn An", "Tráº§n Thá»‹ BÃ¬nh", "LÃª Minh CÆ°á»ng", "Pháº¡m Thá»‹ DuyÃªn", "HoÃ ng VÄƒn ÄÃ´ng",
    "VÃµ Minh Thá»‹nh", "BÃ¹i Thá»‹ Há»“ng", "Äáº·ng VÄƒn Khoa", "Phan Thá»‹ Lan", "TrÆ°Æ¡ng VÄƒn Nam",
    "LÃ½ Thá»‹ Oanh", "NgÃ´ VÄƒn PhÃºc", "VÅ© Thá»‹ Quá»³nh", "Äá»— VÄƒn SÆ¡n", "PhÃ¹ng Thá»‹ Thanh",
    "LÃ¢m VÄƒn Tuáº¥n", "Trá»‹nh Thá»‹ UyÃªn", "Há»“ VÄƒn Vinh", "DÆ°Æ¡ng Thá»‹ Xinh", "Mai VÄƒn YÃªn",
    "Tráº§n VÄƒn Anh", "Nguyá»…n Thá»‹ BÃ¬nh", "LÃª VÄƒn CÆ°á»ng", "Pháº¡m Thá»‹ Dung", "HoÃ ng Thá»‹ Dung",
    "VÃµ VÄƒn Thá»‹nh", "BÃ¹i Thá»‹ Hoa", "Äáº·ng VÄƒn KiÃªn", "Phan Thá»‹ Linh", "TrÆ°Æ¡ng VÄƒn Nam",
    "LÃ½ Thá»‹ Oanh", "NgÃ´ VÄƒn Phong", "VÅ© Thá»‹ Quang", "Äá»— VÄƒn SÆ¡n", "PhÃ¹ng Thá»‹ Thanh",
    "LÃ¢m VÄƒn TÃº", "Trá»‹nh Thá»‹ UyÃªn", "Há»“ VÄƒn VÄ©nh", "DÆ°Æ¡ng Thá»‹ Xinh", "Mai VÄƒn Yáº¿n",
    "Tráº§n VÄƒn Anh", "Nguyá»…n Thá»‹ BÃ¬nh", "LÃª VÄƒn CÆ°á»ng", "Pháº¡m Thá»‹ Dung", "HoÃ ng Thá»‹ Dung",
    "VÃµ VÄƒn Thá»‹nh", "BÃ¹i Thá»‹ Hoa", "Äáº·ng VÄƒn KiÃªn", "Phan Thá»‹ Linh", "TrÆ°Æ¡ng VÄƒn Nam"
  ];

  // Chuáº©n hÃ³a tÃªn: VD "VÃµ Minh Thá»‹nh" thÃ nh "VM THá»ŠNH"
  function shortName(fullName) {
    fullName = fullName.trim();
    const parts = fullName.split(/\s+/);
    if(parts.length === 1) return fullName.toUpperCase();
    const firstInitial = parts[0][0].toUpperCase();
    const lastName = parts[parts.length-1].toUpperCase();
    return firstInitial + lastName;
  }

  // Máº£ng lÆ°u Ä‘á»‘i tÆ°á»£ng student {name, short, icon, x, y, element}
  let activeStudents = [];

  const container = document.getElementById('container');
  const btnRandom = document.getElementById('btnRandom');
  const btnContinue = document.getElementById('btnContinue');
  const result = document.getElementById('result');
  const historyList = document.getElementById('historyList');

  // Táº¡o vá»‹ trÃ­ ngáº«u nhiÃªn trong container, khÃ´ng chá»“ng lÃªn nhau
  function randomPosition(existingPositions, width=50, height=50) {
    const containerRect = container.getBoundingClientRect();
    const maxX = container.clientWidth - width;
    const maxY = container.clientHeight - height;
    let tries = 0;
    while(tries < 1000){
      const x = Math.floor(Math.random()*maxX);
      const y = Math.floor(Math.random()*maxY);
      // check khoáº£ng cÃ¡ch vá»›i cÃ¡c vá»‹ trÃ­ khÃ¡c, trÃ¡nh chá»“ng chÃ©o
      if(existingPositions.every(p => {
        const dx = p.x - x;
        const dy = p.y - y;
        return Math.sqrt(dx*dx + dy*dy) > 60;
      })) {
        return {x,y};
      }
      tries++;
    }
    // fallback
    return {x:0,y:0};
  }

  // Táº¡o icon há»c sinh lÃªn mÃ n hÃ¬nh
  function createStudents(){
    activeStudents = [];
    container.innerHTML = '';
    let positions = [];
    for(let i=0; i<students.length; i++){
      const icon = animalIcons[i % animalIcons.length];
      const name = students[i];
      const short = shortName(name);
      const pos = randomPosition(positions);
      positions.push(pos);

      const el = document.createElement('div');
      el.classList.add('student');
      el.style.left = pos.x + 'px';
      el.style.top = pos.y + 'px';
      el.innerHTML = `<div class="icon">${icon}</div><div class="name">${short}</div>`;

      container.appendChild(el);

      activeStudents.push({name, short, icon, x: pos.x, y: pos.y, element: el});
    }
  }

  createStudents();

  // XÃ¡o trá»™n vá»‹ trÃ­ vÃ  nháº£y nhÃ³t (lá»™n xá»™n)
  function shufflePositions(){
    let positions = [];
    activeStudents.forEach(s => {
      const pos = randomPosition(positions);
      positions.push(pos);
      s.x = pos.x;
      s.y = pos.y;
      s.element.style.left = s.x + 'px';
      s.element.style.top = s.y + 'px';
      s.element.classList.remove('selected','winner','dimmed');
      s.element.style.opacity = '1';
      s.element.style.transform = 'scale(1) rotate(0deg)';
    });
  }

  // Xá»­ lÃ½ chá»n ngáº«u nhiÃªn
  let selectedStudent = null;
  let jumpCount = 0;
  let jumpInterval = null;
  const jumps = 30;

  function selectRandomStudent(){
    btnRandom.disabled = true;
    btnContinue.style.display = 'none';
    result.textContent = '';

    jumpCount = 0;

    jumpInterval = setInterval(() => {
      shufflePositions();
      jumpCount++;

      if(jumpCount >= jumps){
        clearInterval(jumpInterval);

        // Chá»n random
        const idx = Math.floor(Math.random() * activeStudents.length);
        selectedStudent = activeStudents[idx];

        // reset class
        activeStudents.forEach(s=>{
          s.element.classList.remove('selected','winner','dimmed');
          s.element.style.position = 'absolute';
        });

        // gÃ¡n class winner cho ngÆ°á»i tháº¯ng
        selectedStudent.element.classList.add('selected','winner');

        // cÃ¡c icon khÃ¡c má» nhá»
        activeStudents.forEach(s=>{
          if(s !== selectedStudent){
            s.element.classList.add('dimmed');
            s.element.style.position = 'relative';
          }
        });

        // Cáº­p nháº­t káº¿t quáº£
        result.textContent = `ğŸ‰ ÄÃ£ chá»n: ${selectedStudent.icon} ${selectedStudent.name.toUpperCase()} ğŸ‰`;
        updateHistory(selectedStudent.name.toUpperCase(), selectedStudent.icon);

        // PhÃ¡t Ã¢m thanh vui nhá»™n
        const audio = new Audio('https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg');
        audio.volume = 0.6;
        audio.play();

        btnRandom.style.display = "none";
        btnContinue.style.display = "inline-block";
        btnRandom.disabled = false;
      }
    }, 150);
  }

  btnRandom.addEventListener('click', selectRandomStudent);

  // Lá»‹ch sá»­ káº¿t quáº£
  let history = [];

  function updateHistory(name, icon){
    history.unshift({name, icon});
    if(history.length > 10) history.pop();
    historyList.innerHTML = '';
    history.forEach((item, i) => {
      const li = document.createElement('li');
      li.textContent = `${item.icon}  ${item.name}`;
      historyList.appendChild(li);
    });
  }

  // NÃºt tiáº¿p tá»¥c - loáº¡i bá» ngÆ°á»i tháº¯ng, lÃ m láº¡i
  btnContinue.addEventListener('click', () => {
    if(selectedStudent){
      // Loáº¡i bá» ngÆ°á»i tháº¯ng ra khá»i danh sÃ¡ch
      students = students.filter(s => s !== selectedStudent.name);
      createStudents();
      selectedStudent = null;
      result.textContent = '';
      btnRandom.style.display = "inline-block";
      btnContinue.style.display = "none";
    }
  });
</script>

</body>
</html>
