<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flashcard Ph√≤ng Ch·ªëng Thu·ªëc L√° - Giao di·ªán m·ªõi</title>
    <!-- Tone.js for Web Audio -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.77/Tone.js"></script>
    <style>
        /* Import Google Font */
        @import url('https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;700;900&display=swap');

        /* General Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Be Vietnam Pro', sans-serif; /* Apply new font */
            background: linear-gradient(135deg, #89f7fe 0%, #66a6ff 100%);
            height: 100vh;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #333;
        }

        /* --- Animated Background START --- */
        .background-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            overflow: hidden;
        }

        .background-particles {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            padding: 0;
            margin: 0;
        }

        .background-particles li {
            position: absolute;
            display: block;
            list-style: none;
            width: 20px;
            height: 20px;
            background: rgba(255, 255, 255, 0.2);
            animation: animate-particles 25s linear infinite;
            bottom: -150px;
        }

        .background-particles li:nth-child(1){ left: 25%; width: 80px; height: 80px; animation-delay: 0s; }
        .background-particles li:nth-child(2){ left: 10%; width: 20px; height: 20px; animation-delay: 2s; animation-duration: 12s; }
        .background-particles li:nth-child(3){ left: 70%; width: 20px; height: 20px; animation-delay: 4s; }
        .background-particles li:nth-child(4){ left: 40%; width: 60px; height: 60px; animation-delay: 0s; animation-duration: 18s; }
        .background-particles li:nth-child(5){ left: 65%; width: 20px; height: 20px; animation-delay: 0s; }
        .background-particles li:nth-child(6){ left: 75%; width: 110px; height: 110px; animation-delay: 3s; }
        .background-particles li:nth-child(7){ left: 35%; width: 150px; height: 150px; animation-delay: 7s; }
        .background-particles li:nth-child(8){ left: 50%; width: 25px; height: 25px; animation-delay: 15s; animation-duration: 45s; }
        .background-particles li:nth-child(9){ left: 20%; width: 15px; height: 15px; animation-delay: 2s; animation-duration: 35s; }
        .background-particles li:nth-child(10){ left: 85%; width: 150px; height: 150px; animation-delay: 0s; animation-duration: 11s; }

        @keyframes animate-particles {
            0%{
                transform: translateY(0) rotate(0deg);
                opacity: 1;
                border-radius: 0;
            }
            100%{
                transform: translateY(-1000px) rotate(720deg);
                opacity: 0;
                border-radius: 50%;
            }
        }
        /* --- Animated Background END --- */

        .app-container {
            width: 100%;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            position: relative; /* Ensure app content is above background */
            z-index: 1;
        }

        /* Welcome Screen */
        .welcome-screen {
            text-align: center;
            max-width: 500px;
            width: 100%;
        }

        .welcome-card {
            background: rgba(255,255,255,0.6);
            backdrop-filter: blur(25px);
            border-radius: 25px;
            padding: 40px 30px;
            border: 2px solid rgba(255,255,255,0.8);
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            color: #444;
        }

        .welcome-icon {
            font-size: 4rem;
            margin-bottom: 20px;
            animation: bounce 2s infinite;
        }
        
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {transform: translateY(0);}
            40% {transform: translateY(-20px);}
            60% {transform: translateY(-10px);}
        }

        .welcome-title {
            font-size: 2.5rem;
            font-weight: 900;
            margin-bottom: 15px;
            color: #1a237e;
            letter-spacing: -1px;
        }

        .welcome-subtitle {
            font-size: 1.1rem;
            color: #555;
            margin-bottom: 30px;
            line-height: 1.6;
        }

        .welcome-features {
            display: grid;
            gap: 12px;
            margin-bottom: 30px;
        }

        .feature {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            font-size: 0.9rem;
            padding: 10px;
            background: rgba(255,255,255,0.5);
            border-radius: 12px;
            border: 1px solid rgba(255,255,255,0.7);
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .feature:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .start-btn {
            background: linear-gradient(135deg, #ff7e5f, #feb47b);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.1rem;
            font-weight: 700;
            border-radius: 50px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 10px 20px rgba(255, 126, 95, 0.3);
        }

        .start-btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 12px 25px rgba(255, 126, 95, 0.4);
        }

        /* Game Screen */
        .game-screen {
            width: 100%;
            max-width: 700px;
            height: 100vh;
            display: none; /* Initially hidden */
            grid-template-rows: auto 1fr auto;
            gap: 15px;
            padding: 20px 0;
            position: relative;
        }

        .game-header {
            background: rgba(255,255,255,0.5);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px;
            border: 1px solid rgba(255,255,255,0.6);
            color: #444;
            position: relative;
        }
        
        #muteBtn {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.5rem;
            cursor: pointer;
            background: none;
            border: none;
            opacity: 0.7;
            transition: opacity 0.2s, transform 0.2s;
        }
        #muteBtn:hover {
            opacity: 1;
            transform: scale(1.1);
        }

        .progress-bar {
            background: rgba(0,0,0,0.1);
            height: 20px;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .progress-fill {
            background: linear-gradient(90deg, #56ab2f, #a8e063);
            height: 100%;
            width: 0%;
            transition: width 0.8s cubic-bezier(0.25, 1, 0.5, 1);
            border-radius: 10px;
            position: relative;
        }
        
        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            background-image: linear-gradient(to right, rgba(255,255,255,0) 0%, rgba(255,255,255,0.5) 50%, rgba(255,255,255,0) 100%);
            animation: progress-shine 2s infinite;
        }
        @keyframes progress-shine {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }


        .stats {
            display: flex;
            justify-content: space-between;
            font-weight: 700;
            font-size: 0.9rem;
            padding-right: 30px; /* Space for mute button */
        }

        .card-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 20px;
        }
        
        .card-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 700;
            width: 100%;
            max-width: 500px;
            margin-bottom: -5px;
            color: #1a237e;
            text-shadow: 1px 1px 3px rgba(255, 255, 255, 0.2);
        }

        .card-hint {
            font-size: 0.9rem;
            opacity: 0.9;
            font-weight: 400;
        }

        .card-container {
            perspective: 1000px;
            width: 100%;
            max-width: 500px;
            height: 320px;
        }

        .flashcard {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.8s cubic-bezier(0.25, 1, 0.5, 1);
            cursor: pointer;
        }

        .flashcard.flipped {
            transform: rotateY(180deg);
        }

        .flashcard.fade-out {
            animation: fadeOut 0.5s ease-in-out forwards;
        }

        @keyframes fadeOut {
            from { transform: scale(1) rotateY(var(--flip-angle, 0deg)); opacity: 1; }
            to { transform: scale(0.8) rotateY(var(--flip-angle, 0deg)); opacity: 0; }
        }

        .flashcard.fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }

        @keyframes fadeIn {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 30px;
            border: 3px solid white;
            color: white;
            transition: box-shadow 0.8s ease;
        }

        /* --- Theme Colors START --- */
        /* Danger Theme (Red/Orange) */
        .card-face.danger-theme {
            background: linear-gradient(135deg, #ff6b6b, #e91e63);
            animation-name: glow-danger;
            animation-duration: 2.5s;
            animation-iteration-count: infinite;
            animation-direction: alternate;
        }
        .card-face.danger-theme.card-back {
            background: linear-gradient(135deg, #ff8a65, #ff7043);
        }
        @keyframes glow-danger {
            from { box-shadow: 0 0 10px rgba(255,107,107,0.4), 0 0 20px rgba(233,30,99,0.3); }
            to { box-shadow: 0 0 25px rgba(255,107,107,0.8), 0 0 40px rgba(233,30,99,0.6); }
        }

        /* Benefit Theme (Green) */
        .card-face.benefit-theme {
            background: linear-gradient(135deg, #56ab2f, #a8e063);
            animation-name: glow-benefit;
            animation-duration: 2.5s;
            animation-iteration-count: infinite;
            animation-direction: alternate;
        }
        .card-face.benefit-theme.card-back {
            background: linear-gradient(135deg, #66bb6a, #9ccc65);
        }
        @keyframes glow-benefit {
            from { box-shadow: 0 0 10px rgba(86,171,47,0.4), 0 0 20px rgba(168,224,99,0.3); }
            to { box-shadow: 0 0 25px rgba(86,171,47,0.8), 0 0 40px rgba(168,224,99,0.6); }
        }

        /* Info Theme (Blue) */
        .card-face.info-theme {
            background: linear-gradient(135deg, #48c6ef, #6f86d6);
            animation-name: glow-info;
            animation-duration: 2.5s;
            animation-iteration-count: infinite;
            animation-direction: alternate;
        }
        .card-face.info-theme.card-back {
            background: linear-gradient(135deg, #29b6f6, #5c6bc0);
        }
        @keyframes glow-info {
            from { box-shadow: 0 0 10px rgba(72,198,239,0.4), 0 0 20px rgba(111,134,214,0.3); }
            to { box-shadow: 0 0 25px rgba(72,198,239,0.8), 0 0 40px rgba(111,134,214,0.6); }
        }
        /* --- Theme Colors END --- */

        .card-back {
            transform: rotateY(180deg);
        }

        .card-content { width: 100%; }

        .card-front .card-content {
            font-size: 1.6rem;
            font-weight: 900;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            text-shadow: 0px 2px 5px rgba(0, 0, 0, 0.4);
            line-height: 1.4;
        }

        .card-back .card-content {
            font-size: 1.1rem;
            line-height: 1.7;
            text-align: left;
            text-shadow: 0px 2px 5px rgba(0, 0, 0, 0.4);
        }

        .card-icon {
            font-size: 2.8rem;
            margin-bottom: 10px;
            text-shadow: 0 0 15px rgba(255,255,255,0.5), 0px 2px 5px rgba(0, 0, 0, 0.4);
        }

        .card-category {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255,255,255,0.2);
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
        }
        
        /* Controls */
        .game-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 10px;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s ease-out;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            color: white;
            border-bottom: 4px solid rgba(0,0,0,0.2);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        
        .btn:active {
            transform: translateY(1px);
            border-bottom-width: 2px;
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: translateY(0);
            background-color: #aaa;
            border-bottom-color: #777;
        }
        
        .btn-success { background-color: #2ecc71; border-bottom-color: #27ae60; }
        .btn-warning { background-color: #f39c12; border-bottom-color: #d35400; }
        .btn-primary { background-color: #3498db; border-bottom-color: #2980b9; }


        /* Completion Message */
        .completion-message {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6);
            backdrop-filter: blur(10px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.4s ease;
        }
        
        .completion-message.show {
            display: flex;
            opacity: 1;
        }

        .completion-content {
            background: linear-gradient(135deg, #56ab2f, #a8e063);
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            transform: scale(0.7);
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            position: relative;
        }
        
        .completion-message.show .completion-content {
            transform: scale(1);
            opacity: 1;
        }

        .completion-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            animation: tada 1.5s infinite;
        }
        
        @keyframes tada {
           0% {transform: scale(1);}
           10%, 20% {transform: scale(0.9) rotate(-3deg);}
           30%, 50%, 70%, 90% {transform: scale(1.1) rotate(3deg);}
           40%, 60%, 80% {transform: scale(1.1) rotate(-3deg);}
           100% {transform: scale(1) rotate(0);}
        }

        .completion-content h2 {
            font-size: 2.5rem;
            font-weight: 900;
            margin-bottom: 15px;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }
        .completion-content p { color: white; }

        .completion-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 20px;
        }
        
        /* Confetti */
        .confetti { position: absolute; width: 10px; height: 10px; background-color: #f00; opacity: 0; }
        .confetti.animate { animation: confetti-fall 3s linear forwards; }
        @keyframes confetti-fall {
            0% { transform: translateY(-100px) rotateZ(0deg); opacity: 1; }
            100% { transform: translateY(300px) rotateZ(360deg); opacity: 0; }
        }
        
        /* Info Popup Modal */
        .info-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.6);
            backdrop-filter: blur(10px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .info-modal-overlay.show {
            display: flex;
            opacity: 1;
        }
        .info-modal {
            background: white;
            color: #333;
            padding: 30px;
            border-radius: 20px;
            max-width: 450px;
            width: 90%;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transform: scale(0.8);
            opacity: 0;
            transition: all 0.3s ease;
            position: relative;
        }
        .info-modal-overlay.show .info-modal {
            transform: scale(1);
            opacity: 1;
        }
        .info-modal-title {
            font-size: 1.5rem;
            font-weight: 900;
            color: #1a237e;
            margin-bottom: 15px;
        }
        .info-modal-content {
            font-size: 1rem;
            line-height: 1.6;
            margin-bottom: 20px;
        }
        .info-modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.5rem;
            cursor: pointer;
            background: none;
            border: none;
            color: #aaa;
        }
        .info-modal-close:hover {
            color: #333;
        }
        
        /* Home Button */
        .home-btn {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
            color: #333;
            padding: 10px 20px;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 700;
            font-size: 0.9rem;
            z-index: 1001; /* Higher than completion message */
            border: 1px solid rgba(255,255,255,0.8);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: all 0.2s ease;
        }

        .home-btn:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
            background: rgba(255, 255, 255, 0.9);
        }
        
        /* Fullscreen Button */
        .fullscreen-btn {
            position: fixed;
            bottom: 20px;
            left: 210px; /* Adjusted position */
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
            color: #333;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            text-decoration: none;
            font-weight: 700;
            font-size: 1.2rem;
            z-index: 1001;
            border: 1px solid rgba(255,255,255,0.8);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: all 0.2s ease;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .fullscreen-btn:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
            background: rgba(255, 255, 255, 0.9);
        }


        @media (max-width: 768px) {
            .app-container { padding: 15px; }
            .welcome-card { padding: 30px 20px; }
            .welcome-title { font-size: 2rem; }
            .card-container { height: 300px; }
            .card-front .card-content { font-size: 1.3rem; }
            .card-back .card-content { font-size: 1rem; }
            .btn { padding: 10px 16px; font-size: 0.8rem; }
            .game-controls { gap: 10px; }
            .home-btn {
                font-size: 0.8rem;
                padding: 8px 15px;
                bottom: 15px;
                left: 15px;
            }
            .fullscreen-btn {
                left: 165px; /* Adjusted for mobile */
                bottom: 15px;
                width: 40px;
                height: 40px;
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="background-container">
        <ul class="background-particles">
            <li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li>
        </ul>
    </div>
    <div class="app-container">
        <!-- Home Button -->
        <a href="index.html" class="home-btn">üè† V·ªÅ m√†n h√¨nh ch√≠nh</a>
        <!-- Fullscreen Button -->
        <button id="fullscreenBtn" class="fullscreen-btn">‚õ∂</button>
        
        <!-- Welcome Screen -->
        <div class="welcome-screen" id="welcomeScreen">
            <div class="welcome-card">
                <div class="welcome-icon">üö≠</div>
                <h1 class="welcome-title">Flashcard Ph·ªïi Kh·ªèe</h1>
                <p class="welcome-subtitle">C√πng kh√°m ph√° ki·∫øn th·ª©c v·ªÅ ph√≤ng ch·ªëng thu·ªëc l√° m·ªôt c√°ch th·∫≠t vui!</p>
                
                <div class="welcome-features">
                    <div class="feature" onclick="showInfoPopup('science')"><span>üß™</span><span>Ki·∫øn th·ª©c y khoa</span></div>
                    <div class="feature" onclick="showInfoPopup('vape')"><span>‚ö°</span><span>S·ª± th·∫≠t v·ªÅ Vape</span></div>
                    <div class="feature" onclick="showInfoPopup('stats')"><span>üìä</span><span>Th·ªëng k√™ WHO</span></div>
                </div>
                
                <button class="start-btn" onclick="startGame()">
                    <span>B·∫Øt ƒë·∫ßu ngay</span>
                    <span>‚Üí</span>
                </button>
            </div>
        </div>

        <!-- Game Screen -->
        <div class="game-screen" id="gameScreen">
            <div class="game-header">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <div class="stats">
                    <div>ƒê√£ h·ªçc: <span id="studiedCount">0</span>/24</div>
                    <div>Ti·∫øn tr√¨nh: <span id="progressPercent">0</span>%</div>
                    <div>Th·∫ª: <span id="currentCardStat">1</span>/24</div>
                </div>
                 <button id="muteBtn">üîä</button>
            </div>

            <div class="card-section">
                <div class="card-info">
                    <div>Th·∫ª <span id="cardNumber">1</span> / 24</div>
                    <div class="card-hint">üëÜ B·∫•m v√†o th·∫ª ƒë·ªÉ l·∫≠t</div>
                </div>

                <div class="card-container">
                    <div class="flashcard" id="flashcard">
                        <div class="card-face card-front" id="cardFront">
                            <div class="card-category">C√¢u h·ªèi</div>
                            <div class="card-content" id="frontContent"></div>
                        </div>
                        <div class="card-face card-back" id="cardBack">
                            <div class="card-category">Tr·∫£ l·ªùi</div>
                            <div class="card-content" id="backContent"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="game-controls">
                <button class="btn btn-warning" id="prevBtn" onclick="previousCardWithAnimation()">
                    <span>‚Üê</span> Quay l·∫°i
                </button>
                <button class="btn btn-success" id="nextBtn" onclick="nextCardWithAnimation()">
                    Ti·∫øp theo <span>‚Üí</span>
                </button>
            </div>
        </div>

        <!-- Completion Message -->
        <div class="completion-message" id="completionMessage">
            <div class="completion-content" id="completionContent">
                <div class="completion-icon">üéâ</div>
                <h2>Tuy·ªát v·ªùi!</h2>
                <p>B·∫°n ƒë√£ ho√†n th√†nh b·ªô th·∫ª Ph·ªïi Kh·ªèe!</p>
                <div class="completion-buttons">
                    <button class="btn btn-primary" onclick="resetProgress()">üîÑ H·ªçc l·∫°i</button>
                    <button class="btn btn-warning" onclick="continueGame()">üîÄ X√°o tr·ªôn</button>
                </div>
            </div>
        </div>
        
        <!-- Info Popup Modal -->
        <div class="info-modal-overlay" id="infoModalOverlay">
            <div class="info-modal" id="infoModal">
                <button class="info-modal-close" onclick="hideInfoPopup()">√ó</button>
                <h2 class="info-modal-title" id="infoModalTitle"></h2>
                <p class="info-modal-content" id="infoModalContent"></p>
            </div>
        </div>

    </div>

    <script>
        // --- DATA ---
        const flashcards = [
            { front: "üß™ Nicotine l√† g√¨?", back: "üíÄ Nicotine l√† ch·∫•t g√¢y nghi·ªán c√≥ trong thu·ªëc l√° v√† thu·ªëc l√° ƒëi·ªán t·ª≠. Ch·ªâ c·∫ßn 10 gi√¢y ƒë·ªÉ nicotine ƒë·∫øn n√£o, g√¢y nghi·ªán nhanh ch√≥ng v√† r·∫•t kh√≥ cai. ƒê√¢y l√† l√Ω do ch√≠nh khi·∫øn ng∆∞·ªùi h√∫t thu·ªëc kh√≥ b·ªè ƒë∆∞·ª£c th√≥i quen n√†y.", category: "info" },
            { front: "‚ö° Thu·ªëc l√° ƒëi·ªán t·ª≠ (Vape) c√≥ an to√†n kh√¥ng?", back: "‚ùå KH√îNG AN TO√ÄN! Thu·ªëc l√° ƒëi·ªán t·ª≠ v·∫´n ch·ª©a nicotine g√¢y nghi·ªán v√† nhi·ªÅu ch·∫•t ƒë·ªôc h·∫°i nh∆∞ formaldehyde. WHO kh·∫≥ng ƒë·ªãnh thu·ªëc l√° ƒëi·ªán t·ª≠ kh√¥ng an to√†n v√† c√≥ th·ªÉ g√¢y b·ªánh ph·ªïi nghi√™m tr·ªçng.", category: "danger" },
            { front: "üå¨Ô∏è Kh√≥i thu·ªëc th·ª• ƒë·ªông c√≥ h·∫°i nh∆∞ th·∫ø n√†o?", back: "‚ò†Ô∏è Kh√≥i thu·ªëc th·ª• ƒë·ªông ch·ª©a h∆°n 250 ch·∫•t ƒë·ªôc h·∫°i, g√¢y ung th∆∞ ph·ªïi, b·ªánh tim m·∫°ch, hen suy·ªÖn ·ªü tr·∫ª em. Kh√¥ng c√≥ m·ª©c ƒë·ªô ti·∫øp x√∫c n√†o ƒë∆∞·ª£c coi l√† an to√†n!", category: "danger" },
            { front: "üéØ Thu·ªëc l√° g√¢y ra nh·ªØng b·ªánh ung th∆∞ n√†o?", back: "üî¢ √çt nh·∫•t 16 lo·∫°i ung th∆∞: ph·ªïi, h·ªçng, th·ª±c qu·∫£n, b√†ng quang, gan, d·∫° d√†y, t·ª•y, th·∫≠n, c·ªï t·ª≠ cung v√† nhi·ªÅu c∆° quan kh√°c. Nguy c∆° m·∫Øc ung th∆∞ tƒÉng 15-30 l·∫ßn so v·ªõi ng∆∞·ªùi kh√¥ng h√∫t thu·ªëc!", category: "danger" },
            { front: "üë∂ H√∫t thu·ªëc ·∫£nh h∆∞·ªüng ƒë·∫øn kh·∫£ nƒÉng sinh s·∫£n?", back: "üíî H√∫t thu·ªëc gi·∫£m kh·∫£ nƒÉng sinh s·∫£n ·ªü c·∫£ nam v√† n·ªØ, c√≥ th·ªÉ g√¢y v√¥ sinh. ·ªû ph·ª• n·ªØ mang thai c√≥ th·ªÉ d·∫´n ƒë·∫øn s·∫£y thai, sinh non v√† nhi·ªÅu bi·∫øn ch·ª©ng nguy hi·ªÉm kh√°c.", category: "danger" },
            { front: "‚è∞ C∆° th·ªÉ h·ªìi ph·ª•c nh∆∞ th·∫ø n√†o khi b·ªè thu·ªëc?", back: "üöÄ 20 ph√∫t: nh·ªãp tim v√† huy·∫øt √°p gi·∫£m. 12 gi·ªù: kh√≠ CO tr·ªü v·ªÅ b√¨nh th∆∞·ªùng. 2 tu·∫ßn: tu·∫ßn ho√†n m√°u c·∫£i thi·ªán. 1 th√°ng: ch·ª©c nƒÉng ph·ªïi tƒÉng 30%. 1 nƒÉm: nguy c∆° b·ªánh tim gi·∫£m 50%!", category: "benefit" },
            { front: "‚ò†Ô∏è Thu·ªëc l√° ch·ª©a bao nhi√™u ch·∫•t ƒë·ªôc h·∫°i?", back: "üß™ H∆°n 7.000 ch·∫•t h√≥a h·ªçc, trong ƒë√≥ c√≥ 70+ ch·∫•t g√¢y ung th∆∞ nh∆∞ benzene, formaldehyde, polonium-210, hydrogen cyanide. H√∫t thu·ªëc gi·ªëng nh∆∞ h√≠t kh√≠ th·∫£i √¥ t√¥!", category: "info" },
            { front: "ü§î Thu·ªëc l√° ƒëi·ªán t·ª≠ c√≥ gi√∫p cai thu·ªëc kh√¥ng?", back: "‚ö†Ô∏è Ch∆∞a c√≥ b·∫±ng ch·ª©ng khoa h·ªçc ƒë·ªß m·∫°nh! Nhi·ªÅu ng∆∞·ªùi s·ª≠ d·ª•ng c·∫£ thu·ªëc l√° th∆∞·ªùng v√† ƒëi·ªán t·ª≠, l√†m tƒÉng nguy c∆°. Li·ªáu ph√°p thay th·∫ø nicotine ƒë∆∞·ª£c ch·ª©ng minh an to√†n h∆°n!", category: "info" },
            { front: "‚ú® H√∫t thu·ªëc l√†m l√£o h√≥a da nh∆∞ th·∫ø n√†o?", back: "üëµ Gi·∫£m l∆∞u l∆∞·ª£ng m√°u ƒë·∫øn da, ph√° h·ªßy collagen g√¢y l√£o h√≥a s·ªõm, n·∫øp nhƒÉn, da x·ªân m√†u v√† ch·∫≠m l√†nh v·∫øt th∆∞∆°ng. Ng∆∞·ªùi h√∫t thu·ªëc th∆∞·ªùng c√≥ n·∫øp nhƒÉn quanh m√¥i v√† m·∫Øt r√µ r·ªát!", category: "danger" },
            { front: "ü¶¥ H√∫t thu·ªëc ·∫£nh h∆∞·ªüng ƒë·∫øn x∆∞∆°ng kh·ªõp?", back: "üíÄ Gi·∫£m m·∫≠t ƒë·ªô x∆∞∆°ng, tƒÉng nguy c∆° lo√£ng x∆∞∆°ng v√† g√£y x∆∞∆°ng, ƒë·∫∑c bi·ªát ·ªü ph·ª• n·ªØ m√£n kinh. L√†m ch·∫≠m qu√° tr√¨nh l√†nh x∆∞∆°ng sau ch·∫•n th∆∞∆°ng ho·∫∑c ph·∫´u thu·∫≠t.", category: "danger" },
            { front: "üß† T·∫°i sao thanh thi·∫øu ni√™n kh√¥ng n√™n d√πng thu·ªëc l√° ƒëi·ªán t·ª≠?", back: "‚ö†Ô∏è N√£o b·ªô ph√°t tri·ªÉn ƒë·∫øn 25 tu·ªïi! Nicotine g√¢y t·ªïn th∆∞∆°ng vƒ©nh vi·ªÖn cho n√£o ƒëang ph√°t tri·ªÉn, d·∫´n ƒë·∫øn v·∫•n ƒë·ªÅ v·ªÅ tr√≠ nh·ªõ, ch√∫ √Ω v√† h·ªçc t·∫≠p. N√£o thanh thi·∫øu ni√™n d·ªÖ nghi·ªán g·∫•p 3 l·∫ßn!", category: "danger" },
            { front: "üõ°Ô∏è H√∫t thu·ªëc ·∫£nh h∆∞·ªüng ƒë·∫øn h·ªá mi·ªÖn d·ªãch?", back: "ü¶† L√†m suy y·∫øu mi·ªÖn d·ªãch, tƒÉng nguy c∆° nhi·ªÖm tr√πng ƒë∆∞·ªùng h√¥ h·∫•p, vi√™m ph·ªïi, c√∫m v√† c√°c tri·ªáu ch·ª©ng COVID-19 n·∫∑ng. L√†m ch·∫≠m qu√° tr√¨nh l√†nh v·∫øt th∆∞∆°ng.", category: "danger" },
            { front: "üí∞ Chi ph√≠ kinh t·∫ø c·ªßa vi·ªác h√∫t thu·ªëc?", back: "üìä Vi·ªát Nam: h∆°n 3 t·ª∑ USD/nƒÉm cho chi ph√≠ y t·∫ø. To√†n c·∫ßu: 1.4 ngh√¨n t·ª∑ USD/nƒÉm. Bao g·ªìm m·∫•t nƒÉng su·∫•t lao ƒë·ªông, t·ª≠ vong s·ªõm, chi ph√≠ ƒëi·ªÅu tr·ªã. L·ª£i √≠ch kinh t·∫ø khi b·ªè thu·ªëc r·∫•t l·ªõn!", category: "info" },
            { front: "üëÅÔ∏è H√∫t thu·ªëc ·∫£nh h∆∞·ªüng ƒë·∫øn th·ªã l·ª±c?", back: "üòµ TƒÉng nguy c∆° tho√°i h√≥a ƒëi·ªÉm v√†ng, ƒë·ª•c th·ªßy tinh th·ªÉ, b·ªánh v√µng m·∫°c ti·ªÉu ƒë∆∞·ªùng, t·ªïn th∆∞∆°ng d√¢y th·∫ßn kinh th·ªã gi√°c c√≥ th·ªÉ d·∫´n ƒë·∫øn m√π l√≤a. Ng∆∞·ªùi h√∫t thu·ªëc c√≥ nguy c∆° m√π g·∫•p 2 l·∫ßn!", category: "danger" },
            { front: "ü§± Ph·ª• n·ªØ mang thai h√∫t thu·ªëc c√≥ t√°c h·∫°i g√¨?", back: "üë∂ S·∫£y thai, thai ch·∫øt l∆∞u, sinh non, tr·∫ª nh·∫π c√¢n, d·ªã t·∫≠t b·∫©m sinh, h·ªôi ch·ª©ng ƒë·ªôt t·ª≠ ·ªü tr·∫ª s∆° sinh, ch·∫≠m ph√°t tri·ªÉn. Kh√≥i thu·ªëc gi√°n ti·∫øp c≈©ng c√≥ h·∫°i cho em b√©!", category: "danger" },
            { front: "ü¶∑ H√∫t thu·ªëc ·∫£nh h∆∞·ªüng ƒë·∫øn s·ª©c kh·ªèe rƒÉng mi·ªáng?", back: "üò¨ Ung th∆∞ mi·ªáng, b·ªánh n∆∞·ªõu, m·∫•t rƒÉng, h√¥i mi·ªáng, rƒÉng ·ªë v√†ng, ch·∫≠m l√†nh sau ph·∫´u thu·∫≠t nha khoa. Ng∆∞·ªùi h√∫t thu·ªëc m·∫•t rƒÉng g·∫•p 2-3 l·∫ßn ng∆∞·ªùi kh√¥ng h√∫t!", category: "danger" },
            { front: "üò∞ Tri·ªáu ch·ª©ng cai thu·ªëc l√† g√¨?", back: "üé¢ Lo √¢u, c√°u k·ªânh, kh√≥ t·∫≠p trung, tƒÉng c√¢n, m·∫•t ng·ªß, th√®m thu·ªëc. ƒê·ªânh ƒëi·ªÉm trong 3 ng√†y ƒë·∫ßu, gi·∫£m d·∫ßn sau 2-4 tu·∫ßn. H√£y nh·ªõ: kh√≥ khƒÉn t·∫°m th·ªùi, l·ª£i √≠ch vƒ©nh vi·ªÖn!", category: "info" },
            { front: "ü™¥ Shisha/Hookah c√≥ an to√†n h∆°n kh√¥ng?", back: "‚ùå HO√ÄN TO√ÄN SAI! Ch·ª©a c√πng c√°c ch·∫•t ƒë·ªôc nh∆∞ thu·ªëc l√° th∆∞·ªùng. 1 l·∫ßn h√∫t shisha = 100 ƒëi·∫øu thu·ªëc v·ªÅ l∆∞·ª£ng kh√≥i. N∆∞·ªõc kh√¥ng l·ªçc ƒë∆∞·ª£c ch·∫•t ƒë·ªôc. D√πng chung v√≤i c√≥ nguy c∆° l√¢y nhi·ªÖm!", category: "danger" },
            { front: "‚ù§Ô∏è H√∫t thu·ªëc ·∫£nh h∆∞·ªüng ƒë·∫øn tim m·∫°ch nh∆∞ th·∫ø n√†o?", back: "üíî TƒÉng nguy c∆° ƒëau tim 2-4 l·∫ßn, ƒë·ªôt qu·ªµ 2-4 l·∫ßn, b·ªánh ƒë·ªông m·∫°ch ngo·∫°i bi√™n, tƒÉng huy·∫øt √°p, tim ƒë·∫≠p nhanh, gi·∫£m oxy trong m√°u. X∆° v·ªØa ƒë·ªông m·∫°ch nhanh ch√≥ng!", category: "danger" },
            { front: "üéØ C√°ch cai thu·ªëc hi·ªáu qu·∫£ nh·∫•t?", back: "üí™ Ph∆∞∆°ng ph√°p k·∫øt h·ª£p: h·ªó tr·ª£ y t·∫ø, li·ªáu ph√°p thay th·∫ø nicotine, t∆∞ v·∫•n t√¢m l√Ω, nh√≥m h·ªó tr·ª£, ƒë∆∞·ªùng d√¢y n√≥ng cai thu·ªëc, ·ª©ng d·ª•ng di ƒë·ªông, ƒë·∫∑t ng√†y cai thu·ªëc, tr√°nh c√°c y·∫øu t·ªë k√≠ch th√≠ch!", category: "benefit" },
            { front: "üç¨ H∆∞∆°ng li·ªáu trong Vape c√≥ an to√†n kh√¥ng?", back: "‚ùå KH√îNG! Nhi·ªÅu h∆∞∆°ng li·ªáu (nh∆∞ diacetyl) an to√†n khi ƒÉn nh∆∞ng l·∫°i c·ª±c k·ª≥ ƒë·ªôc h·∫°i khi h√≠t v√†o ph·ªïi, g√¢y ra b·ªánh 'ph·ªïi b·ªèng ng√¥' (vi√™m ti·ªÉu ph·∫ø qu·∫£n t·∫Øc ngh·∫Ωn) kh√¥ng th·ªÉ h·ªìi ph·ª•c v√† c√°c t·ªïn th∆∞∆°ng nghi√™m tr·ªçng kh√°c.", category: "danger" },
            { front: "üåç Th·ªëng k√™ d·ªãch thu·ªëc l√° to√†n c·∫ßu?", back: "üìà 8 tri·ªáu ng∆∞·ªùi ch·∫øt/nƒÉm to√†n c·∫ßu, 1.3 t·ª∑ ng∆∞·ªùi s·ª≠ d·ª•ng. Thu·ªëc l√° gi·∫øt ch·∫øt 50% ng∆∞·ªùi s·ª≠ d·ª•ng. D·ª± b√°o ƒë·∫øn 2030: 8.3 tri·ªáu ng∆∞·ªùi ch·∫øt n·∫øu kh√¥ng h√†nh ƒë·ªông. ƒê·∫°i d·ªãch trong ƒë·∫°i d·ªãch!", category: "info" },
            { front: "üß¨ T√°c ƒë·ªông di truy·ªÅn c·ªßa vi·ªác h√∫t thu·ªëc?", back: "üî¨ H√∫t thu·ªëc thay ƒë·ªïi bi·ªÉu hi·ªán gen, c√≥ th·ªÉ truy·ªÅn sang th·∫ø h·ªá ti·∫øp theo. Tuy nhi√™n, b·ªè thu·ªëc c√≥ th·ªÉ ƒë·∫£o ng∆∞·ª£c m·ªôt s·ªë thay ƒë·ªïi di truy·ªÅn n√†y!", category: "info" },
            { front: "üí® Kh√≥i thu·ªëc t√†n l∆∞u l√† g√¨?", back: "üè† Ch·∫•t ƒë·ªôc t·ª´ kh√≥i thu·ªëc b√°m tr√™n b·ªÅ m·∫∑t, qu·∫ßn √°o, t√≥c. T·ªìn t·∫°i h√†ng th√°ng/nƒÉm. ƒê·∫∑c bi·ªát c√≥ h·∫°i cho tr·∫ª s∆° sinh v√† tr·∫ª nh·ªè. Kh√¥ng c√≥ m·ª©c ƒë·ªô ti·∫øp x√∫c n√†o ƒë∆∞·ª£c coi l√† an to√†n!", category: "danger" }
        ];

        // --- STATE & DOM ELEMENTS ---
        let currentCardIndex = 0;
        let studiedCards = new Set();
        let isFlipped = false;
        let isAnimating = false;
        let isMuted = true; // Audio is muted by default
        let audioInitialized = false;
        
        const welcomeScreen = document.getElementById('welcomeScreen');
        const gameScreen = document.getElementById('gameScreen');
        const flashcardEl = document.getElementById('flashcard');
        const cardFrontEl = document.getElementById('cardFront');
        const cardBackEl = document.getElementById('cardBack');
        const frontContentEl = document.getElementById('frontContent');
        const backContentEl = document.getElementById('backContent');
        const cardNumberEl = document.getElementById('cardNumber');
        const currentCardStatEl = document.getElementById('currentCardStat');
        const studiedCountEl = document.getElementById('studiedCount');
        const progressPercentEl = document.getElementById('progressPercent');
        const progressFillEl = document.getElementById('progressFill');
        const completionMessageEl = document.getElementById('completionMessage');
        const completionContentEl = document.getElementById('completionContent');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const muteBtn = document.getElementById('muteBtn');
        const fullscreenBtn = document.getElementById('fullscreenBtn');
        const infoModalOverlay = document.getElementById('infoModalOverlay');
        const infoModalTitle = document.getElementById('infoModalTitle');
        const infoModalContent = document.getElementById('infoModalContent');

        // --- AUDIO SETUP (Tone.js) ---
        let flipSound, clickSound, completionSound;

        function initAudio() {
            if (audioInitialized) return;
            
            Tone.start();

            // Set a master volume for consistency
            const masterVolume = -8; // in Decibels

            flipSound = new Tone.NoiseSynth({ noise: { type: 'white' }, envelope: { attack: 0.005, decay: 0.1, sustain: 0 } }).toDestination();
            flipSound.volume.value = masterVolume - 2; // Noise can be harsher, so a bit lower

            clickSound = new Tone.MembraneSynth({ pitchDecay: 0.01, octaves: 2, envelope: { attack: 0.001, decay: 0.2, sustain: 0 } }).toDestination();
            clickSound.volume.value = masterVolume;

            completionSound = new Tone.PolySynth(Tone.Synth, { oscillator: { type: "sine" }, envelope: { attack: 0.05, decay: 0.2, sustain: 0.3, release: 1 } }).toDestination();
            completionSound.volume.value = masterVolume;
            
            audioInitialized = true;
            isMuted = false;
            muteBtn.textContent = 'üîä';
        }

        function playSound(sound, note, duration, time) {
            if (isMuted || !audioInitialized) return;
            sound.triggerAttackRelease(note, duration, time);
        }

        // --- FUNCTIONS ---
        function startGame() {
            if (!audioInitialized) initAudio();
            
            shuffleCards();
            welcomeScreen.style.display = 'none';
            gameScreen.style.display = 'grid';
            flashcardEl.addEventListener('click', flipCard);
            updateDisplay();
        }

        function updateDisplay() {
            isAnimating = true;
            const card = flashcards[currentCardIndex];
            
            const frontParts = card.front.split(' ');
            frontContentEl.innerHTML = `<div class="card-icon">${frontParts[0]}</div><div>${frontParts.slice(1).join(' ')}</div>`;
            backContentEl.textContent = card.back;
            
            cardNumberEl.textContent = currentCardIndex + 1;
            currentCardStatEl.textContent = currentCardIndex + 1;
            
            const themeClass = `${card.category}-theme`;
            const themeClasses = ['danger-theme', 'benefit-theme', 'info-theme'];
            cardFrontEl.classList.remove(...themeClasses);
            cardBackEl.classList.remove(...themeClasses);
            cardFrontEl.classList.add(themeClass);
            cardBackEl.classList.add(themeClass);

            isFlipped = false;
            flashcardEl.classList.remove('flipped', 'fade-out');
            flashcardEl.style.setProperty('--flip-angle', '0deg');
            
            flashcardEl.classList.add('fade-in');
            setTimeout(() => {
                flashcardEl.classList.remove('fade-in');
                isAnimating = false;
            }, 500);

            prevBtn.disabled = currentCardIndex === 0;
            if (currentCardIndex === flashcards.length - 1) {
                nextBtn.innerHTML = 'Ho√†n th√†nh <span>‚úî</span>';
            } else {
                nextBtn.innerHTML = 'Ti·∫øp theo <span>‚Üí</span>';
            }

            updateProgress();
        }

        function updateProgress() {
            const studiedCount = studiedCards.size;
            const progressPercent = Math.round((studiedCount / flashcards.length) * 100);
            
            studiedCountEl.textContent = studiedCount;
            progressPercentEl.textContent = progressPercent;
            progressFillEl.style.width = progressPercent + '%';
            
            if (studiedCount === flashcards.length && !completionMessageEl.classList.contains('show')) {
                setTimeout(() => {
                    completionMessageEl.classList.add('show');
                    triggerConfetti();
                    if (!isMuted && audioInitialized) {
                        const now = Tone.now();
                        playSound(completionSound, ["C4", "E4", "G4"], "8n", now);
                        playSound(completionSound, "C5", "8n", now + 0.2);
                    }
                }, 500);
            }
        }

        function flipCard() {
            if (isAnimating) return;
            isFlipped = !isFlipped;
            flashcardEl.classList.toggle('flipped', isFlipped);
            playSound(flipSound, '8n');
            if (isFlipped && !studiedCards.has(currentCardIndex)) {
                studiedCards.add(currentCardIndex);
                updateProgress();
            }
        }

        function nextCardWithAnimation() {
            if (isAnimating) return;
            playSound(clickSound, 'C2', '8n');
            if (currentCardIndex >= flashcards.length - 1) {
                updateProgress();
                return;
            }
            
            isAnimating = true;
            flashcardEl.style.setProperty('--flip-angle', isFlipped ? '180deg' : '0deg');
            flashcardEl.classList.add('fade-out');

            setTimeout(() => {
                currentCardIndex++;
                updateDisplay();
            }, 500);
        }

        function previousCardWithAnimation() {
            if (isAnimating || currentCardIndex === 0) return;
            playSound(clickSound, 'C2', '8n');
            
            isAnimating = true;
            flashcardEl.style.setProperty('--flip-angle', isFlipped ? '180deg' : '0deg');
            flashcardEl.classList.add('fade-out');

            setTimeout(() => {
                currentCardIndex--;
                updateDisplay();
            }, 500);
        }

        function shuffleCards() {
            for (let i = flashcards.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [flashcards[i], flashcards[j]] = [flashcards[j], flashcards[i]];
            }
        }

        function resetProgress(shouldShuffle = false) {
            playSound(clickSound, 'C2', '8n');
            studiedCards.clear();
            currentCardIndex = 0;
            completionMessageEl.classList.remove('show');
            if (shouldShuffle) {
                shuffleCards();
            }
            updateDisplay();
        }
        
        function continueGame() {
            resetProgress(true); // Reset and shuffle
        }
        
        function triggerConfetti() {
            const colors = ['#f39c12', '#e74c3c', '#3498db', '#2ecc71', '#9b59b6'];
            for (let i = 0; i < 100; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + '%';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.animationDelay = Math.random() * 3 + 's';
                confetti.style.transform = `scale(${Math.random() * 0.5 + 0.5})`;
                completionContentEl.appendChild(confetti);
                
                setTimeout(() => confetti.classList.add('animate'), 10);
                setTimeout(() => confetti.remove(), 3000);
            }
        }
        
        // --- Info Popup Functions ---
        const popupContent = {
            science: {
                title: 'üß™ V·ªÅ Ki·∫øn th·ª©c y khoa',
                content: 'B·ªô th·∫ª n√†y ƒë∆∞·ª£c x√¢y d·ª±ng d·ª±a tr√™n c√°c nghi√™n c·ª©u v√† khuy·∫øn c√°o t·ª´ T·ªï ch·ª©c Y t·∫ø Th·∫ø gi·ªõi (WHO) v√† c√°c c∆° quan y t·∫ø uy t√≠n. M·ªçi th√¥ng tin ƒë·ªÅu ƒë∆∞·ª£c ki·ªÉm ch·ª©ng ƒë·ªÉ ƒë·∫£m b·∫£o t√≠nh ch√≠nh x√°c khoa h·ªçc, gi√∫p b·∫°n hi·ªÉu r√µ v·ªÅ c√°c t√°c ƒë·ªông c·ªßa thu·ªëc l√° ƒë·∫øn c∆° th·ªÉ.'
            },
            vape: {
                title: '‚ö° S·ª± th·∫≠t v·ªÅ Vape',
                content: 'Thu·ªëc l√° ƒëi·ªán t·ª≠ (Vape) th∆∞·ªùng ƒë∆∞·ª£c qu·∫£ng c√°o l√† m·ªôt gi·∫£i ph√°p an to√†n h∆°n, nh∆∞ng ch√∫ng v·∫´n ch·ª©a nicotine g√¢y nghi·ªán v√† nhi·ªÅu h√≥a ch·∫•t ƒë·ªôc h·∫°i khi ƒë∆∞·ª£c ƒëun n√≥ng. Ph·∫ßn n√†y s·∫Ω cung c·∫•p nh·ªØng s·ª± th·∫≠t khoa h·ªçc v·ªÅ c√°c nguy c∆° ti·ªÅm ·∫©n c·ªßa vape.'
            },
            stats: {
                title: 'üìä Th·ªëng k√™ t·ª´ WHO',
                content: 'C√°c con s·ªë kh√¥ng bi·∫øt n√≥i d·ªëi. Nh·ªØng th·ªëng k√™ trong b·ªô th·∫ª n√†y ƒë∆∞·ª£c c·∫≠p nh·∫≠t t·ª´ c√°c b√°o c√°o m·ªõi nh·∫•t c·ªßa WHO, cho th·∫•y quy m√¥ to√†n c·∫ßu c·ªßa ƒë·∫°i d·ªãch thu·ªëc l√° v√† nh·ªØng thi·ªát h·∫°i n·∫∑ng n·ªÅ v·ªÅ ng∆∞·ªùi v√† c·ªßa m√† n√≥ g√¢y ra m·ªói nƒÉm.'
            }
        };

        function showInfoPopup(type) {
            playSound(clickSound, 'C3', '8n');
            const data = popupContent[type];
            infoModalTitle.textContent = data.title;
            infoModalContent.textContent = data.content;
            infoModalOverlay.classList.add('show');
        }

        function hideInfoPopup() {
            infoModalOverlay.classList.remove('show');
        }

        // --- Fullscreen Function ---
        function toggleFullScreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().catch(err => {
                    // Fallback for browsers that might not support it fully
                    alert(`L·ªói khi b·∫≠t to√†n m√†n h√¨nh: ${err.message}`);
                });
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                }
            }
        }

        // --- EVENT LISTENERS ---
        muteBtn.addEventListener('click', () => {
            if (!audioInitialized) {
                initAudio();
            } else {
                isMuted = !isMuted;
                muteBtn.textContent = isMuted ? 'üîá' : 'üîä';
            }
        });

        fullscreenBtn.addEventListener('click', toggleFullScreen);

        document.addEventListener('keydown', function(event) {
            if (gameScreen.style.display !== 'grid') return;

            switch(event.key) {
                case ' ': event.preventDefault(); flipCard(); break;
                case 'ArrowRight': nextCardWithAnimation(); break;
                case 'ArrowLeft': previousCardWithAnimation(); break;
                case 'f': toggleFullScreen(); break; // Added 'f' key for fullscreen
            }
        });

        infoModalOverlay.addEventListener('click', function(event) {
            if (event.target === infoModalOverlay) {
                hideInfoPopup();
            }
        });
        
    </script>
</body>
</html>
